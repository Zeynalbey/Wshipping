<!DOCTYPE html>
<html lang="az">
<head>
    <!-- Google Tag Manager -->
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5RLKWF');


            </script>
    <!-- End Google Tag Manager -->
    <meta charset="utf-8">
    <meta name="google-site-verification" content="AyaZPtAtyPvecOkkXl_Ujg7Ko-YpQMWZrgNsT8YnJZQ" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 166 Yükdaşıma Xidməti - Xalça yuma, Təmizlik, Usta xidməti  </title>

    <meta property="og:title" content="166 Yükdaşıma Xidməti - Xalça yuma, Təmizlik, Usta xidməti">
    <meta property="og:image" content="https://166.az/uploads/default.png?v=1564074968">
    <meta property="keywords" content="">
    <meta property="description" content="166 Yükdaşıma şirkəti ölkədə Ucuz Yukdasima xidməti ilə sizlərə sərfəli qiymət təklif edirik. Evakuasiya, Xalça yuma və Təmizlik xidmətini həyata keçiririk.">
    <meta name="keywords" content="">
    <meta name="description" content="166 Yükdaşıma şirkəti ölkədə Ucuz Yukdasima xidməti ilə sizlərə sərfəli qiymət təklif edirik. Evakuasiya, Xalça yuma və Təmizlik xidmətini həyata keçiririk.">

    <link rel="icon" type="image/png" href="https://166.az/site/img/Logo.png?v=1574778128">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="https://166.az/site/img/Logo.png?v=1574778128">

    <meta name="theme-color" content="#000">

    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet"/>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

    <link rel="stylesheet" href="https://166.az/site/css/app.min.css?v=1666717503">
    <link rel="stylesheet" href="https://166.az/site/css/tempus-dominus.css?v=1659073936"/>

    <style>
        .hidden
        {
            display : none !important;
        }

        [data-f-id="pbf"]
        {
            display : none !important;
        }
        .modal-sure__body
        {
            width   : 100%;
            height  : 100%;
            padding : 15px;
            display : -webkit-box;
            display : -ms-flexbox;
            display : flex;
        }


        .modal-sure
        {
            width              : 100%;
            height             : 100%;
            position           : fixed;
            top                : 0;
            left               : 0;
            z-index            : 1100;
            background         : rgba(0, 0, 0, 0.8);
            -webkit-transform  : scale3d(0.9, 0.9, 0.9);
            transform          : scale3d(0.9, 0.9, 0.9);
            -webkit-transition : all 0.25s;
            -o-transition      : all 0.25s;
            transition         : all 0.25s;
            display            : none;
            opacity            : 0;
        }

        .modal-sure__body
        {
            width   : 100%;
            height  : 100%;
            padding : 15px;
            display : -webkit-box;
            display : -ms-flexbox;
            display : flex;
        }

        .modal-sure__content
        {
            width         : 100%;
            max-width     : 500px;
            border-radius : 12px;
            margin        : auto;
            background    : #FFFFFF;
            padding       : 24px;
        }

        .modal-sure__close
        {
            width                 : 1.875rem;
            height                : 1.875rem;
            -webkit-border-radius : 100%;
            border-radius         : 100%;
            background-color      : #f7f7f7;
            display               : -webkit-box;
            display               : -webkit-flex;
            display               : -ms-flexbox;
            display               : flex;
            -webkit-box-align     : center;
            -webkit-align-items   : center;
            -ms-flex-align        : center;
            align-items           : center;
            -webkit-box-pack      : center;
            -ms-flex-pack         : center;
            justify-content       : center;
            cursor                : pointer;
            margin-left           : auto;
        }

        .modal-sure__text
        {
            color          : #333537;
            font-size      : 16px;
            font-weight    : 400;
            letter-spacing : -.39px;
            line-height    : .9375rem;
            margin-right   : .4375rem;
            margin-top     : 1rem;
        }

        .modal-sure__buttons
        {
            width            : 100%;
            display          : -webkit-box;
            display          : -ms-flexbox;
            display          : flex;
            -webkit-box-pack : justify;
            -ms-flex-pack    : justify;
            justify-content  : space-between;
            margin-top       : 40px;
        }

        .modal-sure__cancel
        {
            width         : 48%;
            padding       : 8px 16px;
            border        : 2px solid #f7f7f7;
            background    : transparent;
            cursor        : pointer;
            border-radius : 6px;
            color         : #000000;
            font-size     : .875rem;
            font-weight   : 700;
            line-height   : 1.25rem;
            font-family   : Roboto;
            outline       : none;
        }

        .modal-sure__cancel:focus
        {
            outline : none;
        }

        .modal-sure__submit
        {
            width            : 48%;
            padding          : 8px 16px;
            cursor           : pointer;
            border-radius    : 6px;
            border           : none;
            background-color : #ffc425;
            color            : #ffffff;
            font-size        : .875rem;
            font-weight      : 700;
            line-height      : 1.25rem;
            font-family      : Roboto;
            outline          : none;
        }

        .modal-sure__submit:focus
        {
            outline : none;
        }


    </style>

    <!-- Jquery Plugin -->
    <script src="https://166.az/admin/js/jquery-3.3.1.min.js?v=1540642556"></script>

    <!-- Carousel Plugin -->
    <script src="https://166.az/site/js/jquery.carouFredSel-6.0.4-packed.js?v=1569247768" type="text/javascript"></script>

    <!-- Fontawesome Library -->
    <script src="https://kit.fontawesome.com/17a7821e99.js"></script>

    <!-- Popper.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://api-maps.yandex.ru/2.1/?apikey=3f1a52d9-03c8-4183-acc6-536b8994866f&lang=en_US" type="text/javascript"></script>
    <script type="text/javascript">
        let phone_approved = Number( '0' ) ,
            cancel_button_asset = 'https://166.az/site/img/homeImg/cancel_black.png?v=1587504936' ,
            front_url = '/az/cabinet/settings/';

        // The ymaps.ready() function will be called when
        // all the API components are loaded and the DOM tree is generated.
        ymaps.ready( init );

        function init()
        {
            // Creating the map.
            var myMap = new ymaps.Map( "mapBody" , {
                // The map center coordinates.
                // Default order: “latitude, longitude”.
                // To not manually determine the map center coordinates,
                // use the Coordinate detection tool.
                center : [ 55.76 , 37.64 ] ,
                // Zoom level. Acceptable values:
                // from 0 (the entire world) to 19.
                zoom : 7
            } );
        }
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    
    
    
    
    

    
    

    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

        ym(71436631, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true,
            webvisor:true,
            ecommerce:"dataLayer"
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/71436631" style="position:absolute; left:-9999px;" alt="" /></div></noscript>


    <!-- /Yandex.Metrika counter -->

    <!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s)}(window, document,'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '258519591709044');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
                   src="https://www.facebook.com/tr?id=258519591709044&ev=PageView&noscript=1"
        /></noscript>
    <!-- End Facebook Pixel Code -->
    <script src="https://166.az/site/js/OneSignalSDKWorker.js?v=1611567991" type="text/javascript"></script>
    <script src="https://166.az/site/js/OneSignalSDKUpdaterWorker.js?v=1611567991" type="text/javascript"></script>
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
    <script>
        window.OneSignal = window.OneSignal || [];
        OneSignal.push(function() {
            OneSignal.init({
                appId: "ad1d5e5f-1560-4940-abe3-491cdabf55d8",
                notifyButton: {
                    enable: true,
                },
            });
        });
    </script>
    <script>
        $( document ).on( 'click' , '[x-order-submit]' , function()
        {
            $.ajax( {
                type : 'POST' ,
                url : 'https://166.az/az/send-sms' ,
                data : {
                    'phone' : $( "input.phone" ).val() ,
                    'order' : $( "input.order_id" ).val() ,
                    '_token' : csrf
                } ,
                success : function( res )
                {
                    $( '[x-order-form]' ).hide();
                    $( '.modal-service__header' ).hide();
                    $( '.modal-close' ).hide();
                    $( '#order-details' ).show();

                    let orderManName = $( '.order-top__left input[name="name"]' ).val();
                    let orderManPhone = $( '.order-top__left input[name="phone"]' ).val();

                    let serviceIdArr = [];
                    let inputs = [];

                    $( '#order-forms .order-top' ).each( function()
                    {
                        let dataId = $( this ).attr( 'data-id' );
                        let selectService = $( this ).find( '#step1 option:selected' ).text();
                        let selectServiceId = $( this ).find( '#step1 option:selected' ).val();
                        serviceIdArr.push( { dataId , selectService , selectServiceId } );
                        let addressArray = []
                        $( this ).find( '.form-row-select' ).each( function()
                        {
                            let allSelectName = $( this ).find( 'label' ).text();
                            let allSelectValue = $( this ).find( 'select option:selected' ).text();
                            inputs.push( {
                                type : 'select' ,
                                name : allSelectName ,
                                text : allSelectValue ,
                                id : selectServiceId
                            } );
                        } );
                        $( this ).find( '.form-row-input' ).each( function()
                        {
                            let allInputName = $( this ).find( 'label' ).text();
                            let allInputValue = $( this ).find( 'input' ).val();
                            inputs.push( {
                                type : 'input' ,
                                name : allInputName ,
                                text : allInputValue ,
                                id : selectServiceId
                            } );
                        } );
                        $( this ).find( '.form-row-number' ).each( function()
                        {
                            let allNumberName = $( this ).find( 'label' ).text();
                            let allNumberValue = $( this ).find( 'input' ).val();
                            inputs.push( {
                                type : 'number' ,
                                name : allNumberName ,
                                text : allNumberValue ,
                                id : selectServiceId
                            } );
                        } );
                        $( this ).find( '.form-row-map' ).each( function()
                        {
                            let allMapName = $( this ).find( 'label' ).text();
                            let allMapValue = $( this ).find( 'input' ).val();
                            if(allMapValue.length > 0) {
                                addressArray.push( { name : allMapName , value : allMapValue , id : selectServiceId } );
                            }

                            /*inputs.push({type: 'map',name: allMapName,text: allMapValue,id: selectServiceId});*/
                        } );
                        $( this ).find( '.form-row--date' ).each( function()
                        {
                            let allTimeName = $( this ).find( '.form-row-datetime' ).text();
                            let allTimeValue = $( this ).find( '.form-row-datetime input' ).val();
                            let allDayValue = $( this ).find( '.form-row-dateday input' ).val();
                            inputs.push( {
                                type : 'date' ,
                                name : allTimeName ,
                                text : allTimeValue ,
                                day : allDayValue ,
                                id : selectServiceId
                            } );
                        } );
                        setTimeout( function()
                        {
                            inputs.push( { type : 'map' , addressList : addressArray , id : selectServiceId } )
                        } , 100 );
                    } );

                    setTimeout( function()
                    {
                        serviceIdArr.forEach( function( item )
                        {
                            let newButton =
                                `
                    <li id="${item.dataId}${item.selectService.replace( /\s/g , '' )}${item.selectServiceId}" class="filter-option__item">
                        <a href="#" class="filter-order__link">${item.selectService}</a>
                     </li>
                    `;
                            let newTab =
                                `
                    <div data-id="${item.selectServiceId}" class="order-details__content ${item.dataId}${item.selectService.replace( /\s/g , '' )}${item.selectServiceId}" style="width: 100%;display: none;">
                                <div class="order-details__content--item">
                                    <label>Sifarişçi məlumatları</label>
                                    <p>${orderManName},${orderManPhone}</p>
                                </div>
                    </div>
                    `;

                            $( '#filter-order__list' ).append( newButton );
                            $( '#order-details__tabs' ).append( newTab );

                        } );
                    } , 100 );

                    setTimeout( function()
                    {
                        $( '#filter-order__list li' ).each( function()
                        {
                            let index = $( '#filter-order__list li' ).index( $( this ) );
                            if( index == 0 )
                            {
                                $( this ).addClass( 'active' );
                            }
                        } );
                        $( '#order-details__tabs .order-details__content' ).each( function()
                        {
                            let index = $( '#order-details__tabs .order-details__content' ).index( $( this ) );
                            if( index == 0 )
                            {
                                $( this ).css( 'display' , 'flex' );
                            }
                            ;
                        } );
                    } , 200 );

                    setTimeout( function()
                    {
                        $( '#order-details__tabs .order-details__content' ).each( function()
                        {
                            let dataId = $( this ).attr( 'data-id' );
                            let $this = $( this );
                            $.each( inputs , function( item , index )
                            {
                                if( dataId === index.id && index.type === 'select' && index.text != '' )
                                {
                                    let selectHtml =
                                        `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                    $this.append( selectHtml );
                                } else if( dataId === index.id && index.type === 'input' && index.text != '' )
                                {
                                    let inputHtml =
                                        `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                    $this.append( inputHtml );
                                } else if( dataId === index.id && index.type === 'number' && index.text != '' )
                                {
                                    let numberHtml =
                                        `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                    $this.append( numberHtml );
                                } else if( dataId === index.id && index.type === 'map' && index.addressList.length != 0 && index.addressList[ 0 ].value != '' )
                                {
                                    let mapHtml =
                                        `
                                    <div class="order-details__content--item">
                                        <label>${index.addressList[ 0 ].name.split( " " )[ 0 ]}</label>
                                        ${index.addressList.map( item4 => (
                                            `<p>${index.addressList[ 0 ].name.split( " " )[ 0 ]} ${index.addressList.indexOf( item4 ) + 1}: ${item4.value}</p>`
                                        ) ).join( '' )}
                                    </div>
                                 `;
                                    $this.append( mapHtml );
                                } else if( dataId === index.id && index.type === 'date' && index.text != '' )
                                {
                                    let dateHtml =
                                        `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.day} ${index.text}</p>
                                    </div>
                                 `;
                                    $this.append( dateHtml );
                                }
                            } )
                        } );
                    } , 300 );

                    setTimeout(() => {
                        $("#newOrder .modal-content").addClass("modal-content__width");
                    }, 300);
                }
            } );
        } );

        $( document ).on( 'click' , '.changeOrder, .filter-order__add' , function( e )
        {
            $( '[x-order-form]' ).show();
            $( '.modal-service__header' ).show();
            $( '.modal-close' ).show();
            $( '#order-details' ).hide();
            $( '#filter-order__list li' ).each( function()
            {
                $( this ).remove();
            } );
            $( '#order-details__tabs .order-details__content' ).each( function()
            {
                $( this ).remove();
            } );
            e.preventDefault();
        } );

        $( document ).on( 'click' , '#filter-order__list li' , function()
        {
            $( '#filter-order__list li' ).removeClass( 'active' );
            $( this ).addClass( 'active' );
            let id = $( this ).attr( 'id' );
            $( '#order-details__tabs .order-details__content' ).hide();
            $( '#order-details__tabs .' + id ).css( 'display' , 'flex' );
        } );

        $( 'body' ).on( 'click' , '.modal-sure__close , .modal-sure__cancel' , function()
        {
            $( '.modal-sure' ).fadeOut( 400 );
        } );

        $( 'body' ).on( 'click' , '.newOrder .modal-close' , function()
        {
            $( '.modal-sure' ).show();
            setTimeout( function()
            {
                $( '.modal-sure' ).css( {
                    "opacity" : 1 ,
                    "transform" : "scale3d(1,1,1)"
                } );
            } , 200 );
        } );

        $( 'body' ).on( 'click' , '#newOrder-callback .modal-close' , function()
        {
            $( '.modal-sure' ).hide();
            $( '.modal' ).modal( 'hide' );

            // setTimeout( function()
            // {
            //     $( '.modal-sure' ).css( {
            //         "opacity" : 1 ,
            //         "transform" : "scale3d(1,1,1)"
            //     } );
            // } , 200 );
        } );


        $( 'body' ).on( 'click' , '.modal-sure__submit' , function()
        {
            $( '.modal' ).modal( 'hide' );
            $( '.modal-sure' ).fadeOut( 400 );
        } );

        $( document ).click( function( e )
        {
            if( $( e.target ).is( '.modal' ) )
            {
                $( '.modal-sure' ).show();
                setTimeout( function()
                {
                    $( '.modal-sure' ).css( {
                        "opacity" : 1 ,
                        "transform" : "scale3d(1,1,1)"
                    } );
                } , 200 );
            }
        } );

        $( 'body' ).on( 'click' , '[data-target="#newOrder"]' , function()
        {
            if( phone_approved ) $( '[x-phone-approved]' ).hide();

            else $( '[x-phone-approved]' ).show();

            let homeServiceValue = $( '.select-service' ).find( 'option:selected' ).attr( 'value' );
            let homeServiceName = $( '.order input[name="name"]' ).val();
            let homeServicePhone = $( '.order input[name="phone"]' ).val();
            let changeService = homeServiceValue;
            $( '#step1 option' ).each( function()
            {
                var optVal = $( this ).val();
                if( optVal == changeService )
                {
                    $( this ).prop( 'selected' , true );
                    let $this = $( this ).parents( '.order-top' );
                    /*addressList = [];*/
                    /*post( changeService , $this );*/
                    orderOut( 0 , changeService , $this );
                }
            } );

            $( '.order-top__left input[name="name"]' ).val( homeServiceName );
            $( '.order-top__left input[name="phone"]' ).val( homeServicePhone );
            $( '.order-top__left input[class="phoneMask phone2"]' ).val( homeServicePhone );
            $( '#newOrder' ).modal( {
                backdrop : 'static' ,
                keyboard : false
            } );

            setTimeout( function()
            {
                postCalc();
            } , 1000 );
        } );

        $( 'body' ).on( 'change' , '#step1' , function()
        {
            let own = $( this );
            /*let orderTopLength = $('.order-top').length;*/
            let orderTopId = $( this ).parents( '.order-top' ).attr( 'data-id' );
            if( orderTopId >= 1 )
            {

                let orderStepService = $( this ).find( 'option:selected' ).text();
                $( '.order-ready' ).each( function()
                {
                    let orderTopId2 = $( this ).attr( 'data-id' );
                    if( orderTopId2 == orderTopId )
                    {
                        $( this ).find( '.order-ready__item span' ).text( orderStepService );
                        orderTopId = null;
                    }
                } );
            }

            let changeService = $( this ).find( 'option:selected' ).attr( 'value' );
            let $this = $( this ).parents( '.order-top' );

            let selected_service_ids = [];
            $( 'div.order-forms select#step1 option:selected' ).each( function()
            {
                if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                    selected_service_ids.push( $( this ).val() );
            } );

            $( "div.order-forms select#step1 option" ).show();
            selected_service_ids.map( selected_service_id =>
            {
                $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
            } );

            own.children( "option[value=" + changeService + "]" ).show();

            if( $( "div.order-forms" ).find( "input.coupons" ).length > 0 )
            {
                $( 'div.order-forms input.coupons' ).each( function()
                {
                    let coupons = $( this ).attr( 'name' );

                    let couponsArr = coupons.split("[");

                    let serviceId = parseInt( couponsArr[ 1 ] );

                    if( selected_service_ids.indexOf( serviceId + '' ) < 0 )
                    {
                        $( this ).remove();
                    }
                } );
            }
            /*addressList = [];*/
            /*post( changeService , $this );*/

            // setTimeout(function() {
            //     postCalc($this);
            // }, 1000);

            orderOut( 0 , changeService , $this );

            var dataChangeId = $( this ).parents( '.order-top' ).attr( 'data-id' );
            var dataText = $( this ).find( 'option:selected' ).text();
            $( '.order-ready__button' ).each( function()
            {
                if( $( this ).attr( 'data-id' ) === dataChangeId )
                {
                    $( this ).find( '.order-ready__item span' ).text( dataText );
                }
            } );
        } );

        $( 'body' ).on( 'click' , '#order-new' , function()
        {
            let arr = [];
            $( '.order-top' ).each( function()
            {
                arr.push( $( this ) );
            } );


            let homeServiceValue2 = $( "div.order-top" ).last().find( "select#step1 option:selected" ).next().attr( 'value' );


            let selected_service_ids = [];
            $( 'div.order-forms select#step1 option:selected' ).each( function()
            {
                if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                    selected_service_ids.push( $( this ).val() );

                if( selected_service_ids.indexOf( homeServiceValue2 ) < 0 )
                {
                    selected_service_ids.push( homeServiceValue2 );
                } else
                {

                    homeServiceValue2 = $( "div.order-forms select#step1 option[value=" + homeServiceValue2 + "]:not(:selected)" ).attr( 'value' );

                }
            } );


            /*$( "div.order-forms select#step1 option" ).show();*/
            $( "div.order-forms select#step1 option" ).each( function()
            {
                if( $( this ).prop( 'selected' ) === true )
                {
                    $( this ).hide();
                } else
                {
                    $( this ).show();
                }
            } );
            selected_service_ids.map( selected_service_id =>
            {
                $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
            } );

            $( "div.order-top" ).find( "select#step1 option[value=" + homeServiceValue2 + "]:selected" ).show();


            let orderLenght = arr.length + 1;

            
            
            
            
            
            

            let newOrder =
                `

            <div data-id=${orderLenght} class="order-top">
                            <div class="order-top__left step">

                                <h1></h1>
                                <p>
                                    <i class="fas fa-check-circle"></i>
                                    <span>Addım 1</span>
                                </p>
                                <div class="form-row">
                                    <label>Xidmət</label>
                                    <select id="step1" name="services[${orderLenght}][parent]">
                                                                        <option value="1" `;
            if( selected_service_ids.indexOf( '1' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_1">Yükdaşıma</option>
                                                                                        <option value="3" `;
            if( selected_service_ids.indexOf( '3' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_3">Xalça yuma</option>
                                                                                        <option value="4" `;
            if( selected_service_ids.indexOf( '4' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_4">Təmizlik Xidməti</option>
                                                                                        <option value="22" `;
            if( selected_service_ids.indexOf( '22' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_22">Evakuasiya</option>
                                                                                        <option value="23" `;
            if( selected_service_ids.indexOf( '23' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_23">Anbar Xidməti</option>
                                                                                        <option value="24" `;
            if( selected_service_ids.indexOf( '24' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_24">İşçi qüvvəsi xidməti</option>
                                                                                        <option value="25" `;
            if( selected_service_ids.indexOf( '25' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_25">Usta xidməti</option>
                                                                                        <option value="132" `;
            if( selected_service_ids.indexOf( '132' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_132">Sanitariya xidməti</option>
                                                                                        <option value="133" `;
            if( selected_service_ids.indexOf( '133' ) >= 0 )
            {
                newOrder += 'style="display:none;"';
            }
            newOrder += ` class="service_133">Karqo xidməti</option>
                                                                    </select>
            </div>
            <hr>

                </div>
                <div class="order-top__center step" id="step_2">
                    <h1></h1>
                    <p>
                        <i class="fas fa-check-circle"></i>
                        <span>Addım 2</span>
                                </p>
                                <div class="order-top__children"></div>
                                <div class="order-top__inputs">

                                </div>

            </div>
            <div class="order-top__right step step_3" id="step_3">
                <h1></h1>
                <p>
                    <i class="fas fa-check-circle"></i>
                    <span>Addım 3</span>
                                </p>
                                <div class="order-top__inputs">

                                </div>

            </div>
        </div>

`;


            $( '#order-forms' ).append( newOrder );

            let orderServiceText;

            setTimeout( function()
            {
                $( '.order-top' ).each( function()
                {
                    var dataIdService = $( this ).attr( 'data-id' );

                    if( dataIdService == orderLenght )
                    {
                        orderServiceText = $( this ).find( '.order-top__left select[name="services[' + dataIdService + '][parent]"] option:selected' ).text();

                        return orderServiceText;
                    }
                } );

                let newServiceDeleteButton =
                    `
                <div data-id=${orderLenght} class="order-ready__button d-flex mb-3">
                        <button type="button" class="order-ready__item" data-toggle="modal" data-target="#newOrder">
                            <span>${orderServiceText}</span>
                        </button>
                        <button type="button" class="order-trash">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                </div>
            `;

                $( '#order-ready' ).append( newServiceDeleteButton );
            } , 1550 );

            let homeServiceValue = $( '.select-service' ).find( 'option:selected' ).attr( 'value' );
            let $this = $( "div.order-top" ).last();

            setTimeout( function()
            {
                orderOut( 0 , homeServiceValue2 , $this );
                /*post( homeServiceValue2 , $this );*/
            } , 100 );

            setTimeout( function()
            {
                $( "div.order-forms select#step1 option" ).show();
                selected_service_ids.map( selected_service_id =>
                {
                    $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
                } );
            } , 1500 );

            let step1Count = $this.find( '#step1 option' ).length - 1;
            let step1NoneCount = [];

            setTimeout( function()
            {
                $this.find( '#step1 option' ).each( function()
                {
                    if( $( this ).css( 'display' ) === 'none' )
                    {
                        step1NoneCount.push( $( this ) );
                    }
                } );

                if( step1Count === step1NoneCount.length )
                {
                    $( '#order-new' ).hide();
                }
            } , 1500 );


        } );

        $( 'body' ).on( 'click' , '.order-trash' , function()
        {
            let dataId = $( this ).parent().attr( 'data-id' );
            $( '.order-top' ).each( function()
            {
                let dataId2 = $( this ).attr( 'data-id' );
                if( dataId2 == dataId )
                {
                    $( this ).remove();
                }
            } );


            $( this ).parent().remove();

            postCalc();

            let selected_service_ids = [];
            $( 'div.order-forms select#step1 option:selected' ).each( function()
            {
                if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                    selected_service_ids.push( $( this ).val() );
            } );

            $( "div.order-forms select#step1 option" ).show();
            selected_service_ids.map( selected_service_id =>
            {
                $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
            } );


            let $this = $( '.order-top' ).last();
            let step1Count = $this.find( '#step1 option' ).length - 1;
            let step1NoneCount = [];

            setTimeout( function()
            {

                $this.find( '#step1 option' ).each( function()
                {
                    if( $( this ).css( 'display' ) === 'none' )
                    {
                        step1NoneCount.push( $( this ) );
                    }
                } );

                if( step1Count != step1NoneCount.length )
                {
                    $( '#order-new' ).show();
                }
            } , 1500 );

            const index = parseInt( dataId ) - 1;
            addressList.splice( index , 1 );


        } );


        $( 'body' ).on( 'change' , '.order-children' , function()
        {
            let changeService = $( this ).find( 'option:selected' ).attr( 'value' );
            let $this = $( this ).parents( '.order-top' );
            let m_id = $( $this ).attr( "data-id" );
            let index = parseInt( m_id ) - 1;
            $.ajax( {
                type : 'POST' ,
                url : 'https://166.az/az/service-inputs' ,
                data : {
                    service : changeService ,
                    '_token' : csrf
                } ,
                success : function( res )
                {
                    $( $this ).find( '.order-top__children-inputs' ).html( '' );
                    let childrenArr = res.data;

                    for( let ch = 0; ch < childrenArr.length; ch++ )
                    {
                        let appendArea = $( $this ).find( '#step_' + childrenArr[ ch ].step + ' .order-top__children-inputs' );
                        if( childrenArr[ ch ].type === 'input' )
                        {
                            let htmlInput =
                                `
                            <div class="form-row form-row-input">
                                        <label>${childrenArr[ ch ].name}</label>
                                        <input type="text" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="${childrenArr[ ch ].id}">
                            </div>
                            `;
                            appendArea.append( htmlInput );
                        } else if( childrenArr[ ch ].type === 'number' )
                        {
                            let htmlNumber =
                                `
                              <div class="form-row--number form-element--short form-row-number">
                                     <label>${childrenArr[ ch ].name}</label>
                                        <div class="regulator">
                                             <div class="regulator-minus"><span>-</span></div>
                                                <input class="regulator-output" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" type="text" value="0">
                                             <div class="regulator-plus"><span>+</span></div>
                                        </div>
                              </div>
                            `;
                            appendArea.append( htmlNumber );
                        } else if( childrenArr[ ch ].type === 'date' )
                        {
                            let random = ~~( Math.random() * 100 );
                            let random2 = ~~( Math.random() * 100 );
                            let htmlDate =
                                `
                                        <div class="form-row form-row--date">
                                        <div class="form-row--left form-element--short form-row-datetime">
                                            <label for="hour">${childrenArr[ ch ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-clock" aria-hidden="true"></i></div>
                                                <input class="datetime-container datetimepicker-input" placeholder="13:30" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="datetimepicker1${random}" data-target="#datetimepicker1${random}" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-row--right form-element--long form-row-dateday">
                                            <label for="date" style="visibility: hidden;">${childrenArr[ ch ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-calendar-alt"></i></div>
                                                <input class="datetime-container datetimepicker-input" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="datetimepicker1${random2}" data-target="#datetimepicker1${random2}" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>

                          `;
                            appendArea.append( htmlDate );
                            $( `#datetimepicker1${random}` ).datetimepicker( {
                                format : 'LT' , //L
                                locale : 'az'
                            } );

                            $( ".datetime-text" ).text( moment().format( 'D MMMM YYYY' ) );
                            $( `#datetime-text${random}` ).val( moment().format( 'D MMMM YYYY' ) );

                            $( `#datetimepicker1${random2}` ).datetimepicker( {
                                format : 'L' , //L
                                locale : 'az'
                            } );
                            let d = new Date();
                            let hour = realHour();
                            let minute = realMinut();
                            let day = realDay();
                            let year = d.getFullYear();
                            let month = realMonth();

                            function realHour()
                            {
                                let rhour = d.getHours();

                                if( rhour < 10 )
                                {
                                    rhour = `0${d.getHours()}`
                                } else
                                {
                                    rhour = d.getHours();
                                }

                                return rhour;
                            }

                            function realMinut()
                            {
                                let rminute = d.getMinutes();

                                if( rminute < 10 )
                                {
                                    rminute = `0${d.getMinutes()}`
                                } else
                                {
                                    rminute = d.getMinutes();
                                }

                                return rminute;
                            }

                            function realDay()
                            {
                                let rday = d.getDate();

                                if( rday < 10 )
                                {
                                    rday = `0${d.getDate()}`
                                } else
                                {
                                    rday = d.getDate();
                                }

                                return rday;
                            }

                            function realMonth()
                            {
                                let rmonth = d.getMonth() + 1;

                                if( rmonth < 10 )
                                {
                                    rmonth = `0${d.getMonth() + 1}`
                                } else
                                {
                                    rmonth = d.getMonth()
                                }

                                return rmonth;
                            }

                            $( `#datetimepicker1${random}` ).val( `${hour}:${minute}` );
                            $( `#datetimepicker1${random2}` ).val( `${day}.${month}.${year}` );
                        } else if( childrenArr[ ch ].type === 'select' )
                        {
                            let htmlSelect =
                                `
                             <div class="form-row form-row-select">
                                  <label>${childrenArr[ ch ].name}</label>
                                  <select name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]">
                                        ${
                                    childrenArr[ ch ].options.map( item => (
                                        `<option value="${item.id}">${item.name}</option>`
                                    ) ).join( '' )

                                }

                                  </select>
                            </div>
                        `;
                            appendArea.append( htmlSelect );
                        }
                    }
                }
            } );
        } );

        var addressList = [];
        var equalId = '';

        function post( changeService , $this )
        {

            let m_id = $( $this ).attr( "data-id" );

            let index = parseInt( m_id ) - 1;


            if( addressList[ index ] )
            {
                addressList[ index ].complete = [];
                addressList[ index ].core = null;
                addressList[ index ].directionsService = null;
                addressList[ index ].directionsDisplay = null;
                addressList[ index ].marker = null;
                addressList[ index ].geometry = [];
                addressList[ index ].input = []
            }


            $.ajax( {
                type : 'POST' ,
                url : 'https://166.az/az/service-inputs' ,
                data : {
                    service : changeService ,
                    '_token' : csrf
                } ,
                success : function( res )
                {
                    $( $this ).find( '.order-top__inputs' ).html( '' );
                    $( $this ).find( '.order-top__children' ).html( '' );
                    $( $this ).find( '.order-top__children-inputs' ).html( '' );
                    let arr = res.data;
                    let childrenArr = res.children;
                    let arrLength = childrenArr.length;
                    if( arrLength > 0 )
                    {

                        let childrenSelect =
                            `
                             <div class="form-row form-row-select">
                                  <label>Xidmətin növü</label>
                                  <select class="order-children" name="services[${m_id}][children]">
                                        ${
                                childrenArr.map( item => (
                                    `<option value="${item.id}">${item.name}</option>`
                                ) ).join( '' )

                            }

                                  </select>
                            </div>
                        `;

                        $( $this ).find( '#step_2 .order-top__children' ).append( childrenSelect );
                    }


                    let addressFound = false;

                    let isTrue = arr.some((item) => item.step === "3");
                    if(isTrue) {
                        $($this).find(".step_3").removeClass("d-none");
                    } else {
                        $($this).find(".step_3").addClass("d-none");
                    }
                    for( let input = 0; input < arr.length; input++ )
                    {

                        let appendArea = $( $this ).find( '#step_' + arr[ input ].step + ' .order-top__inputs' );
                        if( arr[ input ].type === 'select' )
                        {
                            let htmlSelect =
                                `
                             <div class="form-row form-row-select">
                                  <label>${arr[ input ].name}</label>
                                  <select name="services[${m_id}][${arr[ input ].id}]">
                                        ${
                                    arr[ input ].options.map( item => (
                                        `<option value="${item.id}">${item.name}</option>`
                                    ) ).join( '' )

                                }

                                  </select>
                            </div>
                        `;
                            appendArea.append( htmlSelect );
                        } else if( arr[ input ].type === 'input' )
                        {
                            let htmlInput =
                                `
                            <div class="form-row form-row-input">
                                        <label>${arr[ input ].name}</label>
                                        <input type="text" name="services[${m_id}][${arr[ input ].id}]" id="${arr[ input ].id}">
                            </div>
                            `;
                            appendArea.append( htmlInput );

                        } else if( arr[ input ].type === 'number' )
                        {
                            let htmlNumber =
                                `

                              <div class="form-row--number form-element--short form-row-number">
                                     <label>${arr[ input ].name}</label>
                                        <div class="regulator">
                                             <div class="regulator-minus"><span>-</span></div>
                                                <input class="regulator-output" name="services[${m_id}][${arr[ input ].id}]" type="text" value="0">
                                             <div class="regulator-plus"><span>+</span></div>
                                        </div>
                              </div>
                            `;
                            appendArea.append( htmlNumber );
                        } else if( arr[ input ].type === 'date' )
                        {

                            let random = ~~( Math.random() * 100 );
                            let random2 = ~~( Math.random() * 100 );


                            let htmlDate =
                                `
                         <div class="form-row form-row--date">
                                        <div class="form-row--left form-element--short form-row-datetime">
                                            <label for="hour">${arr[ input ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-clock" aria-hidden="true"></i></div>
                                                <input class="datetime-container datetimepicker-input" placeholder="13:30" name="services[${m_id}][${arr[ input ].id}]" id="datetimepicker1${m_id}${arr[ input ].id}1" data-target="#datetimepicker1${m_id}${arr[ input ].id}1" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-row--right form-element--long form-row-dateday">
                                            <label for="date" style="visibility: hidden;">${arr[ input ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-calendar-alt"></i></div>
                                                <input class="datetime-container datetimepicker-input" name="services[${m_id}][${arr[ input ].id}]" id="datetimepicker1${m_id}${arr[ input ].id}2" data-target="#datetimepicker1${m_id}${arr[ input ].id}2" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>

                          `;
                            appendArea.append( htmlDate );



                            $( `#datetimepicker1${m_id}${arr[ input ].id}1` ).datetimepicker( {
                                format : 'LT' , //L
                                locale : 'az'
                            } );

                            $( ".datetime-text" ).text( moment().format( 'D MMMM YYYY' ) );
                            // $( `#datetime-text[${m_id}][${arr[ input ].id}]1` ).val( moment().format( 'D MMMM YYYY' ) );

                            $( `#datetimepicker1${m_id}${arr[ input ].id}2` ).datetimepicker( {
                                format : 'L' , //L
                                locale : 'az'
                            } );
                            /*$(".datetime-text").text(moment().format('D MMMM YYYY'));*/
                            // $(`#datetime-text${random2}`).val(moment().format('D MMMM YYYY'));

                            let d = new Date();
                            let hour = realHour();
                            let minute = realMinut();
                            let day = realDay();
                            let year = d.getFullYear();
                            let month = realMonth();

                            function realHour()
                            {
                                let rhour = d.getHours();

                                if( rhour < 10 )
                                {
                                    rhour = `0${d.getHours()}`
                                } else
                                {
                                    rhour = d.getHours();
                                }

                                return rhour;
                            }

                            function realMinut()
                            {
                                let rminute = d.getMinutes();

                                if( rminute < 10 )
                                {
                                    rminute = `0${d.getMinutes()}`
                                } else
                                {
                                    rminute = d.getMinutes();
                                }

                                return rminute;
                            }

                            function realDay()
                            {
                                let rday = d.getDate();

                                if( rday < 10 )
                                {
                                    rday = `0${d.getDate()}`
                                } else
                                {
                                    rday = d.getDate();
                                }

                                return rday;
                            }

                            function realMonth()
                            {
                                let rmonth = d.getMonth() + 1;

                                if( rmonth < 10 )
                                {
                                    rmonth = `0${d.getMonth() + 1}`
                                } else
                                {
                                    rmonth = d.getMonth()
                                }

                                return rmonth;
                            }

                            $( `#datetimepicker1${m_id}${arr[ input ].id}1` ).val( `${hour}:${minute}` );
                            $( `#datetimepicker1${m_id}${arr[ input ].id}2` ).val( `${day}.${month}.${year}` );



                        } else if( arr[ input ].type === 'address' )
                        {
                            let htmlAddress =
                                `
                            <div class="form-row form-row-map ">
                                   <label>${arr[ input ].name}</label>
                                   <input type="text" class="order-address" name="services[${m_id}][${arr[ input ].id}]" id="${m_id}address${arr[ input ].id}" name="${arr[ input ].name}">
                            </div>
                            `;
                            appendArea.append( htmlAddress );
                            if( !addressList[ index ] )
                            {

                                addressList.push( {
                                    input : [ m_id + "address" + arr[ input ].id ] ,
                                    complete : [ null ] ,
                                    geometry : [ {
                                        text : '' ,
                                        lat : null ,
                                        lng : null
                                    } ] ,
                                    directionsService : null ,
                                    directionsDisplay : null ,
                                    marker : null ,
                                    core : null
                                } );
                            } else
                            {


                                addressList[ index ].input.push( m_id + "address" + arr[ input ].id );
                                addressList[ index ].complete.push( null );
                                addressList[ index ].geometry.push( {
                                    text : '' ,
                                    lat : null ,
                                    lng : null
                                } );
                            }
                            addressFound = true;

                        }
                    }
                    $( $this ).find( ".address-info" ).remove();
                    $( $this ).append( '<input type="hidden" name="services[' + m_id + '][addressInfo]" class="address-info">' );
                    if( addressFound )
                    {
                        $( $this ).append( '<div class="w-100"><div id="map' + m_id + '" class="googleMap"></div></div>' );

                    }

                    setTimeout( function()
                    {

                        if( addressList[ index ] )
                        {
                            addressList[ index ].input.map( function( m , i )
                            {
                                let input = document.getElementById( m );
                                google.maps.event.addDomListener( input , 'keydown' , function( event )
                                {
                                    if( event.keyCode === 13 )
                                    {
                                        event.preventDefault();
                                    }
                                } );
                                addressList[ index ].complete[ i ] = new google.maps.places.Autocomplete( ( input ) , { types : [  "geocode" ] } );
                                addressList[ index ].complete[ i ].addListener( 'place_changed' , function()
                                {

                                    let place = addressList[ index ].complete[ i ].getPlace();
                                    addressList[ index ].geometry[ i ].text = place.formatted_address;
                                    if( place.geometry.location )
                                    {
                                        addressList[ index ].geometry[ i ].lat = place.geometry.location.lat();
                                        addressList[ index ].geometry[ i ].lng = place.geometry.location.lng();
                                    }
                                    let found = 0;
                                    addressList[ index ].geometry.map( geo =>
                                    {
                                        if( geo.text !== '' ) found++;
                                    } );
                                    if( found > 0 )
                                    {
                                        $( $this ).find( "#map" + m_id ).show();
                                    }
                                    if( found === 1 )
                                    {

                                        if( addressList[ index ].core !== null )
                                        {

                                            setMarker( addressList[ index ] , true );

                                        } else
                                        {
                                            initMap( "map" + m_id , addressList[ index ] )
                                        }
                                    } else if( found > 1 )
                                    {
                                        setMarker( addressList[ index ] , false );
                                        setDirection( addressList[ index ] , $this );
                                    } else
                                    {
                                        $( $this ).find( "#map" + m_id ).show();
                                    }
                                } );
                            } );
                        } else
                        {
                            addressList.push( {
                                input : [ m_id + "address" + "Empty" ] ,
                                complete : [ null ] ,
                                geometry : [ {
                                    text : '' ,
                                    lat : null ,
                                    lng : null
                                } ] ,
                                directionsService : null ,
                                directionsDisplay : null ,
                                marker : null ,
                                core : null
                            } );
                        }


                    } , 100 );


                    if( changeService == 1 )
                    {
                        addOneMap( $this );
                    }
                }
            } )
        }

        function initMap( mapId , addressList )
        {


            const index = addressList.geometry.findIndex(l => l.lat !== null)
            addressList.directionsDisplay = new google.maps.DirectionsRenderer( {} );
            addressList.directionsService = new google.maps.DirectionsService;
            addressList.core = new google.maps.Map( document.getElementById( mapId ) , {
                zoom : 16 ,
                fullscreenControl : true ,
                fullscreenControlOptions : {
                    position : google.maps.ControlPosition.BOTTOM_RIGHT
                } ,
                mapTypeControl : false ,
                streetViewControl : false ,
                center : {
                    lat :  parseFloat( addressList.geometry[ index ].lat ) ,
                    lng :  parseFloat( addressList.geometry[ index ].lng )
                }
            } );
            addressList.marker = new google.maps.Marker( {
                position : {
                    lat :  parseFloat( addressList.geometry[ index ].lat )  ,
                    lng :  parseFloat( addressList.geometry[ index ].lng )
                } ,
                map : addressList.core
            } );

            addressList.directionsDisplay.setMap( addressList.core );
        }

        function setMarker( addressList , action )
        {

            if( action )
            {
                if( addressList.marker !== null )
                {
                    addressList.marker.setMap( null );
                }
                addressList.marker = new google.maps.Marker( {
                    position : {
                        lat : parseFloat( addressList.geometry[ 0 ].lat ) ,
                        lng : parseFloat( addressList.geometry[ 0 ].lng )
                    } ,
                    map : addressList.core
                } );
                addressList.core.setCenter( new google.maps.LatLng( parseFloat( addressList.geometry[ 0 ].lat ) , parseFloat( addressList.geometry[ 0 ].lng ) ) );
            } else
            {
                addressList.marker.setMap( null );

            }
            addressList.directionsDisplay.setMap( addressList.core );
        }

        function setDirection( addressList , $this = null )
        {

            let geometry_data = addressList.geometry;
            let geometry = [];
            geometry_data.map( lm =>
            {
                if( lm.text !== '' )
                {
                    geometry.push( lm );
                }
            } );
            let waypts = [];
            geometry.map( ( m , i ) =>
            {
                if( geometry.length !== ( i + 1 ) && i !== 0 )
                {
                    waypts.push( {
                        location : m.text ,
                        stopover : true
                    } );
                }
            } );
            addressList.directionsService.route( {
                origin : { lat : parseFloat( geometry[ 0 ].lat ) , lng : parseFloat( geometry[ 0 ].lng ) } ,
                waypoints : waypts ,
                destination : {
                    lat : parseFloat( geometry[ geometry.length - 1 ].lat ) ,
                    lng : parseFloat( geometry[ geometry.length - 1 ].lng )
                } ,
                travelMode : google.maps.TravelMode[ 'DRIVING' ]
            } , ( response , status ) =>
            {
                if( status === 'OK' )
                {
                    addressList.directionsDisplay.setDirections( response );
                    postCalc( $this , response );
                } else
                {
                    alert( "something went wrong" )
                }
            } );
        }

        $( 'body' ).on( 'change' , 'select,input' , function( event )
        {
            if( $( this ).hasClass( 'order-address' ) )
            {
                event.preventDefault();
            } else
            {
                postCalc( $( this ) );
            }
        } );

        $( 'body' ).on( 'mouseup' , 'div.regulator-plus,div.regulator-minus' , function()
        {
            let thisVar = $( this );
            setTimeout( function()
            {
                postCalc( thisVar );
            } , 100 );
        } );

        function postCalc( $this = null , addressList = null )
        {


            if( addressList != null )
            {
                let distance = Math.round( addressList[ 'routes' ][ 0 ][ 'legs' ][ 0 ][ 'distance' ][ 'value' ] / 1000 * 10 ) / 10; // with km
                let duration = Math.round( addressList[ 'routes' ][ 0 ][ 'legs' ][ 0 ][ 'duration' ][ 'value' ] / 60 ); // with hour

                /*$( $this ).find( ".address-info" ).remove();*/
                $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val( distance + "-" + duration );
                /*let arr = [$( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val()];*/
                /*var name = $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).attr('name');
                form.push( {
                    name : name ,
                    value : $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val()
                } );*/

            }
            let form = $( 'div.modal-service__body form.order-form' ).serializeArray();
            form.push( { name : '_token' , value : csrf } );

            $.ajax( {
                method : "POST" ,
                url : 'https://166.az/az/calculate' ,
                data : form ,
                success : function( res )
                {
                    let data = JSON.parse( JSON.stringify( res ) );
                    let total = data.total;

                    total = Math.round(total * 100) / 100;

                    if (data.servicesInfo) {
                        if (Object.keys(data.servicesInfo).length > 0) {
                            var servicesInfoLength = Object.keys(data.servicesInfo).length;

                            // $( "div.order-all__center" ).html( "" );
                            //
                            // for( var i = 1; i <= servicesInfoLength; i++ )
                            // {
                            //     if( typeof data.servicesInfo[ i ] !== 'undefined' )
                            //     {
                            //         $( "div.order-all__center" ).append( "<p class='selected-service-" + i + "'><span x-order-selected-service>" + data.servicesInfo[ i ].name + "</span>:<strong><span x-order-selected-service-price>" + data.servicesInfo[ i ].total + "</span> AZN</strong></p>" );
                            //
                            //         // $('div.order-forms').find('input.services_id').remove();
                            //     }
                            // }
                        }
                    }

                    // $("div.coupon-form").first().attr("data-service-id",$("div.order-top").first().find("select#step1 option:selected").val());

                    // $( '[x-order-final-price]' ).html( total );
                    $("div.order-top").last().find("input.order_id").remove();
                    $("div.order-top").last().append("<input class='order_id' type='hidden' name='order_id' value=" + data.order_id + ">");
                }
            });


            let selected_service_ids = [];
            $('div.order-forms select#step1 option:selected').each(function () {
                if (selected_service_ids.indexOf($(this).val()) < 0)
                    selected_service_ids.push( $( this ).val() );
            } );

            let coupon_service_ids = [];
            $( 'div.coupon-form' ).each( function()
            {
                if( $( this ).attr( "data-service-id" ) != undefined && coupon_service_ids.indexOf( $( this ).attr( "data-service-id" ) ) < 0 )
                {
                    coupon_service_ids.push( $( this ).attr( "data-service-id" ) );
                }
            } );

            function arr_diff( a1 , a2 )
            {

                var a = [] , diff = [];

                for( var i = 0; i < a1.length; i++ )
                {
                    a[ a1[ i ] ] = true;
                }

                for( var i = 0; i < a2.length; i++ )
                {
                    if( a[ a2[ i ] ] )
                    {
                        delete a[ a2[ i ] ];
                    } else
                    {
                        a[ a2[ i ] ] = true;
                    }
                }

                for( var k in a )
                {
                    diff.push( k );
                }

                return diff;
            }

            let diff = arr_diff( selected_service_ids , coupon_service_ids );

            diff.map( dif =>
            {
                $( 'div[data-service-id="' + dif + '"]' ).remove();
            } );

            let services_id = [];

            $( 'div.order-forms select#step1 option:selected' ).each( function()
            {
                let selected = $( this ).val();
                if( services_id.indexOf( selected ) < 0 )
                {
                    services_id.push( selected );
                }
            } );

            $( 'div.order-forms div.services_ids' ).html( '' );
            services_id.map( service_id =>
            {
                $( 'div.order-forms div.services_ids' ).append( "<input class='services_id' type='hidden' name='services_id[]' value='" + service_id + "'>" );
            } );
        }


        $( 'div.main-header__left div.form-row input' ).keyup( function()
        {

            $( 'div.main-header__left div.form-row input' ).on( 'keyup' , function()
            {
                let empty = false;

                $( 'div.main-header__left div.form-row input' ).each( function()
                {
                    empty = $( this ).val().length == 0;
                } );

                if( empty )
                    $( 'div.main-header__left .form-submit button' ).attr( 'disabled' , 'disabled' );
                else
                    $( 'div.main-header__left .form-submit button' ).attr( 'disabled' , false );
            } );
        } );

        $( 'div.main-header__left .form-submit' ).click( function()
        {
            $( 'div.main-header__left div.form-row input' ).each( function()
            {
                if( $( this ).val().trim() == '' )
                    $( this ).css( 'border' , '1px solid red' );
                else
                    $( this ).css( 'border-color' , '' );
            } );
        } );


        $( '.btn-submit' ).click( () =>
        {
            $( '.btn-modal-call-desc-input input' ).each( function()
            {
                if( $( this ).val().trim() == '' ){
                    console.log('bosdur');
                    $( this ).css( 'border' , '1px solid red' );
                }
                else
                    $( this ).css( 'border-color' , '' );
            } );
        } );

        // mobile-service__content




        $( 'body' ).on( 'click' , 'button.coupon-button' , function()
        {
            let coupon_input = $( this ).closest( 'div.coupon-form' ).find( "input.coupon-value" );
            let phone = $( "input.phone" ).val();

            let services_id = $( 'input.services_id' ).map( function()
            {
                return this.value;
            } ).get();

            let coupon_form = $( this ).closest( 'div.coupon-form' );
            coupon_form.find( "input.coupon-value" ).css( "border" , "0" );

            let order_id = $( "input.order_id" ).val();

            let type = 1;
            if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 1 )
                type = 1;
            else if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 2 )
                type = 2;

            $.ajax( {
                type : 'POST' ,
                url : 'https://166.az/az/check_coupon' ,
                data : {
                    'coupon' : coupon_input.val() ,
                    'phone' : phone ,
                    'services_id[]' : services_id ,
                    'order_id' : order_id ,
                    'type' : type ,
                    '_token' : csrf
                } ,
                success : function( res )
                {
                    let data = JSON.parse( JSON.stringify( res ) );

                    if( data.service_id > 0 )
                    {

                        let name = 'coupons';
                        let value = data.coupon_id;
                        if( data.campaign_id > 0 )
                        {
                            name = 'campaigns';
                            value = data.campaign_id;
                        }

                        if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 1 )
                        {

                            $( "div.order-forms" ).append( "<input class='coupons' type='hidden' name='" + name + "[" + data.service_id + "][]' value='" + value + "'>" );

                            $( "div.order-bottom__left" ).prepend( '<hr>\n' +
                                '                            <div class="form-row coupon-form" data-service-id=' + data.service_id + '>\n' +
                                '                                <div class="form-row--left form-element--middle">\n' +
                                '                                    <label for="">Endirim Kodu</label>\n' +
                                '                                    <input readonly type="text" style="border: 1px solid green;"  class="coupon-value" value="' + data.coupon_val + '" placeholder="XXXXXX">\n' +
                                '                                </div>\n' +
                                '                                <div class="form-row--right form-element--middle">\n' +
                                '                                    <label for="">&nbsp;</label>\n' +
                                '                                    <button type="button" data-type=2 class="button-all coupon-button" value="Sil" data-type=1>Sil</button>\n' +
                                '                                </div>\n' +
                                '                             <div class=\'alert alert-success\'>Uğurlu</div></div>' );

                            $( "div.order-all__left" ).show();
                            $( "div.order-all__left p strong" ).html( data.discount + " %" );
                        } else if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 2 )
                        {
                            $( "div.order-forms" ).find( "input[name='" + name + "[" + data.service_id + "][]'][value='" + value + "']" ).remove();
                            coupon_form.remove();
                        }

                        postCalc();
                    } else
                    {
                        coupon_form.find( "input.coupon-value" ).css( "border" , "1px solid red" );
                    }

                    coupon_input.val( '' );
                }
            } );
        } );


        $( 'body' ).on( 'click' , '.orderOut-callback' , function()
        {
            let serviceId = $( this ).attr( "data-id" );
            let phone = $( this ).attr( "data-phone" );
            let phone_two = $( this ).attr( "data-phone-two" );
            let serviceEmail = $( this ).attr( "data-email" );
            let serviceParentId = $( this ).attr( "data-parent-id" );

            console.log('test');
            // First number
            $('#codioServicePhoneShow').html(phone);
            $('#codioServicePhoneShowHref').attr( 'href' ,`tel:${phone}`);

            // Second number
            $('#codioServicePhoneTwoShow').html(phone_two);
            $('#codioServicePhoneTwoShowHref').attr( 'href' ,`tel:${phone_two}`);


            // console.log(serviceId);
            // document.getElementById("serviceIdCodio").value = serviceId;
            $('#serviceIdCodio').val(serviceId);
            $('#serviceEmail').val(serviceEmail);

            // console.log(serviceId);
            // console.log($('#serviceIdCodio').val())
            let campaign_id = 1;
            if( $( this ).attr( 'data-campaign-id' ) > 0 )
                campaign_id = $( this ).attr( "data-campaign-id" );

            let type = 0;
            if( $( this ).attr( 'data-type' ) != '' )
                type = $( this ).attr( "data-type" );

            let $this = $( "div.order-top" ).first();

            orderOutCallback( serviceId , serviceParentId , $this , campaign_id , type );
            // $( '#newOrder-callback .form-row input' ).css( 'border' , '1px solid red' );
            $( '#newOrder-callback #step_2 , #newOrder-callback #step_3' ).css( {
                'opacity' : '0.6' ,
                'pointer-events' : 'none'
            } );
        } );


        $( 'body' ).on( 'click' , '.orderOut' , function()
        {
            let serviceId = $( this ).attr( "data-id" );
            let serviceParentId = $( this ).attr( "data-parent-id" );

            let campaign_id = 1;
            if( $( this ).attr( 'data-campaign-id' ) > 0 )
                campaign_id = $( this ).attr( "data-campaign-id" );

            let type = 0;
            if( $( this ).attr( 'data-type' ) != '' )
                type = $( this ).attr( "data-type" );

            let $this = $( "div.order-top" ).first();

            orderOut( serviceId , serviceParentId , $this , campaign_id , type );
            $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
            $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
                'opacity' : '0.6' ,
                'pointer-events' : 'none'
            } );
        } );

        $( document ).on( 'change' , '#newOrder .order-top__left input' , function()
        {
            let inputOne = $( '#newOrder .order-top__left input[name="name"]' ).val();
            let inputTwo = $( '#newOrder .order-top__left input[name="phone"]' ).val();
            if( inputOne != '' && inputTwo != '' )
            {
                $( '#newOrder #step_2 , #newOrder #step_3' ).removeAttr( 'style' );
                $( '#newOrder .order-top__left input' ).css( 'border' , 'none' );
            } else
            {
                $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
                    'opacity' : '0.6' ,
                    'pointer-events' : 'none'
                } );
                $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
            }
        } );

        $( document ).on( 'keyup' , '#newOrder .order-top__left input' , function()
        {
            let inputOne = $( '#newOrder .order-top__left input[name="name"]' ).val();
            let inputTwo = $( '#newOrder .order-top__left input[name="phone"]' ).val();
            if( inputOne != '' && inputTwo != '' )
            {
                $( '#newOrder #step_2 , #newOrder #step_3' ).removeAttr( 'style' );
                $( '#newOrder .order-top__left input' ).css( 'border' , 'none' );
            } else
            {
                $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
                    'opacity' : '0.6' ,
                    'pointer-events' : 'none'
                } );
                $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
            }
        } );

        $( 'body' ).on( 'change' , '.campaign-select' , function()
        {
            let campaignId = $( this ).val();
            let serviceParentId = 4;

            let $this = $( this ).parents( "div.order-top" );

            orderOut( 0 , serviceParentId , $this , campaignId );
        } );

        $( 'body' ).on( 'change' , 'select.order-children' , function()
        {
            let campaignId = $( this ).val();

            if( campaignId == 1000 || campaignId == 2000 )
            {
                let serviceParentId = 4;

                let $this = $( this ).parents( "div.order-top" );

                setTimeout( function()
                {
                    orderOut( 0 , serviceParentId , $this , campaignId );
                }, 1000);
            } else {
                $("div.packages-select-div").remove();
            }

        });

        function orderOutCallback(service_id = 0, service_parent_id = 0, $this, campaign_id = 0, type = 0) {
            // $( '[x-order-final-price]' ).html( 0 );
            $('[x-order-selected-service-price]').html(0);

            $('#newOrder-callback').modal({
                backdrop: 'static',
                keyboard: false
            });


            $($this).find("#step_2 div.avtopark-select-div").remove();

            if( service_parent_id == 1 )
            {
                $.ajax( {
                    type : 'GET' ,
                    url : 'https://166.az/az/avtopark' ,
                    success : function( res )
                    {
                        var htmlSelect = '<div class="form-row avtopark-select-div form-row-select"><label>Yük maşını</label><select class="avtopark-select" name="services[' + $( $this ).attr( 'data-id' ) + '][avtopark]">';
                        let data = JSON.parse( JSON.stringify( res ) );
                        data = data.data;
                        data.map( value =>
                        {
                            if( value.id == service_id && type == 'avtopark' )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                        } );

                        htmlSelect += '</select></div>';

                        $( $this ).find( "#step_2" ).append( htmlSelect );
                    }
                } );
            } else if( service_parent_id == 4 )
            {


                
                
                
                

                $.ajax( {
                    type : 'GET' ,
                    data : {
                        'campaign_id' : campaign_id
                    } ,
                    url : 'https://166.az/az/packages' ,
                    success : function( res )
                    {

                        var htmlSelect = '<div class="form-row packages-select-div"><label>Paketi seçin</label><select class="packages-select" name="services[' + $( $this ).attr( 'data-id' ) + '][campaign][package_id]">';

                        let data = JSON.parse( JSON.stringify( res ) );
                        data2 = data.data;

                        if( data2 )
                        {
                            if( $( $this ).find( "#step_2 div.campaigns" ).length == 0 )
                                $( $this ).find( "#step_2" ).append( "<div class='campaigns'></div>" );
                        }

                        var translateWeek1 = "Həftədə 1 gün";
                        var translateWeek2 = "Həftədə 2 gün";
                        var translateWeek3 = "Həftədə 3 gün";

                        setTimeout( function()
                        {
                            $( $this ).find( 'select.order-children option[value=' + data.campaign_id + ']' ).prop( 'selected' , true );
                        } , 1000 );

                        var hourly = "SAATLIQ PAKET";

                        if( campaign_id == 1000 )
                        {
                            data2.map( value =>
                            {
                                if( value.id == service_id )
                                    var selected = 'selected';
                                else
                                    var selected = '';

                                htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                            } );
                        } else if( campaign_id == 2000 )
                        {
                            data2.map( value =>
                            {
                                if( value.id == service_id )
                                    var selected = 'selected';
                                else
                                    var selected = '';

                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_1_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_1_price + ' AZN- ' + translateWeek1 + '</option>';
                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_2_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_2_price + ' AZN- ' + translateWeek2 + '</option>';
                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_3_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_3_price + ' AZN- ' + translateWeek3 + '</option>';
                            } );
                        }

                        htmlSelect += '</select></div>';

                        let packageLink = "https://166.az/az/campaigns";
                        let packageTitle = "Kampaniyalar";
                        htmlSelect += '<div class="form-row"><a target="_blank" href="' + packageLink + '">' + packageTitle + '</a></div>';

                        $( $this ).find( "#step_2 div.campaigns" ).html( htmlSelect );
                    }
                } );
            }

            setTimeout( function()
            {
                if( service_id > 0 )
                {
                    $( 'div.order-top select.order-children option[value=' + service_id + ']' ).prop( 'selected' , true );
                }
            } , 1200 );

            let changeService = service_parent_id;

            $( $this ).find( '#step1 option' ).each( function()
            {
                var optVal = $( this ).val();
                if( optVal == changeService )
                {
                    $( this ).prop( 'selected' , true );
                    let $this = $( this ).parents( '.order-top' );

                    post( changeService , $this );
                }
            } );

            setTimeout( function()
            {
                postCalc();
            } , 2000 );
        }


        function orderOut(service_id = 0, service_parent_id = 0, $this, campaign_id = 0, type = 0) {
            // $( '[x-order-final-price]' ).html( 0 );
            $('[x-order-selected-service-price]').html(0);

            $('#newOrder').modal({
                backdrop: 'static',
                keyboard: false
            });


            $($this).find("#step_2 div.avtopark-select-div").remove();

            if( service_parent_id == 1 )
            {
                $.ajax( {
                    type : 'GET' ,
                    url : 'https://166.az/az/avtopark' ,
                    success : function( res )
                    {
                        var htmlSelect = '<div class="form-row avtopark-select-div form-row-select"><label>Yük maşını</label><select class="avtopark-select" name="services[' + $( $this ).attr( 'data-id' ) + '][avtopark]">';
                        let data = JSON.parse( JSON.stringify( res ) );
                        data = data.data;
                        data.map( value =>
                        {
                            if( value.id == service_id && type == 'avtopark' )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                        } );

                        htmlSelect += '</select></div>';

                        $( $this ).find( "#step_2" ).append( htmlSelect );
                    }
                } );
            } else if( service_parent_id == 4 )
            {


                
                
                
                

                $.ajax( {
                    type : 'GET' ,
                    data : {
                        'campaign_id' : campaign_id
                    } ,
                    url : 'https://166.az/az/packages' ,
                    success : function( res )
                    {

                        var htmlSelect = '<div class="form-row packages-select-div"><label>Paketi seçin</label><select class="packages-select" name="services[' + $( $this ).attr( 'data-id' ) + '][campaign][package_id]">';

                        let data = JSON.parse( JSON.stringify( res ) );
                        data2 = data.data;

                        if( data2 )
                        {
                            if( $( $this ).find( "#step_2 div.campaigns" ).length == 0 )
                                $( $this ).find( "#step_2" ).append( "<div class='campaigns'></div>" );
                        }

                        var translateWeek1 = "Həftədə 1 gün";
                        var translateWeek2 = "Həftədə 2 gün";
                        var translateWeek3 = "Həftədə 3 gün";

                        setTimeout( function()
                        {
                            $( $this ).find( 'select.order-children option[value=' + data.campaign_id + ']' ).prop( 'selected' , true );
                        } , 1000 );

                        var hourly = "SAATLIQ PAKET";

                        if( campaign_id == 1000 )
                        {
                            data2.map( value =>
                            {
                                if( value.id == service_id )
                                    var selected = 'selected';
                                else
                                    var selected = '';

                                htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                            } );
                        } else if( campaign_id == 2000 )
                        {
                            data2.map( value =>
                            {
                                if( value.id == service_id )
                                    var selected = 'selected';
                                else
                                    var selected = '';

                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_1_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_1_price + ' AZN- ' + translateWeek1 + '</option>';
                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_2_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_2_price + ' AZN- ' + translateWeek2 + '</option>';
                                htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_3_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_3_price + ' AZN- ' + translateWeek3 + '</option>';
                            } );
                        }

                        htmlSelect += '</select></div>';

                        let packageLink = "https://166.az/az/campaigns";
                        let packageTitle = "Kampaniyalar";
                        htmlSelect += '<div class="form-row"><a target="_blank" href="' + packageLink + '">' + packageTitle + '</a></div>';

                        $( $this ).find( "#step_2 div.campaigns" ).html( htmlSelect );
                    }
                } );
            }

            setTimeout( function()
            {
                if( service_id > 0 )
                {
                    $( 'div.order-top select.order-children option[value=' + service_id + ']' ).prop( 'selected' , true );
                }
            } , 1200 );

            let changeService = service_parent_id;

            $( $this ).find( '#step1 option' ).each( function()
            {
                var optVal = $( this ).val();
                if( optVal == changeService )
                {
                    $( this ).prop( 'selected' , true );
                    let $this = $( this ).parents( '.order-top' );

                    post( changeService , $this );
                }
            } );

            setTimeout( function()
            {
                postCalc();
            } , 2000 );
        }


        function addOneMap( $this )
        {
            let arr = [];

            $this.find( '.form-row-map' ).each( function()
            {
                let _this = $( this );
                arr.push( _this );
            } );
            let newMap = '<a href="#" class="new-map"><i class="fas fa-home" aria-hidden="true"></i>Daha Bir Ünvan Əlavə Et</a>';
            let lastMapItem = arr[ arr.length - 1 ];
            lastMapItem.append( newMap );
        }

        $( document ).on( 'click' , '.new-map' , function()
        {

            let $this = $( this ).parents( '.order-top' );


            let item = [ parseInt( $( this ).parents( '.order-top' ).attr( 'data-id' ) ) , parseInt( $( this ).parents( '.order-top' ).attr( 'data-id' ) ) - 1 ];


            let item2 = [];
            $( '.order-address' ).each( function()
            {
                item2.push( $( this ) );
            } );
            $( this ).parent().after(
                `
                            <div class="form-row form-row-map otherMap">
                                <input type="text" class="order-address" name="services[${item[ 0 ]}][${item[ 1 ]}map]" id="${item[ 0 ]}address${item2.length}map">
                            </div>
                        ` );
            $( this ).remove();

            if( !addressList[ item[ 1 ] ] )
            {
                addressList.push( {
                    input : [ item[ 0 ] + "address" + item2.length + "map" ] ,
                    complete : [ null ] ,
                    geometry : [ {
                        text : '' ,
                        lat : null ,
                        lng : null
                    } ] ,
                    directionsService : null ,
                    directionsDisplay : null ,
                    marker : null ,
                    core : null
                } );
            } else
            {
                addressList[ item[ 1 ] ].input.push( item[ 0 ] + "address" + item2.length + "map" );
                addressList[ item[ 1 ] ].complete.push( null );
                addressList[ item[ 1 ] ].geometry.push( {
                    text : '' ,
                    lat : null ,
                    lng : null
                } );
            }
            addressFound = true;

            setTimeout( function()
            {
                let $this;

                $( '#order-forms .order-top' ).each( function()
                {
                    if( $( this ).attr( 'data-id' ) == item[ 0 ] )
                    {
                        $this = $( this );
                    }
                } );
                addressList[ item[ 1 ] ].input.map( function( m , i )
                {
                    let input = document.getElementById( m );
                    google.maps.event.addDomListener( input , 'keydown' , function( event )
                    {
                        if( event.keyCode === 13 )
                        {
                            event.preventDefault();
                        }
                    } );
                    addressList[ item[ 1 ] ].complete[ i ] = new google.maps.places.Autocomplete( ( input ) , { types : [ 'geocode' ] } );
                    addressList[ item[ 1 ] ].complete[ i ].addListener( 'place_changed' , function()
                    {
                        let place = addressList[ item[ 1 ] ].complete[ i ].getPlace();
                        addressList[ item[ 1 ] ].geometry[ i ].text = place.formatted_address;
                        if( place.geometry.location )
                        {
                            addressList[ item[ 1 ] ].geometry[ i ].lat = place.geometry.location.lat();
                            addressList[ item[ 1 ] ].geometry[ i ].lng = place.geometry.location.lng();
                        }
                        let found = 0;
                        addressList[ item[ 1 ] ].geometry.map( geo =>
                        {
                            if( geo.text !== '' ) found++;
                        } );
                        if( found > 0 )
                        {
                            $( $this ).find( "#map" + item[ 0 ] ).show();
                        }
                        if( found === 1 )
                        {
                            if( addressList[ item[ 1 ] ].core !== null )
                            {
                                setMarker( addressList[ item[ 1 ] ] , true );
                            } else
                            {
                                initMap( "map" + item[ 0 ] , addressList[ item[ 1 ] ] )
                            }
                        } else if( found > 1 )
                        {
                            setMarker( addressList[ item[ 1 ] ] , false );
                            setDirection( addressList[ item[ 1 ] ] , $this );
                        } else
                        {
                            $( $this ).find( "#map" + item[ 0 ] ).hide();
                        }

                    } );
                } );
            } , 100 );
            addOneMap( $this );

        } );


        $(document).on("keyup",".otherMap,.form-row-map",function() {
            const $this = $( this ).parents( '.order-top' );
            const input = $(this).find("input");
            const id = input.attr("id")
            const length = input.val().length
            const map = $this.find(".googleMap").attr("id");
            const item =  parseInt( $this.attr( 'data-id' ) ) - 1
            const index = addressList[ item ].input.indexOf(id)
            const mapLength = $this.find(".form-row-map").length;
            const serviceType = parseInt($this.find(".order-top__left select").val());

            const checkMap = []

            $(".form-row-map").each(function() {
                if($(this).find("input").val().length > 0) {
                    checkMap.push($(this))
                }
            })

            if(serviceType === 1) {
                if(checkMap.length === 1 && length === 0) {
                    addressList[ item ].geometry[index] = {
                        text : '' ,
                        lat : null ,
                        lng : null
                    }
                    initMap(map, addressList[item]);
                }  else if(length === 0 && checkMap.length > 1) {
                    addressList[ item ].geometry[index] = {
                        text : '' ,
                        lat : null ,
                        lng : null
                    }
                    initMap(map, addressList[item]);
                    setMarker(addressList[ item ],false);
                    setDirection( addressList[ item ] , $this );

                }
            }


        })



        $( document ).on( 'click' , 'button.modal-sure__submit' , function()
        {
            sessionStorage.clear();
            location.reload();
        } );


        function editFormCallback( data )
        {
            window.location.href = data.redirect;
        }

    </script>
</head>
<body id="body">
<!-- Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5RLKWF"
            height="0" width="0" style="display:none;visibility:hidden">
    </iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
<header class="header" id="header">
    <div class="header-primary">
        <div class="container header-container header-primary__container">
            <div class="header-primary__left">
                <a   class="header-primary__tab tab-primary  active  ">
                    <div class="header-primary__tab--before">
                        <div class="circle"></div>
                    </div>
                    <span>Fərdi Müştərilər</span>
                    <div class="header-primary__tab--after">
                        <div class="circle"></div>
                    </div>
                </a>
                <a href="https://166.az/az?corporate" class="header-primary__tab tab-secondary  ">
                    <div class="header-primary__tab--before">
                        <div class="circle"></div>
                    </div>
                    <span>Korporativ Müştərilər</span>
                    <div class="header-primary__tab--after">
                        <div class="circle"></div>
                    </div>
                </a>
            </div>
            <div class="header-primary__right d-none d-lg-flex">
                <a href="#" data-toggle="modal" data-target="#callBack">
                    <div>
                        <i class="fas fa-phone-alt"></i>
                    </div>
                    <span>Geri zəng</span>
                </a>
                <a href="#" data-toggle="modal" data-target="#onlinePayment">
                    <div>
                        <i class="far fa-credit-card"></i>
                    </div>
                    <span>Onlayn ödəniş</span>
                </a>
                                    <a href="https://166.az/az/login">
                        <div>
                            <i class="fas fa-user"></i>
                        </div>
                        <span>Daxil ol</span>
                    </a>
                            </div>
            <div id="callback-success-modal" class="modal fade modal-service">
                <div class="modal-dialog modal-service__dialog">
                    <div class="modal-content modal-service__content">
                        <div class="modal-header modal-service__header">
                            <h6>Sizinlə tezliklə əlaqə saxlayacağıq.</h6>
                        </div>
                        <div class="modal-close" data-dismiss="modal">
                            <i class="fa fa-times"></i>
                        </div>
                    </div>
                </div>
            </div>


































































































            <div id="newOrder-callback" class="modal fade newOrder  p-0 m-0">
                <div class="modal-dialog modal-service__dialog mobile-service">
                    <div class="modal-content modal-service__content mobile-service__content">
                        <div class="modal-body modal-service__body">
                            <div class="btn-modal-call btn-success">
                                <a  id="codioServicePhoneShowHref">
                                    <i>
                                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12.6125 13.4388L14.2225 11.8288C14.4393 11.6146 14.7137 11.468 15.0122 11.4068C15.3108 11.3455 15.6207 11.3723 15.9044 11.4838L17.8665 12.2672C18.1532 12.3835 18.399 12.5821 18.5729 12.838C18.7469 13.0938 18.8412 13.3953 18.844 13.7047V17.2984C18.8424 17.5089 18.7981 17.7168 18.714 17.9097C18.6299 18.1026 18.5076 18.2764 18.3544 18.4208C18.2013 18.5652 18.0206 18.6771 17.8231 18.7498C17.6256 18.8225 17.4155 18.8544 17.2053 18.8438C3.45561 17.9884 0.681232 6.34469 0.156545 1.88844C0.132188 1.66961 0.154442 1.4481 0.221842 1.23848C0.289241 1.02887 0.40026 0.835898 0.547593 0.67227C0.694926 0.508642 0.875235 0.378063 1.07666 0.289124C1.27808 0.200185 1.49605 0.154902 1.71623 0.156253H5.18779C5.49758 0.15717 5.80001 0.250745 6.05618 0.424943C6.31236 0.599141 6.51056 0.845994 6.62529 1.13375L7.40873 3.09594C7.52391 3.37846 7.5533 3.68865 7.49322 3.98777C7.43314 4.2869 7.28626 4.56168 7.07092 4.77782L5.46092 6.38782C5.46092 6.38782 6.38811 12.6625 12.6125 13.4388Z" fill="white"/>
                                        </svg>

                                    </i>
                                    <span id="codioServicePhoneShow">

                    </span>

                                </a>
                            </div>
                            
                            
                            
                            
                            
                            

                            
                            

                            

                            
                            
                            <p class='btn-modal-call-desc'>və ya
                                nömrənizi qeyd edin biz sizə zəng edək</p>

                            <form action="https://166.az/az/callback" class="form order-form" method="post" x-edit-form="" x-target="afterCallback">
                                <div class="form-row phoneMaskParent  btn-modal-call-desc-input">
                                    <input type="hidden" name="name" value="Mobil Geri Zəng">
                                    <input type="hidden" id="serviceIdCodio" name="service" value="1">
                                    <input type="hidden" id="" name="city" value="Baku">
                                    <input type="hidden" id="" name="date" value="25.11.2022">
                                    <input type="hidden" id="" name="time" value="12:00">
                                    <input type="hidden" id="serviceEmail" name="email" value="" >
                                    <input class="phoneMask phone2" type="text"   placeholder="Əlaqə nömrəsi" >
                                    <input hidden type="text" name="phone" class="phone"  >
                                </div>

                                <button type="submit" class=" btn-submit">
                                    Göndər
                                </button>
                            </form>


                        </div>
                        <div class="modal-close btn-modal-close">
                            <i class="fa fa-times"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div id="onlinePayment" class="modal fade modal-service">
                <div class="modal-dialog modal-service__dialog">
                    <div class="modal-content modal-service__content">
                        <div class="modal-header modal-service__header">
                            <h6>Onlayn ödəniş</h6>
                        </div>
                        <div class="modal-body modal-service__body">
                            <form action="https://166.az/az/payment/online/payment" x-payment-form x-edit-form x-target-with-data="afterOnlinePayment" class="form" method="post">
                                <div class="form-row">
                                    <label for="">Ödəniş məbləği*</label>
                                    <input type="text" name="payment_val" placeholder="Ödəniş məbləği">
                                </div>
                                <div class="form-row">
                                    
                                    <div class="form-row--right w-100 phoneMaskParent">
                                        <label for="phone">Əlaqə nömrəsi</label>
                                        <input class="phoneMask"  type="text" value="">
                                        <input hidden id="mobile_number_payment" name="phone" type="text" value="">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-row--left form-element--short" style="width: 45%;">
                                        <label for="">Elektron poçt</label>
                                        <input name="email" type="text" placeholder="Elektron poçt">
                                    </div>
                                    <div class="form-row--left form-element--short" style="width: 45%;">
                                        <label for="">Sifariş nömrəsi*</label>
                                        <input name="order_number" type="text" placeholder="Sifariş nömrəsi">
                                    </div>
                                </div>
                                <div class="form-submit modal-service__submit">
                                    <button type="submit">
                                        <span>Onlayn ödə</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="modal-close" data-dismiss="modal">
                            <i class="fa fa-times"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="header-profile d-lg-none">
                <div class="dropdown header-profile__dropdown">
                    <a href="#">
                        <i class="fa fa-user"></i>
                    </a>
                    <div class="dropdown-menu header-profile__dropdown--menu">
                        <div class="header-primary__right">
                            <a href="#" data-toggle="modal" data-target="#callBack">
                                <div>
                                    <i class="fas fa-phone-alt"></i>
                                </div>
                                <span>Geri zəng</span>
                            </a>
                            <a href="#" data-toggle="modal" data-target="#onlinePayment">
                                <div>
                                    <i class="far fa-credit-card"></i>
                                </div>
                                <span>Onlayn ödəniş</span>
                            </a>
                                                            <a href="https://166.az/az/login">
                                    <div>
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <span>Daxil ol</span>
                                </a>
                                                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="header-secondary">
        <div class="container header-container header-secondary__container">
            <div class="header-logo">
                <a href="https://166.az/az">
                    <img src="https://166.az/site/img/Logo.png?v=1574778128" alt="166 Yükdaşıma Xidməti - Xalça yuma, Təmizlik, Usta xidməti">
                </a>
            </div>
            <nav class="header-navbar custom-nav d-none d-lg-flex">
                <div class="header-dropdown header-navbar__dropdown">
                    <a class="header-navbar__item">Xidmətlər</a>
                    <div class="header-dropdown__menu header-navbar__dropdown--menu header-maindropdown__menu">
                        <ul class="list-unstyled">
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/yukdasima">Yükdaşıma</a>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/xalca-yuma">Xalça yuma</a>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/temizlik-xidmeti">Təmizlik Xidməti</a>
                                                                            <div class="header-dropdown__menu header-navbar__dropdown--menu header-subdropdown__menu">
                                            <ul class="list-unstyled">
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/evlerin-temizlenmesi">Ev təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/temizlik-paketleri">Təmizlik paketləri</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/ofis-temizliyi">Ofis təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/kimyevi-temizleme">Yumşaq mebellərin kimyəvi təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/erazi-temizliyi">Ərazi təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/temirden-sonra-temizlik">Təmir sonrası təmizlik</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/bag-evi-temizliyi">Bağ evlərinin təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/perde-yuma">Pərdə və Jaluz yuma</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/fasad-temizliyi">Fasad təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/kovrolit-temizliyi">Kovrolit təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/pencere-temizliyi">Pəncərə təmizliyi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/temizlik-xidmeti/cilciraq-temizliyi">Çilçıraq təmizliyi</a>
                                                    </li>
                                                                                            </ul>
                                        </div>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/evakuasiya-evakuator-xidmeti">Evakuasiya</a>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/anbar-xidmeti">Anbar Xidməti</a>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/isci-quvvesi-xidmeti">İşçi qüvvəsi xidməti</a>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/usta-xidmeti">Usta xidməti</a>
                                                                            <div class="header-dropdown__menu header-navbar__dropdown--menu header-subdropdown__menu">
                                            <ul class="list-unstyled">
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/mebel-ustasi">Mebel ustasi</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/elektrik-ustasi">Elektrik ustası</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/santexnik-ustasi">Santexnik ustası</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/kondisioner-ustasi">Kondisioner ustası</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/diger-xidmetler">Digər xidmətlər</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/usta-xidmeti/paketleme-xidmeti">Paketləmə xidməti</a>
                                                    </li>
                                                                                            </ul>
                                        </div>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/sanitariya-xidmeti">Sanitariya xidməti</a>
                                                                            <div class="header-dropdown__menu header-navbar__dropdown--menu header-subdropdown__menu">
                                            <ul class="list-unstyled">
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/dezinfeksiya">Dezinfeksiya</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/dezinseksiya">Dezinseksiya</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/deratizasiya">Deratizasiya</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/ilanlara-qarsi-dermanlama">İlanlara qarşı dərmanlama</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/fumiqasiya">Fumiqasiya</a>
                                                    </li>
                                                                                                    <li>
                                                        <i class="fa fa-chevron-right"></i>
                                                        <a href="https://166.az/az/sanitariya-xidmeti/bagban-xidmeti">Bağban xidməti</a>
                                                    </li>
                                                                                            </ul>
                                        </div>
                                                                    </li>
                                                            <li class="header-dropdown header-subdropdown">
                                    <i class="fa fa-chevron-right"></i>
                                    <a href="https://166.az/az/karqo">Karqo xidməti</a>
                                                                    </li>
                                                    </ul>
                    </div>
                </div>
                <a class="header-navbar__item"
                   href="https://166.az/az/campaigns">Kampaniyalar</a>
                <a class="header-navbar__item" href="https://166.az/az/cars">Avtopark</a>
                <div class="header-dropdown header-navbar__dropdown">
                    <a class="header-navbar__item">Şirkətimiz</a>
                    <div class="header-dropdown__menu header-navbar__dropdown--menu header-maindropdown__menu">
                        <ul class="list-unstyled">
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/about">Haqqımızda</a>
                            </li>
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/team">Bizim komanda</a>
                            </li>
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/media">Mediada biz</a>
                            </li>
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/blog">Bloq</a>
                            </li>
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/faq">Tez-tez verilən suallar</a>
                            </li>
                            <li>
                                <i class="fa fa-chevron-right"></i>
                                <a href="https://166.az/az/gallery">Qalereya</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <a class="header-navbar__item" target="_blank" href="https://hr.166.az/">Karyera</a>
                <a class="header-navbar__item" href="https://166.az/az/comments">Rəylər</a>
                <a class="header-navbar__item" href="https://166.az/az/contact">Əlaqə</a>
            </nav>
            <form class="header-search" id="header-search" method="get" action="https://166.az/az/services">
                <button type="submit">
                    <i class="fa fa-search"></i>
                </button>
                <input name="search" type="text" placeholder="Axtar..." value="">
                            </form>
            <div class="header-dropdown header-language__dropdown">
                <div class="header-language">
                    <img src="https://166.az/site/img/az.svg?v=1569247768" alt="Azərbaycan dili">
                    <a>AZ</a>
                </div>
                <div class="header-dropdown__menu header-language__dropdown--menu">
                    <ul>
                                                                                                                                        <li>
                                    <img width="10" src="https://166.az/site/img/en.svg?v=1587504929" alt="English" style="margin-right: 5px;">
                                    <a href="https://166.az/site/fonts/Roboto/Roboto-Light/Roboto-Thin.eot">EN</a>
                                </li>
                                                                                                                <li>
                                    <img width="10" src="https://166.az/site/img/ru.svg?v=1569247768" alt="Pусский язык" style="margin-right: 5px;">
                                    <a href="https://166.az/site/fonts/Roboto/Roboto-Light/Roboto-Thin.eot">RU</a>
                                </li>
                                                                        </ul>
                </div>
            </div>
            <div class="header-nav d-lg-none" onclick="openSecondaryMenu()">
                <a href="#">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
    </div>
    <div class="header-sidenav" id="headerSecondaryMenu">
        <a href="javascript:void(0)" class="header-sidenav__close" onclick="closeSecondaryMenu()">
            <i class="fa fa-close"></i>
        </a>
        <ul class="list-unstyled">
            <li>
                <a class="header-sidenav__item" href="javascript:void(0)">
                    Xidmətlər
                    <i class="fa fa-chevron-down"></i>
                </a>
                <ul>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/yukdasima">
                                Yükdaşıma
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/xalca-yuma">
                                Xalça yuma
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/temizlik-xidmeti">
                                Təmizlik Xidməti
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/evakuasiya-evakuator-xidmeti">
                                Evakuasiya
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/anbar-xidmeti">
                                Anbar Xidməti
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/isci-quvvesi-xidmeti">
                                İşçi qüvvəsi xidməti
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/usta-xidmeti">
                                Usta xidməti
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/sanitariya-xidmeti">
                                Sanitariya xidməti
                            </a>
                        </li>
                                            <li>
                            <a class="header-sidenav__subitem" href="https://166.az/az/karqo">
                                Karqo xidməti
                            </a>
                        </li>
                                    </ul>

            </li>
            <li>
                <a class="header-sidenav__item"
                   href="https://166.az/az/campaigns">Kampaniyalar</a>
            </li>
            <li>
                <a class="header-sidenav__item" href="https://166.az/az/cars">Avtopark</a>
            </li>
            <li>
                <a class="header-sidenav__item" href="javascript:void(0)">
                    Şirkətimiz
                    <i class="fa fa-chevron-down"></i>
                </a>
                <ul>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/about">Haqqımızda</a>
                    </li>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/team">Bizim komanda</a>
                    </li>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/media">Mediada biz</a>
                    </li>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/blog">Bloq</a>
                    </li>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/faq">Tez-tez verilən suallar</a>
                    </li>
                    <li>
                        <a class="header-sidenav__subitem"
                           href="https://166.az/az/gallery">Qalereya</a>
                    </li>
                </ul>
            </li>
            <li>
                <a class="header-sidenav__item" target="_blank" href="https://hr.166.az/">Karyera</a>
            </li>
            <li>
                <a class="header-sidenav__item" href="https://166.az/az/comments">Rəylər</a>
            </li>
            <li>
                <a class="header-sidenav__item" href="https://166.az/az/contact">Əlaqə</a>
            </li>
        </ul>
    </div>
</header>
<div class="bot">
    <div class="bot-callback">
        <div class="bot-callback__inner">
            <a href="#" class="bot-callback__icon" data-toggle="modal" data-target="#newOrder-callback">
                <i class="fas fa-phone-alt"></i>
            </a>
        </div>
    </div>
</div> <!-- ========================= Section - Header ============================== -->

<div class="modal-sure">
    <div class="modal-sure__body">
        <div class="modal-sure__content">
            <div class="modal-sure__close">
                <i class="fa fa-times"></i>
            </div>
            <p class="modal-sure__text">Çıxmaq istədiyinizə əminsinizmi?</p>
            <div class="modal-sure__buttons">
                <button class="modal-sure__cancel">Xeyr</button>
                <button class="modal-sure__submit" data-dismiss="modal">Bəli</button>
            </div>
        </div>
    </div>
</div>



    <main class="container error">
        <img src="https://166.az/site/img/404.png?v=1569247768">
        <h1>Səhifə tapılmadı</h1>
        <p>Narahatçılığa görə üzr istəyirik. Daxil olmaq istədiyiniz səhifə mövcud deyil və ya bizim tərəfimizdən silinmişdir.</p>
        <a href="https://166.az/az">ANA SƏHİFƏYƏ QAYIT</a>
    </main>


<footer class="footer">
    <div class="footer-primary">
        <div class="container footer-primary__container">
            <div class="footer-primary__left">
                <div class="footer-primary__tab tab-primary   active  ">
                    <a  >Fərdi Müştərilər</a>
                </div>
                <div class="footer-primary__tab tab-secondary  ">
                    <a  href="https://166.az/site/fonts/Roboto/Roboto-Light/Roboto-Thin.eot"  >Korporativ Müştərilər</a>
                </div>
            </div>
            <div class="footer-primary__right d-none d-lg-flex">
                <a href="#" data-toggle="modal" data-target="#callBack">
                    <div>
                        <i class="fa fa-phone-alt"></i>
                    </div>
                    <span>Geri zəng</span>
                </a>
                <a href="#" data-toggle="modal" data-target="#onlinePayment">
                    <div>
                        <i class="far fa-credit-card"></i>
                    </div>
                    <span>Onlayn ödəniş</span>
                </a>
                                    <a href="https://166.az/az/login">
                        <div>
                            <i class="fas fa-user"></i>
                        </div>
                        <span>Daxil ol</span>
                    </a>
                            </div>
            <div class="footer-profile d-lg-none">
                <div class="dropdown footer-profile__dropdown">
                    <a href="#" data-toggle="dropdown">
                        <i class="fa fa-user"></i>
                    </a>
                    <div class="dropdown-menu footer-profile__dropdown--menu">
                        <div class="footer-primary__right">
                            <a href="#" data-toggle="modal" data-target="#callBack">
                                <div>
                                    <i class="fas fa-phone-alt"></i>
                                </div>
                                <span>Geri zəng</span>
                            </a>
                            <a href="#" data-toggle="modal" data-target="#onlinePayment">
                                <div>
                                    <i class="far fa-credit-card"></i>
                                </div>
                                <span>Onlayn ödəniş</span>
                            </a>
                                                            <a href="https://166.az/az/login">
                                    <div>
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <span>Daxil ol</span>
                                </a>
                                                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!---Footer Primary-->
    <div class="footer-secondary">
        <div class="container footer-secondary__container">
            <div class="footer-secondary__left">
                <h6>ƏLAQƏ</h6>
                <div class="footer-contact">
                    <p>Ünvan: Yeni Həyat Plaza 55 Zərifə Əliyeva, Bakı, Azərbaycan</p>
                    <p>Əlaqə nömrəsi: +994502534616</p>
                    <p>Elektron poçt: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d8b1b6beb798e9eeeef6b9a2">[email&#160;protected]</a></p>
                    <ul class="list-unstyled social-network">
                                                    <li class="social-network-fb">
                                <a target="_blank" href="https://www.facebook.com/166YukdasimaveLogistika">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                            </li>
                                                                            <li class="social-network-in">
                                <a target="_blank" href="https://www.linkedin.com/company/166-yukdasima-ve-logistika/">
                                    <i class="fab fa-linkedin-in"></i>
                                </a>
                            </li>
                                                                            <li class="social-network-ins">
                                <a target="_blank" href="https://www.instagram.com/166_yukdasima_ve_logistika/">
                                    <i class="fab fa-instagram"></i>
                                </a>
                            </li>
                                                                            <li class="social-network-ytb">
                                <a target="_blank" href="https://www.youtube.com/channel/UCmfn7kex_svjeOg7-GRpngg">
                                    <i class="fab fa-youtube"></i>
                                </a>
                            </li>
                                            </ul>
                </div>
            </div>
            <div class="footer-secondary__center">
                <h6>XİDMƏTLƏR</h6>
                <ul class="list-unstyled">
                                            <li>
                            <a href="https://166.az/az/yukdasima">
                                Yükdaşıma
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/xalca-yuma">
                                Xalça yuma
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/temizlik-xidmeti">
                                Təmizlik Xidməti
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/evakuasiya-evakuator-xidmeti">
                                Evakuasiya
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/anbar-xidmeti">
                                Anbar Xidməti
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/isci-quvvesi-xidmeti">
                                İşçi qüvvəsi xidməti
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/usta-xidmeti">
                                Usta xidməti
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/sanitariya-xidmeti">
                                Sanitariya xidməti
                            </a>
                        </li>
                                            <li>
                            <a href="https://166.az/az/karqo">
                                Karqo xidməti
                            </a>
                        </li>
                                    </ul>
            </div>
            <div class="footer-secondary__center">
                <h6>FAYDALI LİNKLƏR</h6>
                <ul class="list-unstyled">
                    <li>
                        <a href="https://166.az/az/about">Haqqımızda</a>
                    </li>
                    <li>
                        <a href="https://166.az/az/team">Bizim komanda</a>
                    </li>
                    <li>
                        <a href="https://166.az/az/media">Mediada biz</a>
                    </li>
                    <li>
                        <a href="https://166.az/az/blog">Bloq</a>
                    </li>
                    <li>
                        <a href="https://166.az/az/faq">Tez-tez verilən suallar</a>
                    </li>
                    <li>
                        <a href="https://166.az/az/gallery">Qalereya</a>
                    </li>
                </ul>
            </div>
            <div class="footer-secondary__right">
                <h6>BLOQ</h6>
                <div class="footer-blog">
                                            <a class="footer-blog__item"
                           href="https://166.az/az/blog-post/33">
                            <div class="footer-blog__item--left">
                                <img src="https://166.az/uploads/post/d1087dca22c16ec886a6de571d5fe28b_avatar.png?v=1666269695" alt="">
                            </div>
                            <div class="footer-blog__item--right">
                                <div class="footer-blog__item--date">
                                    <div class="day">20</div>
                                    <div
                                            class="month">Okt</div>
                                </div>
                                <p>Dezinfeksiyaedici maddələr hansılardır?</p>
                            </div>
                        </a>
                                            <a class="footer-blog__item"
                           href="https://166.az/az/blog-post/32">
                            <div class="footer-blog__item--left">
                                <img src="https://166.az/uploads/post/70268ef96186d0c7561fd3b91e02b198_avatar.jpg?v=1666266402" alt="">
                            </div>
                            <div class="footer-blog__item--right">
                                <div class="footer-blog__item--date">
                                    <div class="day">20</div>
                                    <div
                                            class="month">Okt</div>
                                </div>
                                <p>Mebel ustası xidməti hər daim qapınızda!</p>
                            </div>
                        </a>
                                    </div>
            </div>
        </div>
    </div> <!---Footer Secondary-->
    <div class="footer-tertiary">
        <p>
            <span>© 2019 | 166.az</span><strong>&nbsp;|&nbsp;</strong><span>Bütün hüquqlar qorunur</span><strong>&nbsp;|&nbsp;</strong>
            <span>Design by:&nbsp;</span><a href="https://crocusoft.com/" target="_blank">CROCUSOFT</a>
        </p>
    </div> <!---Footer Tertiary-->
</footer> <!-- ========================= Section - Footer ============================== -->

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<script src="https://166.az/site/js/libs.min.js?v=1575972465"></script>
<script src="https://166.az/site/js/tempus-dominus.js?v=1575985340"></script>
<script src="https://166.az/site/js/locale-en-gb.js?v=1659074204"></script>
<script src="https://166.az/site/js/locale-az.js?v=1659074178"></script>
<script src="https://166.az/site/js/locale-ru.js?v=1659074440"></script>
<script src="https://166.az/site/js/common.js?v=1611567991"></script>
<script src="https://166.az/site/js/jquery.inputmask.js?v=1659074144"></script>
<script src="https://166.az/site/js/inputmask.js?v=1659074108"></script>
<script src="https://166.az/site/js/inputmask.binding.js?v=1659074079"></script>


<!-- BEGIN JIVOSITE CODE {literal} -->
<script type='text/javascript'>
    ( function()
    {
        var widget_id = 'NKYZyC3L4N';
        var d = document;
        var w = window;

        function l()
        {
            var s = document.createElement( 'script' );
            s.type = 'text/javascript';
            s.async = true;
            s.src = '//code.jivosite.com/script/widget/' + widget_id
            ;var ss = document.getElementsByTagName( 'script' )[ 0 ];
            ss.parentNode.insertBefore( s , ss );
        }

        if( d.readyState == 'complete' )
        {
            l();
        } else
        {
            if( w.attachEvent )
            {
                w.attachEvent( 'onload' , l );
            } else
            {
                w.addEventListener( 'load' , l , false );
            }
        }
    } )();

    /*function rere($number) {

    }*/
</script>
<!-- {/literal} END JIVOSITE CODE -->




<!--Js Cookie -->
    <script src='https://166.az/admin/js/js.cookie.min.js?v=1544878560'></script>

    <!--SweetAlert2 -->
    <script src='https://166.az/admin/js/sweetalert2.all.min.js?v=1540642556'></script>

    <!--Underscore -->
    <script src='https://166.az/admin/js/underscore-min.js?v=1547317722'></script>


    <script type="text/javascript">
        _.templateSettings.variable = "rc";

        let locale = 'az' ,
            csrf = '4aKlqwlXwd7b9RU5R23Kv6G6YEKsZgsl2q2JiJUt' ,
            deleted_files = [];


        function loading( state = 0 )
        {
            if( state )
            {
                $( '#loading' ).show();

                $( 'body' ).addClass( 'loading-progress' );
            } else
            {
                $( '#loading' ).hide();

                $( 'body' ).removeClass( 'loading-progress' );
            }
        }


        function error( message = '' , title = "Xəta baş verdi" )
        {
            const swalWithBootstrapButtons = swal.mixin( {
                confirmButtonClass : 'btn btn-primary' ,
                buttonsStyling : false ,
            } );

            swalWithBootstrapButtons( {
                title : title ,
                text : message ,
                type : 'warning'
            } );

            loading();
        }


        function init()
        {
            
            loading();
        }


        function createModal( title , body , close = true , widthClass = 'my-col-xs-11 my-col-sm-10 my-col-md-9 my-col-lg-8' , buttons = '' , headerClass = '' )
        {
            var headerClass = typeof headerClass === "undefined" ? "" : headerClass ,
                widthClass = typeof widthClass === "undefined" ? "" : widthClass ,
                buttons = typeof buttons === "undefined" ? "" : buttons ,
                modalNumber = createModalHTML( widthClass , close );

            var m = $( "#newModal" + modalNumber );
            m.find( ".modal-content" ).children( ":not([do=loading] , .modal-header:eq(0) , .modal-body:eq(0) , .modal-footer:eq(0))" ).remove();
            if( m.find( ".modal-content" ).children( ".modal-body" ).length == 0 )
            {
                m.find( ".modal-content" ).append( '<div class="modal-body"></div>' );
            }
            if( m.find( ".modal-content" ).children( ".modal-footer" ).length == 0 )
            {
                //m.find( ".modal-content" ).append( '<div class="modal-footer"></div>' );
            }
            m.find( ".modal-header" ).addClass( headerClass );
            m.find( ".modal-title" ).html( title );
            m.find( ".modal-body-content" ).html( body );
            m.find( ".modal-footer" ).html( buttons );
            m.css( 'cssText' , 'z-index: ' + ( 12 + modalNumber * 2 ) + ' !important; top: 50px !important; margin-left: 77px;' );
            m.modal( "show" );
            m.next( '.modal-backdrop' ).css( 'cssText' , 'z-index: ' + ( 11 + modalNumber * 2 ) + ' !important' );

            if( m.find( '[x-modal-title]' ) ) m.find( '.modal-title' ).html( m.find( '[x-modal-title]' ).attr( 'x-modal-title' ) );

            if( m.find( '[x-modal-class]' ) ) m.find( '.modal-dialog' ).addClass( m.find( '[x-modal-class]' ).attr( 'x-modal-class' ) );

            return m;
        }

        function createModalHTML( widthClass , close )
        {
            var n = 1;
            while( $( "#newModal" + n ).length ) n++;
            var effects = [ "flipInX" , "flipInY" , "pulse" , "jello" , "fadeIn" ] ,
                effect = effects[ Math.floor( Math.random() * 111 ) % effects.length ];
            $( "body" ).append( '<div class="modal scroll fade" id="newModal' + n + '" role="dialog" ' + ( close ? '' : 'data-backdrop="static"' ) + '><div class="modal-dialog ' + effect + ' ' + widthClass + ' animated"><div class="modal-content"><div class = "modal-header" style = "width: 100%; position: relative; padding: 8px;"><h4 class = "modal-title" style="font-size: 21px; margin-left: 10px;"></h4><span class="close-modal" data-dismiss="modal" aria-label="Close" style="position:absolute; top: 9px; right: 9px; cursor: pointer;"><i class="la la-close" style="font-size: 30px; font-weight: bold;"></i></span></div><div class="modal-body scroll" style="max-height: ' + ( window.innerHeight - 185 ) + 'px;"><div class="row modal-body-content"></div></div></div></div></div></div>' );
            $( "#newModal" + n ).on( "hidden.bs.modal" , function()
            {
                $( this ).remove();
            } );
            return n;
        }


        function pagination( page , all , per , length , list = 'main' )
        {
            let show = 3 , count = Math.ceil( all / per ) , html = '';

            if( all )
            {
                html += '<ul class="m-datatable__pager-nav"><h5 style="color: #ffc425;">Total: ' + all + '</h5></ul>';
            }

            if( count > 1 )
            {
                html += '<ul class="m-datatable__pager-nav pull-right" style="margin-top: 5px; margin-left: 30px;">';

                if( page > 1 )
                {
                    html += '<li><a x-paginate="' + ( page - 1 ) + '" class="m-datatable__pager-link"><i class="la la-angle-left"></i></a></li>';
                }

                if( page > ( show + 1 ) )
                {
                    html += '<li><a x-paginate="1" class="m-datatable__pager-link">1</a></li>';

                    if( page > ( show + 2 ) )
                    {
                        html += '<li><a>. . .</a></li>';
                    }
                }

                for( let i = 1; i <= count; i++ )
                {
                    if( ( page > i && ( page - i ) <= show ) || ( page < i && ( i - page ) <= show ) || i === page )
                    {
                        html += '<li><a ' + ( i !== page ? 'x-paginate="' + i + '"' : '' ) + ' class="m-datatable__pager-link ' + ( i === page ? 'm-datatable__pager-link--active' : '' ) + '">' + i + '</a></li>';
                    }
                }

                if( ( count - page ) > show )
                {
                    if( ( count - page ) > ( show + 1 ) )
                    {
                        html += '<li><a>. . .</a></li>';
                    }

                    html += '<li><a x-paginate="' + count + '" class="m-datatable__pager-link">' + count + '</a></li>';
                }

                if( page < count )
                {
                    html += '<li><a x-paginate="' + ( page + 1 ) + '" class="m-datatable__pager-link"><i class="la la-angle-right"></i></a></li>';
                }
            }

            $( '[x-pagination="' + list + '"]' ).html( html );


            if( ( page - 1 ) * per + length < all ) $( '[x-more]' ).show();
            else $( '[x-more]' ).hide();
        }


        function checkboxList()
        {
            $( '[x-checkbox-list]' ).each( function()
            {
                let t = $( this ) ,
                    name = t.attr( 'x-checkbox-list' ) ,
                    f = t.closest( 'form' ) ,
                    parameters = [];

                if( t.find( '[x-checkbox-id]' ).length )
                {
                    t.find( '[x-checkbox-id]' ).each( function()
                    {
                        let i = $( this ) , id = i.attr( 'x-checkbox-id' );

                        if( id != undefined && i.prop( 'checked' ) )
                        {
                            parameters.push( id );
                        }
                    } );
                }

                if( name != undefined )
                {
                    if( name === 'roles' && t.find( '[x-checkbox-id="admin"]' ).prop( 'checked' ) )
                    {
                        f.find( '[name="' + name + '"]' ).val( 'admin' );
                    } else
                    {
                        f.find( '[name="' + name + '"]' ).val( parameters );
                    }
                }
            } );
        }


        function media( url )
        {
            try
            {
                let http = new XMLHttpRequest();
                http.open( 'HEAD' , url , false );
                http.send();
                return http.status < 300 ? url : 'https://166.az/uploads/default.png?v=1564074968';
            } catch( e )
            {
                return 'https://166.az/uploads/default.png?v=1564074968';
            }
        }


        function images( data )
        {
            if( data.images !== undefined && data.images.length )
            {
                for( let i in data.images )
                {
                    $( '[x-images]' ).append( _.template( $( 'script[x-image]' ).html() )( data.images[ i ] ) );
                }
            }
        }


        $( document ).ready( function()
        {
            $( '[x-list-form="main"]' ).append( '<input type="hidden" name="page" value="1">' );

            if( $( '[x-service]' ).length ) $( '[x-list-form]' ).append( '<input type="hidden" name="service" value="All">' );

                        $( '[x-list-form="main"]' ).append( '<input type="hidden" name="per" value="10"><input type="hidden" name="search" value="">' );
            

            $( document ).on( 'submit' , '[x-list-form]' , function( e )
            {
                e.preventDefault();

                loading( 1 );

                let t = $( this ) , formData = new FormData( this ) , html = '' , body = t.find( '[x-list-tbody]' ) ,
                    list = t.attr( 'x-list-form' ) ,
                    modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'tr';

                if( !body.length ) body = $( '[x-list-tbody]' );

                formData.append( '_token' , csrf );

                $.ajax( {
                    type : 'POST' ,
                    url : t.attr( 'action' ) ,
                    data : formData ,
                    cache : false ,
                    contentType : false ,
                    processData : false ,
                    success : function( res )
                    {
                        if(
                            res &&
                            typeof ( res[ 'data' ] ) !== 'undefined' &&
                            typeof ( res[ 'all' ] ) !== 'undefined' &&
                            typeof ( res[ 'page' ] ) !== 'undefined' &&
                            typeof ( res[ 'per' ] ) !== 'undefined'
                        )
                        {
                            let data = res[ 'data' ] ,
                                all = res[ 'all' ] ,
                                page = res[ 'page' ] ,
                                per = res[ 'per' ];

                            if( data.length )
                            {
                                var k = 1;

                                for( let i in data )
                                {
                                    data[ i ][ 'no' ] = k++;

                                    html += _.template( $( 'script[x-' + modal + ']' ).html() )( data[ i ] );
                                }
                            } else
                            {
                                html = '<tr><td colspan="55" style="text-align: center;"><h4>No data found!</h4></td></tr>';
                            }

                            pagination( page , all , per , data.length , list );

                            body.html( html );

                                                        body.closest( '.scroll' ).animate( { scrollTop : 0 } , 'slow' );
                            
                            loading();
                        } else
                        {
                            error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                        }
                    }
                } );
            } );


            $( document ).on( 'click' , '[x-paginate]' , function()
            {
                let page = $( this ).attr( 'x-paginate' ) ,
                    list = $( this ).closest( '[x-pagination]' ).attr( 'x-pagination' );

                $( '[x-list-form="' + list + '"] [name="page"]' ).val( page );

                $( '[x-list-form="' + list + '"]' ).submit();
            } );


            $( document ).on( 'click' , '[x-more]' , function()
            {
                let t = $( this ) ,
                    form = t.closest( 'form' ) ,
                    input = form.find( '[name="page"]' ) ,
                    page = input.val();

                input.val( ++page );

                form.submit();
            } );


            $( document ).on( 'click' , '[x-service]' , function( e )
            {
                e.stopPropagation();
                e.preventDefault();

                let t = $( this ) ,
                    form = t.closest( 'form' ) ,
                    input = form.find( '[name="service"]' ) ,
                    service = t.attr( 'x-service' );

                input.val( service );

                $( '.filter li' ).not( this ).removeClass( 'active' );
                $( this ).addClass( 'active' );

                form.submit();
            } );


            $( document ).on( 'change' , '[x-per]' , function()
            {
                let per = $( this ).val();

                $( '[x-list-form="main"] [name="per"]' ).val( per );

                $( '[x-list-form="main"]' ).submit();
            } );


            $( document ).on( 'change' , '[x-search]' , function()
            {
                let search = $( this ).val();

                $( '[x-list-form="main"] [name="search"]' ).val( search );

                $( '[x-list-form="main"]' ).submit();
            } );


            $( document ).on( 'change' , '[x-list-form] select' , function()
            {
                if( $( this ).attr( 'x-no-submit' ) === undefined ) $( this ).closest( '[x-list-form]' ).submit();
            } );


            $( document ).on( 'change' , '[x-list-form] input' , function()
            {
                if( $( this ).attr( 'x-activate-url' ) === undefined && $( this ).attr( 'x-no-submit' ) === undefined ) $( this ).closest( '[x-list-form]' ).submit();
            } );


            $( document ).on( 'click' , '[x-edit-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    id = tr.attr( 'x-tr-id' ) , xId = t.attr( 'x-modal-id' ) ,
                    url = t.attr( 'x-edit-url' ) ,
                    _modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'edit-modal' ,
                    list = t.closest( '[x-list-form]' ).attr( 'x-list-form' );

                id = xId !== undefined ? xId : id;

                $.post( url , {
                    'id' : id ,
                    '_token' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        res[ 'data' ][ 'x_list_form' ] = list;

                        let info = _.template( $( 'script[x-' + _modal + ']' ).html() )( res[ 'data' ] ) ,
                            modal = createModal( 'Edit' , '<div class="modal-body">' + info + '</div>' , false );

                        init();

                        setTimeout( function()
                        {
                            if( res.data.service ) modal.find( '[name="service"]' ).val( res.data.service ).trigger( 'change' );
                            if( res.data.service_id ) modal.find( '[name="service"]' ).val( res.data.service_id ).trigger( 'change' );
                            if( res.data.parent_id ) modal.find( '[name="parent"]' ).val( res.data.parent_id ).trigger( 'change' );
                            if( res.data.type_id ) modal.find( '[name="type"]' ).val( res.data.type_id ).trigger( 'change' );

                            $( '[x-checkbox-list]' ).each( function()
                            {
                                var t = $( this ) , name = t.attr( 'x-checkbox-list' ) ,
                                    max = t.attr( 'x-checkbox-max' );

                                if( res.data[ name ] != undefined && res.data[ name ].length )
                                {
                                    if( $.type( res.data[ name ] ) == 'string' )
                                    {
                                        let variants = res.data[ name ].split( ',' );

                                        if( name === 'roles' && variants == 'admin' )
                                        {
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]' ).prop( 'checked' , true );
                                        } else if( variants.length )
                                        {
                                            $.each( variants , function( k , variant )
                                            {
                                                $( '[x-checkbox-list="' + name + '"] [x-checkbox-id="' + variant + '"]' ).prop( 'checked' , true );
                                            } );
                                        }

                                        if( max !== undefined && variants.length >= max )
                                        {
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]:not(:checked)' ).prop( 'disabled' , true );
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]:not(:checked)' ).closest( 'label' ).addClass( 'disabled' );
                                        }
                                    }
                                }
                            } );

                            new mPortlet( 'm_portlet_tools_role' );

                            setTimeout( function()
                            {
                                if( $.isFunction( window.campaignActivities ) ) campaignActivities( res.data );

                                checkboxList();
                            } , 55 );
                        } , 5 );
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'click' , '[x-add]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , _modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'edit-modal' ,
                    list = t.closest( '[x-list-form]' ).attr( 'x-list-form' ) ,
                    column = t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : false ,
                    value = t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null ,
                    data = { x_list_form : list };

                if( column ) data[ [ column ] ] = value;

                let info = _.template( $( 'script[x-' + _modal + ']' ).html() )( data ) ,
                    modal = createModal( 'Add' , '<div class="modal-body">' + info + '</div>' , false );

                init();

                setTimeout( function()
                {
                    new mPortlet( 'm_portlet_tools_role' );

                    if( $.isFunction( window.addDependency ) ) addDependency();
                } , 5 );
            } );


            $( document ).on( 'submit' , '[x-edit-form]' , function( e )
            {
                e.preventDefault();

                let submitButton = $( this ).find( '[type="submit"]' );
                // submitButton.attr( 'disabled' , 'disabled' );

                loading( 1 );

                let t = $( this ) , formData = new FormData( this ) , url = t.attr( 'action' ) ,
                    list = t.attr( 'x-list' ) !== undefined ? t.attr( 'x-list' ) : 'main' ,
                    target = t.attr( 'x-target' ) ,
                    targetWithData = t.attr( 'x-target-with-data' );

                t.find( '[name]' ).each( function()
                {
                    let _t = $( this ) , name = _t.attr( 'name' );

                    if( name != 'rate' )
                    {
                        _t.css( 'border-color' , '#ebedf2' );

                        _t.prev( 'label' ).css( 'color' , '#575962' );
                    }

                    t.find( '[for="' + name + '"]' ).css( 'color' , '#575962' );
                } );

                t.find( '[x-tab-title]' ).css( 'color' , '#575962' );

                formData.append( '_token' , csrf );

                $.ajax( {
                    type : 'POST' ,
                    url : url ,
                    data : formData ,
                    cache : false ,
                    contentType : false ,
                    processData : false ,
                    success : function( res )
                    {

                        if( res[ 'status' ] === 'success' )
                        {
                            if( res.validations !== undefined && Object.keys( res.validations ).length )
                            {


                                $.each( res.validations , function( name , v )
                                {
                                    let tab = t.find( '[name="' + name + '"]' ).closest( '[x-tab]' ).attr( 'id' );

                                    if( name != 'rate' )
                                    {
                                        t.find( '[name="' + name + '"]' ).prev( 'label' ).css( 'color' , 'red' );

                                        t.find( '[name="' + name + '"]' ).css( 'border-color' , 'red' );
                                    }

                                    t.find( '[for="' + name + '"]' ).css( 'color' , 'red' );

                                    t.find( '[x-tab-title][href="#' + tab + '"]' ).css( 'color' , 'red' );
                                } );

                                submitButton.removeAttr( 'disabled' );
                            } else
                            {
                                $( '.modal-sure' ).hide();
                                $( '.modal' ).modal( 'hide' );
                                let title = res.title !== undefined ? res.title : 'Success!' ,
                                    text = res.text !== undefined ? res.text : '';

                                if( targetWithData && typeof window[ targetWithData ] === 'function' )
                                {
                                    window[ targetWithData ]( res );
                                } else if( target && typeof window[ target ] === 'function' )
                                {
                                    window[ target ]();
                                } else if( $.isFunction( window.editFormCallback ) ) editFormCallback( res );

                                else
                                {
                                    const swalWithBootstrapButtons = swal.mixin( {
                                        confirmButtonClass : 'btn btn-primary' ,
                                        buttonsStyling : false
                                    } );

                                    swalWithBootstrapButtons( {
                                        type : 'success' ,
                                        title : title ,
                                        text : text ,
                                        showConfirmButton : true
                                    } );

                                    if( t.attr( 'x-redirect-url' ) !== undefined )
                                    {
                                        location.href = t.attr( 'x-redirect-url' );
                                    } else if( t.closest( '.modal' ).length )
                                    {
                                        $( '[x-list-form="' + list + '"]' ).submit();

                                        t.closest( '.modal' ).modal( 'hide' );
                                    } else
                                    {
                                        //
                                    }
                                }
                            }

                            loading();
                        } else
                        {
                            error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                        }
                    } ,
                    error : function( res )
                    {
                        error( 'Network error!' );
                    }
                } );
            } );


            $( document ).on( 'click' , '[x-modal-view]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    modal_ = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'x-view-modal' ,
                    title = t.attr( 'x-modal-title' ) !== undefined ? t.attr( 'x-modal-title' ) : 'Info' ,
                    data = {
                        id : t.attr( 'x-modal-id' ) !== undefined ? t.attr( 'x-modal-id' ) : tr.attr( 'x-tr-id' ) ,
                        column : t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : '___' ,
                        value : t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null
                    } ,
                    info = _.template( $( 'script[' + modal_ + ']' ).html() )( data ) ,
                    modal = createModal( title , '<div class="modal-body">' + info + '</div>' );

                setTimeout( function()
                {
                    init();
                } , 55 );

                loading();
            } );


            $( document ).on( 'click' , '[x-view-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) , id = tr.attr( 'x-tr-id' ) ,
                    url = t.attr( 'x-view-url' ) ,
                    column = t.attr( 'x-modal-column' ) , xId = t.attr( 'x-modal-id' ) ,
                    modal_ = t.attr( 'x-modal' );

                column = column !== undefined ? column : 'id';

                id = xId !== undefined ? xId : id;

                modal_ = modal_ !== undefined ? modal_ : 'x-view-modal';

                $.post( url , {
                    [ column ] : id ,
                    '_token' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        var info = _.template( $( 'script[' + modal_ + ']' ).html() )( res[ 'data' ] ) ,
                            modal = createModal( 'Info' , '<div class="modal-body">' + info + '</div>' );

                        loading();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'click' , '[x-modal-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    id = t.attr( 'x-modal-id' ) !== undefined ? t.attr( 'x-modal-id' ) : tr.attr( 'x-tr-id' ) ,
                    url = t.attr( 'x-modal-url' ) , column = t.attr( 'x-modal-column' );

                column = column !== undefined ? column : 'id';

                $.post( url , {
                    [ column ] : id ,
                    '_token' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        modal = createModal( 'Info' , '<div class="modal-body">' + res[ 'data' ] + '</div>' );

                        setTimeout( function()
                        {
                            modal.find( '[x-list-form]' ).submit();
                        } , 5 );

                        init();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'change' , '[x-activate-url]' , function( e )
            {
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , url = t.attr( 'x-activate-url' ) , xId = t.attr( 'x-modal-id' ) ,
                    id = t.closest( '[x-tr-id]' ).attr( 'x-tr-id' ) ,
                    active = Number( t.prop( 'checked' ) ) , column = t.attr( 'x-modal-column' );

                id = xId !== undefined ? xId : id;

                column = column !== undefined ? column : 'active';

                $.post( url , {
                    'id' : id ,
                    '_token' : csrf ,
                    [ column ] : active
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        loading();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );

            $( document ).on( 'change' , '[x-activate-url-refresh]' , function( e )
            {
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , url = t.attr( 'x-activate-url-refresh' ) , xId = t.attr( 'x-modal-id' ) ,
                    id = t.closest( '[x-tr-id]' ).attr( 'x-tr-id' ) ,
                    active = Number( t.prop( 'checked' ) ) , column = t.attr( 'x-modal-column' );

                id = xId !== undefined ? xId : id;

                column = column !== undefined ? column : 'active';

                $.post( url , {
                    'id' : id ,
                    '_token' : csrf ,
                    [ column ] : active
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        loading();
                        $( '[x-list-form]' ).trigger( 'submit' );
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'change' , '[x-change-url]' , function( e )
            {
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , url = t.attr( 'x-change-url' ) , id = t.closest( '[x-tr-id]' ).attr( 'x-tr-id' ) ,
                    value = t.val() , column = t.attr( 'x-modal-column' );

                column = column !== undefined ? column : 'status';

                $.post( url , {
                    'id' : id ,
                    '_token' : csrf ,
                    [ column ] : value
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        loading();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'click' , '[x-checkbox-id]' , function()
            {
                let t = $( this ) , name = t.attr( 'x-checkbox-id' ) ,
                    p = t.closest( '[x-checkbox-list]' ) , p_name = p.attr( 'x-checkbox-list' ) ,
                    max = p.attr( 'x-checkbox-max' ) ,
                    group = t.closest( '[x-checkbox-group="' + name + '"]' ) ,
                    state = t.prop( 'checked' )
                ;

                if( p_name === 'roles' )
                {
                    if( name === 'admin' ) p.find( '[x-checkbox-id]' ).prop( 'checked' , state );

                    else if( !state ) p.find( '[x-checkbox-id="admin"]' ).prop( 'checked' , false );

                    else if( p.find( '[x-checkbox-id]:checked' ).length + 1 === p.find( '[x-checkbox-id]' ).length ) p.find( '[x-checkbox-id="admin"]' ).prop( 'checked' , true );
                }

                if( max !== undefined )
                {
                    if( p.find( '[x-checkbox-id]:checked' ).length >= max )
                    {
                        p.find( '[x-checkbox-id]:not(:checked)' ).prop( 'disabled' , 'disabled' );

                        p.find( '[x-checkbox-id]:not(:checked)' ).closest( 'label' ).addClass( 'disabled' );
                    } else
                    {
                        p.find( '[x-checkbox-id]' ).prop( 'disabled' , '' );

                        p.find( '[x-checkbox-id]:not(:checked)' ).closest( 'label' ).removeClass( 'disabled' );
                    }
                }

                if( group !== undefined && group.length && group.find( '[x-checkbox-id]' ).length ) group.find( '[x-checkbox-id]' ).prop( 'checked' , state );

                t.parents( '[x-checkbox-group]' ).each( function()
                {
                    let _t = $( this ) , _name = _t.attr( 'x-checkbox-group' );

                    if( !state || ( _t.find( '[x-checkbox-id]:checked' ).length + 1 === _t.find( '[x-checkbox-id]' ).length && _name !== 'admin' ) ) $( '[x-checkbox-id="' + _name + '"]' ).prop( 'checked' , state );
                } );

                setTimeout( function()
                {
                    checkboxList();
                } , 5 );
            } );


            $( document ).on( 'click' , '[x-delete-url]' , function( e )
            {
                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) , url = t.attr( 'x-delete-url' ) ,
                    _with = t.attr( 'x-with' ) , _with_id = t.attr( 'x-with-id' ) ,
                    id = tr.attr( 'x-tr-id' );


                const swalWithBootstrapButtons = swal.mixin( {
                    confirmButtonClass : 'btn btn-dark' ,
                    cancelButtonClass : 'btn btn-primary' ,
                    buttonsStyling : false ,
                } );

                swalWithBootstrapButtons( {
                    title : "Silmək istədiyinizə əminsinizmi?" ,
                    type : 'warning' ,
                    showCancelButton : true ,
                    confirmButtonText : "Bəli" ,
                    cancelButtonText : "Ləğv et" ,
                    reverseButtons : true
                } ).then( ( r ) =>
                {
                    if( r.value )
                    {
                        loading( 1 );

                        $.post( url , {
                            'id' : id ,
                            [ _with ] : _with_id ,
                            '_token' : csrf
                        } ).done( function( res )
                        {
                            if( res[ 'status' ] === 'success' )
                            {
                                tr.fadeOut( function()
                                {
                                    $( this ).remove();
                                } );

                                if( $.isFunction( window.__u ) ) __u();

                                loading();
                            } else
                            {
                                error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                            }
                        } ).fail( function()
                        {
                            error( 'Network error!' );
                        } );
                    }
                } );
            } );


            $( document ).on( 'keydown' , '[x-no-enter]' , function( e )
            {
                if( e.keyCode === 13 )
                {
                    e.preventDefault();
                    return false;
                }
            } );


            $( 'body' ).on( 'change' , '[x-photo-input]' , function( e )
            {
                let ext = e.target.files[ 0 ][ 'name' ].replace( /^.*\./ , '' ).toLowerCase() ,
                    t = $( this ) , name = t.attr( 'x-photo-input' ) ,
                    img = t.closest( '[x-photo]' ).find( '[x-photo-img="' + name + '"]' );

                if( ext == 'jpeg' || ext == 'png' || ext == 'jpg' )
                {
                    img.attr( 'src' , URL.createObjectURL( e.target.files[ 0 ] ) );
                } else
                {
                    t.val( '' );

                    img.attr( 'src' , img.attr( 'x-photo-default' ) );

                    error( '' , 'Select valid image extension' );
                }
            } );


            $( document ).on( 'click' , '[x-image-id] [x-image-delete]' , function( e )
            {
                e.stopPropagation();
                e.preventDefault();

                let div = $( this ).closest( '[x-image-id]' ) , id = div.attr( 'x-image-id' );

                deleted_files.push( id );

                $( '[name="deleted_files"]' ).val( JSON.stringify( deleted_files ) );

                div.fadeOut( function()
                {
                    $( this ).remove();
                } );
            } );


            $( document ).on( 'click' , '[x-customer]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                let type = $( this ).attr( 'x-customer' );

                $( '[x-customer]' ).removeClass( 'active' );
                // $( '[x-customer="individual"]' ).addClass( 'active' );
                $( '[x-customer="' + type + '"]' ).addClass( 'active' );

                $( '[x-customer-show]' ).addClass( 'hidden' );
                $( '[x-customer-show][x-' + type + ']' ).removeClass( 'hidden' );
            } );


            $( document ).keyup( function( e )
            {
                if( e.keyCode == 27 ) $( '.close-modal:last' ).click();
            } );

            
            init();

            $( '[x-list-form="main"]' ).submit();
        } )
        ;
    </script>


<style>

    .pac-container
    {
        z-index : 99999;
    }

    .newOrder .modal-dialog
    {
        max-width : unset;
        width     : max-content;
    }

    .form-row--number
    {
        display    : inline-block;
        margin-top : 1.25rem;
    }

    .form-row--number input[type="text"]
    {
        height                : 2.5rem;
        -webkit-border-radius : 10px;
        border-radius         : 10px;
        background-color      : #f7f7f7;
        border                : unset;
        padding-left          : .5rem;
        padding-right         : 1rem;
        color                 : #333537;
        font-size             : .75rem;
        font-weight           : 400;
    }

    .form-row--number label
    {
        display       : block;
        margin-bottom : .5625rem;
        color         : #98999a;
        font-size     : .6875rem;
        font-weight   : 500;
        line-height   : .875rem;
        white-space   : nowrap;
    }

    .daterangepicker
    {
        z-index : 1051;
    }

    .calendar .calendar-table .table-row .table-col.start-date .table-value-wrapper:hover
    {
        background : #ffc425;
    }

    .bootstrap-datetimepicker-widget table td span
    {
        display       : inline-block;
        width         : 30px;
        height        : 30px;
        line-height   : 30px;
        margin        : 2px 1.5px;
        cursor        : pointer;
        border-radius : 0.25rem;
        color         : #ffc425;
        font-size     : .625rem;
    }

    .bootstrap-datetimepicker-widget .timepicker-hour, .bootstrap-datetimepicker-widget .timepicker-minute, .bootstrap-datetimepicker-widget .timepicker-second
    {
        color : black;
    }

    .googleMap
    {
        width   : 100%;
        height  : 370px;
        display : none;
    }

    .modal-sure
    {
        width              : 100%;
        height             : 100%;
        position           : fixed;
        top                : 0;
        left               : 0;
        z-index            : 1100;
        background         : rgba(0, 0, 0, 0.8);
        -webkit-transform  : scale3d(0.9, 0.9, 0.9);
        transform          : scale3d(0.9, 0.9, 0.9);
        -webkit-transition : all 0.25s;
        -o-transition      : all 0.25s;
        transition         : all 0.25s;
        display            : none;
        opacity            : 0;
    }

    .modal-sure__body
    {
        width   : 100%;
        height  : 100%;
        padding : 15px;
        display : -webkit-box;
        display : -ms-flexbox;
        display : flex;
    }

    .modal-sure__content
    {
        width         : 100%;
        max-width     : 500px;
        border-radius : 12px;
        margin        : auto;
        background    : #FFFFFF;
        padding       : 24px;
    }

    .modal-sure__close
    {
        width                 : 1.875rem;
        height                : 1.875rem;
        -webkit-border-radius : 100%;
        border-radius         : 100%;
        background-color      : #f7f7f7;
        display               : -webkit-box;
        display               : -webkit-flex;
        display               : -ms-flexbox;
        display               : flex;
        -webkit-box-align     : center;
        -webkit-align-items   : center;
        -ms-flex-align        : center;
        align-items           : center;
        -webkit-box-pack      : center;
        -ms-flex-pack         : center;
        justify-content       : center;
        cursor                : pointer;
        margin-left           : auto;
    }

    .modal-sure__text
    {
        color          : #333537;
        font-size      : 16px;
        font-weight    : 400;
        letter-spacing : -.39px;
        line-height    : .9375rem;
        margin-right   : .4375rem;
        margin-top     : 1rem;
    }

    .modal-sure__buttons
    {
        width            : 100%;
        display          : -webkit-box;
        display          : -ms-flexbox;
        display          : flex;
        -webkit-box-pack : justify;
        -ms-flex-pack    : justify;
        justify-content  : space-between;
        margin-top       : 40px;
    }

    .modal-sure__cancel
    {
        width         : 48%;
        padding       : 8px 16px;
        border        : 2px solid #f7f7f7;
        background    : transparent;
        cursor        : pointer;
        border-radius : 6px;
        color         : #000000;
        font-size     : .875rem;
        font-weight   : 700;
        line-height   : 1.25rem;
        font-family   : Roboto;
        outline       : none;
    }

    .modal-sure__cancel:focus
    {
        outline : none;
    }

    .modal-sure__submit
    {
        width            : 48%;
        padding          : 8px 16px;
        cursor           : pointer;
        border-radius    : 6px;
        border           : none;
        background-color : #ffc425;
        color            : #ffffff;
        font-size        : .875rem;
        font-weight      : 700;
        line-height      : 1.25rem;
        font-family      : Roboto;
        outline          : none;
    }

    .modal-sure__submit:focus
    {
        outline : none;
    }


    .new-map
    {
        color               : #ffc425;
        font-size           : .625rem;
        font-weight         : 500;
        line-height         : 1rem;
        display             : -webkit-box;
        display             : -webkit-flex;
        display             : -ms-flexbox;
        display             : flex;
        -webkit-box-align   : center;
        -webkit-align-items : center;
        -ms-flex-align      : center;
        align-items         : center;
        margin-top          : 1.25rem;
        text-decoration     : none;
    }

    .new-map:hover
    {
        text-decoration : none;
        color           : #ffc425;
    }

    .new-map i
    {
        margin-right : .4375rem;
        font-size    : .75rem;
    }

    .order-ready
    {
        max-width   : 880px;
        margin-left : auto;
    }

    #order-details
    {
        max-width          : 1192px;
        -webkit-box-shadow : unset;
        box-shadow         : unset;
        padding            : unset;
        margin-top         : 0;
    }

    .bootstrap-datetimepicker-widget
    {
        list-style              : none;
        background              : #fff;
        -webkit-box-shadow      : 0 2px 15px rgba(0, 0, 0, .3);
        box-shadow              : 0 2px 15px rgba(0, 0, 0, .3);
        -ms-flex-pack           : start;
        -webkit-box-pack        : start;
        -webkit-justify-content : flex-start;
        justify-content         : flex-start;
        -webkit-border-radius   : 4px;
        border-radius           : 4px;
        padding                 : 4px;
        font-size               : 13px;
        font-family             : sans-serif;
        line-height             : 1.5em;
        margin-top              : 9px;
    }

    .bootstrap-datetimepicker-widget table td.active,
    .bootstrap-datetimepicker-widget table td.active:hover
    {
        background-color : #007bff;
        color            : #fff;
        text-shadow      : unset;
        background       : #ffc425;
    }

    .bootstrap-datetimepicker-widget table td span.active
    {
        background-color : #ffc425;
        color            : #fff;
        text-shadow      : unset;
    }

    .bootstrap-datetimepicker-widget table th.picker-switch
    {
        width          : 145px;
        text-transform : uppercase;
    }

    .bootstrap-datetimepicker-widget .next,
    .bootstrap-datetimepicker-widget .prev
    {
        position         : unset;
        margin-top       : 0 !important;
        border           : none !important;
        align-items      : center;
        justify-content  : center;
        height           : 28px !important;
        background-color : transparent;
        border-radius    : 0 !important;
    }

    .bootstrap-datetimepicker-widget .table thead th
    {
        border : none !important;
    }

    .bootstrap-datetimepicker-widget table td.today:before
    {
        display : none;
    }


    @media  only screen and (max-width : 1199px)
    {

        .newOrder .modal-dialog
        {
            max-width : 500px;
        }

        .newOrder .step
        {
            width   : 100%;
            padding : 20px 0;
        }

        .newOrder .order-details__body
        {
            -webkit-box-orient    : vertical;
            -webkit-box-direction : normal;
            -ms-flex-direction    : column;
            flex-direction        : column;
        }

        .newOrder #order-details__tabs
        {
            width : 100% !important;
        }

        .newOrder .order-details__overall
        {
            width : 100%;
        }

        .newOrder .order-details__body .order-all
        {
            width                 : 100%;
            -webkit-box-orient    : vertical;
            -webkit-box-direction : normal;
            -ms-flex-direction    : column;
            flex-direction        : column;
            -webkit-box-pack      : center;
            -ms-flex-pack         : center;
            justify-content       : center;
            padding               : 20px;
        }

        .newOrder .order-all__center
        {
            margin-left  : auto;
            margin-right : auto;
            max-width    : unset;
            text-align   : center;
        }

        .newOrder .order-bottom__right
        {
            width        : 100%;
            margin-left  : 0;
            margin-right : 0;
            padding      : 0;
        }

        .newOrder .order-all
        {
            padding               : 20px;
            width                 : 100%;
            -webkit-box-orient    : vertical;
            -webkit-box-direction : normal;
            -ms-flex-direction    : column;
            flex-direction        : column;
        }

        .newOrder .order-all__right button
        {
            width : 100% !important;
        }
    }

    @media  only screen and (max-width : 576px)
    {
        .newOrder .modal-dialog
        {
            max-width : 95%;
            margin    : .5rem auto;
        }
    }


</style>

<!-- geri zeng -->
<div id="newOrder-callback" class="modal fade newOrder  p-0 m-0">
    <div class="modal-dialog modal-service__dialog mobile-service">
        <div class="modal-content modal-service__content mobile-service__content">
            <div class="modal-body modal-service__body">
                <div class="btn-modal-call btn-success">
                    <a  id="codioServicePhoneShowHref">
                        <i>
                            <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.6125 13.4388L14.2225 11.8288C14.4393 11.6146 14.7137 11.468 15.0122 11.4068C15.3108 11.3455 15.6207 11.3723 15.9044 11.4838L17.8665 12.2672C18.1532 12.3835 18.399 12.5821 18.5729 12.838C18.7469 13.0938 18.8412 13.3953 18.844 13.7047V17.2984C18.8424 17.5089 18.7981 17.7168 18.714 17.9097C18.6299 18.1026 18.5076 18.2764 18.3544 18.4208C18.2013 18.5652 18.0206 18.6771 17.8231 18.7498C17.6256 18.8225 17.4155 18.8544 17.2053 18.8438C3.45561 17.9884 0.681232 6.34469 0.156545 1.88844C0.132188 1.66961 0.154442 1.4481 0.221842 1.23848C0.289241 1.02887 0.40026 0.835898 0.547593 0.67227C0.694926 0.508642 0.875235 0.378063 1.07666 0.289124C1.27808 0.200185 1.49605 0.154902 1.71623 0.156253H5.18779C5.49758 0.15717 5.80001 0.250745 6.05618 0.424943C6.31236 0.599141 6.51056 0.845994 6.62529 1.13375L7.40873 3.09594C7.52391 3.37846 7.5533 3.68865 7.49322 3.98777C7.43314 4.2869 7.28626 4.56168 7.07092 4.77782L5.46092 6.38782C5.46092 6.38782 6.38811 12.6625 12.6125 13.4388Z" fill="white"/>
                            </svg>

                        </i>
                        <span id="codioServicePhoneShow">

                    </span>

                    </a>
                </div>














                <p class='btn-modal-call-desc'>və ya
                    nömrənizi qeyd edin biz sizə zəng edək</p>

                <form action="https://166.az/az/callback" class="form order-form" method="post" x-edit-form="" x-target="afterCallback">
                    <div class="form-row phoneMaskParent  btn-modal-call-desc-input">
                        <input type="hidden" name="name" value="Mobil Geri Zəng">
                        <input type="hidden" id="serviceIdCodio" name="service" value="1">
                        <input type="hidden" id="" name="city" value="Baku">
                        <input type="hidden" id="" name="date" value="25.11.2022">
                        <input type="hidden" id="" name="time" value="12:00">
                        <input type="hidden" id="serviceEmail" name="email" value="" >
                        <input class="phoneMask phone2" type="text"   placeholder="Əlaqə nömrəsi" >
                        <input hidden type="text" name="phone" class="phone"  >
                    </div>

                    <button type="submit" class=" btn-submit">
                        Göndər
                    </button>
                </form>


            </div>
            <div class="modal-close btn-modal-close">
                <i class="fa fa-times"></i>
            </div>
        </div>
    </div>
</div>





<!-- sifaris et -->
<div id="newOrder" class="modal fade newOrder">
    <div class="modal-dialog modal-service__dialog">
        <div class="modal-content modal-service__content">
            <div class="modal-header modal-service__header">
                <h6>Xidmət sifariş ver</h6>
            </div>
            <div class="modal-body modal-service__body">
                <form action="https://166.az/az/order" method="post" x-order-final-form x-edit-form class="form order-form">
                    <input type="hidden" name="csrf_token" id="csrf-token" value="ef032196a297619992c869476761d197"/>
                    <input type="hidden" name="payment_type" value="cash">
                    <div id="order-forms" class="order-forms">
                        <div class="services_ids"></div>
                        <div class="order-top" data-id="1">
                            <div class="order-top__left step">
                                <p>
                                    <i class="fas fa-check-circle"></i>
                                    <span>Addım 1</span>
                                </p>
                                <div class="form-row">
                                    <label>Xidmət</label>
                                    <select id="step1" name="services[1][parent]">
                                                                                                                                    <option value="1" class="service_1">Yükdaşıma</option>
                                                                                                                                                                                <option value="3" class="service_3">Xalça yuma</option>
                                                                                                                                                                                <option value="4" class="service_4">Təmizlik Xidməti</option>
                                                                                                                                                                                <option value="22" class="service_22">Evakuasiya</option>
                                                                                                                                                                                <option value="23" class="service_23">Anbar Xidməti</option>
                                                                                                                                                                                <option value="24" class="service_24">İşçi qüvvəsi xidməti</option>
                                                                                                                                                                                <option value="25" class="service_25">Usta xidməti</option>
                                                                                                                                                                                <option value="132" class="service_132">Sanitariya xidməti</option>
                                                                                                                                                                                <option value="133" class="service_133">Karqo xidməti</option>
                                                                                                                        </select>
                                </div>
                                <hr>
                                <div class="form-row">
                                    <label for="name">Adınız</label>
                                    <input type="text" name="name" placeholder="Adınız" >
                                </div>
                                <div class="form-row phoneMaskParent">
                                    <label for="phone">Əlaqə nömrəsi</label>
                                    <input class="phoneMask phone2" type="text"   placeholder="Əlaqə nömrəsi" >
                                    <input hidden type="text" name="phone" class="phone"  >
                                </div>
                            </div>
                            <div class="order-top__center step" id="step_2">
                                <p>
                                    <i class="fas fa-check-circle"></i>
                                    <span>Addım 2</span>
                                </p>
                                <div class="order-top__children"></div>
                                <div class="order-top__inputs"></div>
                                <div
                                        class="order-top__children-inputs"></div>
                            </div>
                            <div class="order-top__right step step_3" id="step_3">
                                <p>
                                    <i class="fas fa-check-circle"></i>
                                    <span>Addım 3</span>
                                </p>
                                <div class="order-top__children"></div>
                                <div class="order-top__inputs"></div>
                                <div class="order-top__children-inputs"></div>
                            </div>
                        </div>
                    </div>
                    <div class="order-middle">
                        <div id="order-ready" class="order-ready d-flex flex-wrap"></div>
                        <button type="button" id="order-new" class="order-new" data-toggle="modal" data-target="#newService">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                            <span>Xidmət əlavə et</span>
                        </button>
                        <div class="form-submit form-animated order-advertisement d-none">
                            <button type="submit">
                                <span>TƏKLİF GÖNDƏR</span>
                                <div class="form-animated__over">
                                    <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                    <div class="order-bottom">
                        <div class="order-bottom__left">
                            <hr>
                            <div class="form-row coupon-form">
                                <div class="form-row--left form-element--middle">
                                    <label for="">Endirim Kodu</label>
                                    <input type="text" class="coupon-value" placeholder="XXXXXX">
                                </div>
                                <div class="form-row--right form-element--middle">
                                    <label for="">&nbsp;</label>
                                    <button type="submit" class="button-all coupon-button" data-type="1" value="ƏLAVƏ et">Əlavə et</button>
                                </div>
                            </div>
                        </div>
                        <div class="order-bottom__right">
                            <div class="order-all p-3 pt-2 pb-2" style="background-color: #252728;">
                                <div class="order-all__left" style="display: none;">
                                    <p><strong>10%</strong> ENDİRİM</p>
                                </div>
                                
                                <div class="order-all__right">
                                    <p style="color: #fff;font-size: 0.75rem;font-weight: 700;letter-spacing: 0.24px;margin-bottom: 0.8125rem;">Operator sizinlə əlaqə saxlayıb qiymət barədə məlumat verəcək və sifarişi dəqiqləşdirəcək
                                        
                                        
                                    </p>
                                    <div class="form-submit form-animated">
                                        <button type="submit" style="width: 208px; margin-left: auto">
                                            <span>Sifarişi Göndər</span>
                                            <div class="form-animated__over">
                                                <i class="fa fa-long-arrow-right"></i>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                
                
                
                
                
                
                
                

                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                

                
                
                
                
                
            </div>
            <div class="modal-close">
                <i class="fa fa-times"></i>
            </div>
        </div>
    </div>
</div>

<div class="modal-sure">
    <div class="modal-sure__body">
        <div class="modal-sure__content">
            <div class="modal-sure__close">
                <i class="fa fa-times"></i>
            </div>
            <p class="modal-sure__text">Çıxmaq istədiyinizə əminsinizmi?</p>
            <div class="modal-sure__buttons">
                <button class="modal-sure__cancel">Xeyr</button>
                <button class="modal-sure__submit" data-dismiss="modal">Bəli</button>
            </div>
        </div>
    </div>
</div>

<div id="mapModal" class="modal fade">
    <div class="modal-dialog modal-service__dialog">
        <div class="modal-content modal-service__content">
            <div class="modal-header modal-service__header">
                <h6>Ünvanı seçin</h6>
            </div>
            <div class="modal-body modal-service__body">
                <div id="mapBody" class="map-body"></div>
            </div>
            <div class="modal-close" data-dismiss="modal">
                <i class="fa fa-times"></i>
            </div>
        </div>
    </div>
</div>

<script>
    $( document ).on( 'click' , '[x-order-submit]' , function()
    {
        $.ajax( {
            type : 'POST' ,
            url : 'https://166.az/az/send-sms' ,
            data : {
                'phone' : $( "input.phone" ).val() ,
                'order' : $( "input.order_id" ).val() ,
                '_token' : csrf
            } ,
            success : function( res )
            {
                $( '[x-order-form]' ).hide();
                $( '.modal-service__header' ).hide();
                $( '.modal-close' ).hide();
                $( '#order-details' ).show();

                let orderManName = $( '.order-top__left input[name="name"]' ).val();
                let orderManPhone = $( '.order-top__left input[name="phone"]' ).val();

                let serviceIdArr = [];
                let inputs = [];

                $( '#order-forms .order-top' ).each( function()
                {
                    let dataId = $( this ).attr( 'data-id' );
                    let selectService = $( this ).find( '#step1 option:selected' ).text();
                    let selectServiceId = $( this ).find( '#step1 option:selected' ).val();
                    serviceIdArr.push( { dataId , selectService , selectServiceId } );
                    let addressArray = []
                    $( this ).find( '.form-row-select' ).each( function()
                    {
                        let allSelectName = $( this ).find( 'label' ).text();
                        let allSelectValue = $( this ).find( 'select option:selected' ).text();
                        inputs.push( {
                            type : 'select' ,
                            name : allSelectName ,
                            text : allSelectValue ,
                            id : selectServiceId
                        } );
                    } );
                    $( this ).find( '.form-row-input' ).each( function()
                    {
                        let allInputName = $( this ).find( 'label' ).text();
                        let allInputValue = $( this ).find( 'input' ).val();
                        inputs.push( {
                            type : 'input' ,
                            name : allInputName ,
                            text : allInputValue ,
                            id : selectServiceId
                        } );
                    } );
                    $( this ).find( '.form-row-number' ).each( function()
                    {
                        let allNumberName = $( this ).find( 'label' ).text();
                        let allNumberValue = $( this ).find( 'input' ).val();
                        inputs.push( {
                            type : 'number' ,
                            name : allNumberName ,
                            text : allNumberValue ,
                            id : selectServiceId
                        } );
                    } );
                    $( this ).find( '.form-row-map' ).each( function()
                    {
                        let allMapName = $( this ).find( 'label' ).text();
                        let allMapValue = $( this ).find( 'input' ).val();
                        if(allMapValue.length > 0) {
                            addressArray.push( { name : allMapName , value : allMapValue , id : selectServiceId } );
                        }

                        /*inputs.push({type: 'map',name: allMapName,text: allMapValue,id: selectServiceId});*/
                    } );
                    $( this ).find( '.form-row--date' ).each( function()
                    {
                        let allTimeName = $( this ).find( '.form-row-datetime' ).text();
                        let allTimeValue = $( this ).find( '.form-row-datetime input' ).val();
                        let allDayValue = $( this ).find( '.form-row-dateday input' ).val();
                        inputs.push( {
                            type : 'date' ,
                            name : allTimeName ,
                            text : allTimeValue ,
                            day : allDayValue ,
                            id : selectServiceId
                        } );
                    } );
                    setTimeout( function()
                    {
                        inputs.push( { type : 'map' , addressList : addressArray , id : selectServiceId } )
                    } , 100 );
                } );

                setTimeout( function()
                {
                    serviceIdArr.forEach( function( item )
                    {
                        let newButton =
                            `
                    <li id="${item.dataId}${item.selectService.replace( /\s/g , '' )}${item.selectServiceId}" class="filter-option__item">
                        <a href="#" class="filter-order__link">${item.selectService}</a>
                     </li>
                    `;
                        let newTab =
                            `
                    <div data-id="${item.selectServiceId}" class="order-details__content ${item.dataId}${item.selectService.replace( /\s/g , '' )}${item.selectServiceId}" style="width: 100%;display: none;">
                                <div class="order-details__content--item">
                                    <label>Sifarişçi məlumatları</label>
                                    <p>${orderManName},${orderManPhone}</p>
                                </div>
                    </div>
                    `;

                        $( '#filter-order__list' ).append( newButton );
                        $( '#order-details__tabs' ).append( newTab );

                    } );
                } , 100 );

                setTimeout( function()
                {
                    $( '#filter-order__list li' ).each( function()
                    {
                        let index = $( '#filter-order__list li' ).index( $( this ) );
                        if( index == 0 )
                        {
                            $( this ).addClass( 'active' );
                        }
                    } );
                    $( '#order-details__tabs .order-details__content' ).each( function()
                    {
                        let index = $( '#order-details__tabs .order-details__content' ).index( $( this ) );
                        if( index == 0 )
                        {
                            $( this ).css( 'display' , 'flex' );
                        }
                        ;
                    } );
                } , 200 );

                setTimeout( function()
                {
                    $( '#order-details__tabs .order-details__content' ).each( function()
                    {
                        let dataId = $( this ).attr( 'data-id' );
                        let $this = $( this );
                        $.each( inputs , function( item , index )
                        {
                            if( dataId === index.id && index.type === 'select' && index.text != '' )
                            {
                                let selectHtml =
                                    `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                $this.append( selectHtml );
                            } else if( dataId === index.id && index.type === 'input' && index.text != '' )
                            {
                                let inputHtml =
                                    `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                $this.append( inputHtml );
                            } else if( dataId === index.id && index.type === 'number' && index.text != '' )
                            {
                                let numberHtml =
                                    `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.text}</p>
                                    </div>
                                 `;
                                $this.append( numberHtml );
                            } else if( dataId === index.id && index.type === 'map' && index.addressList.length != 0 && index.addressList[ 0 ].value != '' )
                            {
                                let mapHtml =
                                    `
                                    <div class="order-details__content--item">
                                        <label>${index.addressList[ 0 ].name.split( " " )[ 0 ]}</label>
                                        ${index.addressList.map( item4 => (
                                        `<p>${index.addressList[ 0 ].name.split( " " )[ 0 ]} ${index.addressList.indexOf( item4 ) + 1}: ${item4.value}</p>`
                                    ) ).join( '' )}
                                    </div>
                                 `;
                                $this.append( mapHtml );
                            } else if( dataId === index.id && index.type === 'date' && index.text != '' )
                            {
                                let dateHtml =
                                    `
                                    <div class="order-details__content--item">
                                        <label>${index.name}</label>
                                        <p>${index.day} ${index.text}</p>
                                    </div>
                                 `;
                                $this.append( dateHtml );
                            }
                        } )
                    } );
                } , 300 );

                setTimeout(() => {
                    $("#newOrder .modal-content").addClass("modal-content__width");
                }, 300);
            }
        } );
    } );

    $( document ).on( 'click' , '.changeOrder, .filter-order__add' , function( e )
    {
        $( '[x-order-form]' ).show();
        $( '.modal-service__header' ).show();
        $( '.modal-close' ).show();
        $( '#order-details' ).hide();
        $( '#filter-order__list li' ).each( function()
        {
            $( this ).remove();
        } );
        $( '#order-details__tabs .order-details__content' ).each( function()
        {
            $( this ).remove();
        } );
        e.preventDefault();
    } );

    $( document ).on( 'click' , '#filter-order__list li' , function()
    {
        $( '#filter-order__list li' ).removeClass( 'active' );
        $( this ).addClass( 'active' );
        let id = $( this ).attr( 'id' );
        $( '#order-details__tabs .order-details__content' ).hide();
        $( '#order-details__tabs .' + id ).css( 'display' , 'flex' );
    } );

    $( 'body' ).on( 'click' , '.modal-sure__close , .modal-sure__cancel' , function()
    {
        $( '.modal-sure' ).fadeOut( 400 );
    } );

    $( 'body' ).on( 'click' , '.newOrder .modal-close' , function()
    {
        $( '.modal-sure' ).show();
        setTimeout( function()
        {
            $( '.modal-sure' ).css( {
                "opacity" : 1 ,
                "transform" : "scale3d(1,1,1)"
            } );
        } , 200 );
    } );

    $( 'body' ).on( 'click' , '#newOrder-callback .modal-close' , function()
    {
        $( '.modal-sure' ).hide();
        $( '.modal' ).modal( 'hide' );

        // setTimeout( function()
        // {
        //     $( '.modal-sure' ).css( {
        //         "opacity" : 1 ,
        //         "transform" : "scale3d(1,1,1)"
        //     } );
        // } , 200 );
    } );


    $( 'body' ).on( 'click' , '.modal-sure__submit' , function()
    {
        $( '.modal' ).modal( 'hide' );
        $( '.modal-sure' ).fadeOut( 400 );
    } );

    $( document ).click( function( e )
    {
        if( $( e.target ).is( '.modal' ) )
        {
            $( '.modal-sure' ).show();
            setTimeout( function()
            {
                $( '.modal-sure' ).css( {
                    "opacity" : 1 ,
                    "transform" : "scale3d(1,1,1)"
                } );
            } , 200 );
        }
    } );

    $( 'body' ).on( 'click' , '[data-target="#newOrder"]' , function()
    {
        if( phone_approved ) $( '[x-phone-approved]' ).hide();

        else $( '[x-phone-approved]' ).show();

        let homeServiceValue = $( '.select-service' ).find( 'option:selected' ).attr( 'value' );
        let homeServiceName = $( '.order input[name="name"]' ).val();
        let homeServicePhone = $( '.order input[name="phone"]' ).val();
        let changeService = homeServiceValue;
        $( '#step1 option' ).each( function()
        {
            var optVal = $( this ).val();
            if( optVal == changeService )
            {
                $( this ).prop( 'selected' , true );
                let $this = $( this ).parents( '.order-top' );
                /*addressList = [];*/
                /*post( changeService , $this );*/
                orderOut( 0 , changeService , $this );
            }
        } );

        $( '.order-top__left input[name="name"]' ).val( homeServiceName );
        $( '.order-top__left input[name="phone"]' ).val( homeServicePhone );
        $( '.order-top__left input[class="phoneMask phone2"]' ).val( homeServicePhone );
        $( '#newOrder' ).modal( {
            backdrop : 'static' ,
            keyboard : false
        } );

        setTimeout( function()
        {
            postCalc();
        } , 1000 );
    } );

    $( 'body' ).on( 'change' , '#step1' , function()
    {
        let own = $( this );
        /*let orderTopLength = $('.order-top').length;*/
        let orderTopId = $( this ).parents( '.order-top' ).attr( 'data-id' );
        if( orderTopId >= 1 )
        {

            let orderStepService = $( this ).find( 'option:selected' ).text();
            $( '.order-ready' ).each( function()
            {
                let orderTopId2 = $( this ).attr( 'data-id' );
                if( orderTopId2 == orderTopId )
                {
                    $( this ).find( '.order-ready__item span' ).text( orderStepService );
                    orderTopId = null;
                }
            } );
        }

        let changeService = $( this ).find( 'option:selected' ).attr( 'value' );
        let $this = $( this ).parents( '.order-top' );

        let selected_service_ids = [];
        $( 'div.order-forms select#step1 option:selected' ).each( function()
        {
            if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                selected_service_ids.push( $( this ).val() );
        } );

        $( "div.order-forms select#step1 option" ).show();
        selected_service_ids.map( selected_service_id =>
        {
            $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
        } );

        own.children( "option[value=" + changeService + "]" ).show();

        if( $( "div.order-forms" ).find( "input.coupons" ).length > 0 )
        {
            $( 'div.order-forms input.coupons' ).each( function()
            {
                let coupons = $( this ).attr( 'name' );

                let couponsArr = coupons.split("[");

                let serviceId = parseInt( couponsArr[ 1 ] );

                if( selected_service_ids.indexOf( serviceId + '' ) < 0 )
                {
                    $( this ).remove();
                }
            } );
        }
        /*addressList = [];*/
        /*post( changeService , $this );*/

        // setTimeout(function() {
        //     postCalc($this);
        // }, 1000);

        orderOut( 0 , changeService , $this );

        var dataChangeId = $( this ).parents( '.order-top' ).attr( 'data-id' );
        var dataText = $( this ).find( 'option:selected' ).text();
        $( '.order-ready__button' ).each( function()
        {
            if( $( this ).attr( 'data-id' ) === dataChangeId )
            {
                $( this ).find( '.order-ready__item span' ).text( dataText );
            }
        } );
    } );

    $( 'body' ).on( 'click' , '#order-new' , function()
    {
        let arr = [];
        $( '.order-top' ).each( function()
        {
            arr.push( $( this ) );
        } );


        let homeServiceValue2 = $( "div.order-top" ).last().find( "select#step1 option:selected" ).next().attr( 'value' );


        let selected_service_ids = [];
        $( 'div.order-forms select#step1 option:selected' ).each( function()
        {
            if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                selected_service_ids.push( $( this ).val() );

            if( selected_service_ids.indexOf( homeServiceValue2 ) < 0 )
            {
                selected_service_ids.push( homeServiceValue2 );
            } else
            {

                homeServiceValue2 = $( "div.order-forms select#step1 option[value=" + homeServiceValue2 + "]:not(:selected)" ).attr( 'value' );

            }
        } );


        /*$( "div.order-forms select#step1 option" ).show();*/
        $( "div.order-forms select#step1 option" ).each( function()
        {
            if( $( this ).prop( 'selected' ) === true )
            {
                $( this ).hide();
            } else
            {
                $( this ).show();
            }
        } );
        selected_service_ids.map( selected_service_id =>
        {
            $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
        } );

        $( "div.order-top" ).find( "select#step1 option[value=" + homeServiceValue2 + "]:selected" ).show();


        let orderLenght = arr.length + 1;

        
        
        
        
        
        

        let newOrder =
            `

            <div data-id=${orderLenght} class="order-top">
                            <div class="order-top__left step">

                                <h1></h1>
                                <p>
                                    <i class="fas fa-check-circle"></i>
                                    <span>Addım 1</span>
                                </p>
                                <div class="form-row">
                                    <label>Xidmət</label>
                                    <select id="step1" name="services[${orderLenght}][parent]">
                                                                <option value="1" `;
        if( selected_service_ids.indexOf( '1' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_1">Yükdaşıma</option>
                                                                            <option value="3" `;
        if( selected_service_ids.indexOf( '3' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_3">Xalça yuma</option>
                                                                            <option value="4" `;
        if( selected_service_ids.indexOf( '4' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_4">Təmizlik Xidməti</option>
                                                                            <option value="22" `;
        if( selected_service_ids.indexOf( '22' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_22">Evakuasiya</option>
                                                                            <option value="23" `;
        if( selected_service_ids.indexOf( '23' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_23">Anbar Xidməti</option>
                                                                            <option value="24" `;
        if( selected_service_ids.indexOf( '24' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_24">İşçi qüvvəsi xidməti</option>
                                                                            <option value="25" `;
        if( selected_service_ids.indexOf( '25' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_25">Usta xidməti</option>
                                                                            <option value="132" `;
        if( selected_service_ids.indexOf( '132' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_132">Sanitariya xidməti</option>
                                                                            <option value="133" `;
        if( selected_service_ids.indexOf( '133' ) >= 0 )
        {
            newOrder += 'style="display:none;"';
        }
        newOrder += ` class="service_133">Karqo xidməti</option>
                                                            </select>
        </div>
        <hr>

            </div>
            <div class="order-top__center step" id="step_2">
                <h1></h1>
                <p>
                    <i class="fas fa-check-circle"></i>
                    <span>Addım 2</span>
                                </p>
                                <div class="order-top__children"></div>
                                <div class="order-top__inputs">

                                </div>

            </div>
            <div class="order-top__right step step_3" id="step_3">
                <h1></h1>
                <p>
                    <i class="fas fa-check-circle"></i>
                    <span>Addım 3</span>
                                </p>
                                <div class="order-top__inputs">

                                </div>

            </div>
        </div>

`;


        $( '#order-forms' ).append( newOrder );

        let orderServiceText;

        setTimeout( function()
        {
            $( '.order-top' ).each( function()
            {
                var dataIdService = $( this ).attr( 'data-id' );

                if( dataIdService == orderLenght )
                {
                    orderServiceText = $( this ).find( '.order-top__left select[name="services[' + dataIdService + '][parent]"] option:selected' ).text();

                    return orderServiceText;
                }
            } );

            let newServiceDeleteButton =
                `
                <div data-id=${orderLenght} class="order-ready__button d-flex mb-3">
                        <button type="button" class="order-ready__item" data-toggle="modal" data-target="#newOrder">
                            <span>${orderServiceText}</span>
                        </button>
                        <button type="button" class="order-trash">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                </div>
            `;

            $( '#order-ready' ).append( newServiceDeleteButton );
        } , 1550 );

        let homeServiceValue = $( '.select-service' ).find( 'option:selected' ).attr( 'value' );
        let $this = $( "div.order-top" ).last();

        setTimeout( function()
        {
            orderOut( 0 , homeServiceValue2 , $this );
            /*post( homeServiceValue2 , $this );*/
        } , 100 );

        setTimeout( function()
        {
            $( "div.order-forms select#step1 option" ).show();
            selected_service_ids.map( selected_service_id =>
            {
                $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
            } );
        } , 1500 );

        let step1Count = $this.find( '#step1 option' ).length - 1;
        let step1NoneCount = [];

        setTimeout( function()
        {
            $this.find( '#step1 option' ).each( function()
            {
                if( $( this ).css( 'display' ) === 'none' )
                {
                    step1NoneCount.push( $( this ) );
                }
            } );

            if( step1Count === step1NoneCount.length )
            {
                $( '#order-new' ).hide();
            }
        } , 1500 );


    } );

    $( 'body' ).on( 'click' , '.order-trash' , function()
    {
        let dataId = $( this ).parent().attr( 'data-id' );
        $( '.order-top' ).each( function()
        {
            let dataId2 = $( this ).attr( 'data-id' );
            if( dataId2 == dataId )
            {
                $( this ).remove();
            }
        } );


        $( this ).parent().remove();

        postCalc();

        let selected_service_ids = [];
        $( 'div.order-forms select#step1 option:selected' ).each( function()
        {
            if( selected_service_ids.indexOf( $( this ).val() ) < 0 )
                selected_service_ids.push( $( this ).val() );
        } );

        $( "div.order-forms select#step1 option" ).show();
        selected_service_ids.map( selected_service_id =>
        {
            $( "div.order-forms select#step1 option[value=" + selected_service_id + "]:not(:selected)" ).hide();
        } );


        let $this = $( '.order-top' ).last();
        let step1Count = $this.find( '#step1 option' ).length - 1;
        let step1NoneCount = [];

        setTimeout( function()
        {

            $this.find( '#step1 option' ).each( function()
            {
                if( $( this ).css( 'display' ) === 'none' )
                {
                    step1NoneCount.push( $( this ) );
                }
            } );

            if( step1Count != step1NoneCount.length )
            {
                $( '#order-new' ).show();
            }
        } , 1500 );

        const index = parseInt( dataId ) - 1;
        addressList.splice( index , 1 );


    } );


    $( 'body' ).on( 'change' , '.order-children' , function()
    {
        let changeService = $( this ).find( 'option:selected' ).attr( 'value' );
        let $this = $( this ).parents( '.order-top' );
        let m_id = $( $this ).attr( "data-id" );
        let index = parseInt( m_id ) - 1;
        $.ajax( {
            type : 'POST' ,
            url : 'https://166.az/az/service-inputs' ,
            data : {
                service : changeService ,
                '_token' : csrf
            } ,
            success : function( res )
            {
                $( $this ).find( '.order-top__children-inputs' ).html( '' );
                let childrenArr = res.data;

                for( let ch = 0; ch < childrenArr.length; ch++ )
                {
                    let appendArea = $( $this ).find( '#step_' + childrenArr[ ch ].step + ' .order-top__children-inputs' );
                    if( childrenArr[ ch ].type === 'input' )
                    {
                        let htmlInput =
                            `
                            <div class="form-row form-row-input">
                                        <label>${childrenArr[ ch ].name}</label>
                                        <input type="text" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="${childrenArr[ ch ].id}">
                            </div>
                            `;
                        appendArea.append( htmlInput );
                    } else if( childrenArr[ ch ].type === 'number' )
                    {
                        let htmlNumber =
                            `
                              <div class="form-row--number form-element--short form-row-number">
                                     <label>${childrenArr[ ch ].name}</label>
                                        <div class="regulator">
                                             <div class="regulator-minus"><span>-</span></div>
                                                <input class="regulator-output" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" type="text" value="0">
                                             <div class="regulator-plus"><span>+</span></div>
                                        </div>
                              </div>
                            `;
                        appendArea.append( htmlNumber );
                    } else if( childrenArr[ ch ].type === 'date' )
                    {
                        let random = ~~( Math.random() * 100 );
                        let random2 = ~~( Math.random() * 100 );
                        let htmlDate =
                            `
                                        <div class="form-row form-row--date">
                                        <div class="form-row--left form-element--short form-row-datetime">
                                            <label for="hour">${childrenArr[ ch ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-clock" aria-hidden="true"></i></div>
                                                <input class="datetime-container datetimepicker-input" placeholder="13:30" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="datetimepicker1${random}" data-target="#datetimepicker1${random}" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-row--right form-element--long form-row-dateday">
                                            <label for="date" style="visibility: hidden;">${childrenArr[ ch ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-calendar-alt"></i></div>
                                                <input class="datetime-container datetimepicker-input" name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]" id="datetimepicker1${random2}" data-target="#datetimepicker1${random2}" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>

                          `;
                        appendArea.append( htmlDate );
                        $( `#datetimepicker1${random}` ).datetimepicker( {
                            format : 'LT' , //L
                            locale : 'az'
                        } );

                        $( ".datetime-text" ).text( moment().format( 'D MMMM YYYY' ) );
                        $( `#datetime-text${random}` ).val( moment().format( 'D MMMM YYYY' ) );

                        $( `#datetimepicker1${random2}` ).datetimepicker( {
                            format : 'L' , //L
                            locale : 'az'
                        } );
                        let d = new Date();
                        let hour = realHour();
                        let minute = realMinut();
                        let day = realDay();
                        let year = d.getFullYear();
                        let month = realMonth();

                        function realHour()
                        {
                            let rhour = d.getHours();

                            if( rhour < 10 )
                            {
                                rhour = `0${d.getHours()}`
                            } else
                            {
                                rhour = d.getHours();
                            }

                            return rhour;
                        }

                        function realMinut()
                        {
                            let rminute = d.getMinutes();

                            if( rminute < 10 )
                            {
                                rminute = `0${d.getMinutes()}`
                            } else
                            {
                                rminute = d.getMinutes();
                            }

                            return rminute;
                        }

                        function realDay()
                        {
                            let rday = d.getDate();

                            if( rday < 10 )
                            {
                                rday = `0${d.getDate()}`
                            } else
                            {
                                rday = d.getDate();
                            }

                            return rday;
                        }

                        function realMonth()
                        {
                            let rmonth = d.getMonth() + 1;

                            if( rmonth < 10 )
                            {
                                rmonth = `0${d.getMonth() + 1}`
                            } else
                            {
                                rmonth = d.getMonth()
                            }

                            return rmonth;
                        }

                        $( `#datetimepicker1${random}` ).val( `${hour}:${minute}` );
                        $( `#datetimepicker1${random2}` ).val( `${day}.${month}.${year}` );
                    } else if( childrenArr[ ch ].type === 'select' )
                    {
                        let htmlSelect =
                            `
                             <div class="form-row form-row-select">
                                  <label>${childrenArr[ ch ].name}</label>
                                  <select name="services[${m_id}][service[[${changeService}][${childrenArr[ ch ].id}]]]">
                                        ${
                                childrenArr[ ch ].options.map( item => (
                                    `<option value="${item.id}">${item.name}</option>`
                                ) ).join( '' )

                            }

                                  </select>
                            </div>
                        `;
                        appendArea.append( htmlSelect );
                    }
                }
            }
        } );
    } );

    var addressList = [];
    var equalId = '';

    function post( changeService , $this )
    {

        let m_id = $( $this ).attr( "data-id" );

        let index = parseInt( m_id ) - 1;


        if( addressList[ index ] )
        {
            addressList[ index ].complete = [];
            addressList[ index ].core = null;
            addressList[ index ].directionsService = null;
            addressList[ index ].directionsDisplay = null;
            addressList[ index ].marker = null;
            addressList[ index ].geometry = [];
            addressList[ index ].input = []
        }


        $.ajax( {
            type : 'POST' ,
            url : 'https://166.az/az/service-inputs' ,
            data : {
                service : changeService ,
                '_token' : csrf
            } ,
            success : function( res )
            {
                $( $this ).find( '.order-top__inputs' ).html( '' );
                $( $this ).find( '.order-top__children' ).html( '' );
                $( $this ).find( '.order-top__children-inputs' ).html( '' );
                let arr = res.data;
                let childrenArr = res.children;
                let arrLength = childrenArr.length;
                if( arrLength > 0 )
                {

                    let childrenSelect =
                        `
                             <div class="form-row form-row-select">
                                  <label>Xidmətin növü</label>
                                  <select class="order-children" name="services[${m_id}][children]">
                                        ${
                            childrenArr.map( item => (
                                `<option value="${item.id}">${item.name}</option>`
                            ) ).join( '' )

                        }

                                  </select>
                            </div>
                        `;

                    $( $this ).find( '#step_2 .order-top__children' ).append( childrenSelect );
                }


                let addressFound = false;

                let isTrue = arr.some((item) => item.step === "3");
                if(isTrue) {
                    $($this).find(".step_3").removeClass("d-none");
                } else {
                    $($this).find(".step_3").addClass("d-none");
                }
                for( let input = 0; input < arr.length; input++ )
                {

                    let appendArea = $( $this ).find( '#step_' + arr[ input ].step + ' .order-top__inputs' );
                    if( arr[ input ].type === 'select' )
                    {
                        let htmlSelect =
                            `
                             <div class="form-row form-row-select">
                                  <label>${arr[ input ].name}</label>
                                  <select name="services[${m_id}][${arr[ input ].id}]">
                                        ${
                                arr[ input ].options.map( item => (
                                    `<option value="${item.id}">${item.name}</option>`
                                ) ).join( '' )

                            }

                                  </select>
                            </div>
                        `;
                        appendArea.append( htmlSelect );
                    } else if( arr[ input ].type === 'input' )
                    {
                        let htmlInput =
                            `
                            <div class="form-row form-row-input">
                                        <label>${arr[ input ].name}</label>
                                        <input type="text" name="services[${m_id}][${arr[ input ].id}]" id="${arr[ input ].id}">
                            </div>
                            `;
                        appendArea.append( htmlInput );

                    } else if( arr[ input ].type === 'number' )
                    {
                        let htmlNumber =
                            `

                              <div class="form-row--number form-element--short form-row-number">
                                     <label>${arr[ input ].name}</label>
                                        <div class="regulator">
                                             <div class="regulator-minus"><span>-</span></div>
                                                <input class="regulator-output" name="services[${m_id}][${arr[ input ].id}]" type="text" value="0">
                                             <div class="regulator-plus"><span>+</span></div>
                                        </div>
                              </div>
                            `;
                        appendArea.append( htmlNumber );
                    } else if( arr[ input ].type === 'date' )
                    {

                        let random = ~~( Math.random() * 100 );
                        let random2 = ~~( Math.random() * 100 );


                        let htmlDate =
                            `
                         <div class="form-row form-row--date">
                                        <div class="form-row--left form-element--short form-row-datetime">
                                            <label for="hour">${arr[ input ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-clock" aria-hidden="true"></i></div>
                                                <input class="datetime-container datetimepicker-input" placeholder="13:30" name="services[${m_id}][${arr[ input ].id}]" id="datetimepicker1${m_id}${arr[ input ].id}1" data-target="#datetimepicker1${m_id}${arr[ input ].id}1" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                        <div class="form-row--right form-element--long form-row-dateday">
                                            <label for="date" style="visibility: hidden;">${arr[ input ].name}</label>
                                            <div class="select-row">
                                                <div class="select-icon"><i class="far fa-calendar-alt"></i></div>
                                                <input class="datetime-container datetimepicker-input" name="services[${m_id}][${arr[ input ].id}]" id="datetimepicker1${m_id}${arr[ input ].id}2" data-target="#datetimepicker1${m_id}${arr[ input ].id}2" data-toggle="datetimepicker" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>

                          `;
                        appendArea.append( htmlDate );



                        $( `#datetimepicker1${m_id}${arr[ input ].id}1` ).datetimepicker( {
                            format : 'LT' , //L
                            locale : 'az'
                        } );

                        $( ".datetime-text" ).text( moment().format( 'D MMMM YYYY' ) );
                        // $( `#datetime-text[${m_id}][${arr[ input ].id}]1` ).val( moment().format( 'D MMMM YYYY' ) );

                        $( `#datetimepicker1${m_id}${arr[ input ].id}2` ).datetimepicker( {
                            format : 'L' , //L
                            locale : 'az'
                        } );
                        /*$(".datetime-text").text(moment().format('D MMMM YYYY'));*/
                        // $(`#datetime-text${random2}`).val(moment().format('D MMMM YYYY'));

                        let d = new Date();
                        let hour = realHour();
                        let minute = realMinut();
                        let day = realDay();
                        let year = d.getFullYear();
                        let month = realMonth();

                        function realHour()
                        {
                            let rhour = d.getHours();

                            if( rhour < 10 )
                            {
                                rhour = `0${d.getHours()}`
                            } else
                            {
                                rhour = d.getHours();
                            }

                            return rhour;
                        }

                        function realMinut()
                        {
                            let rminute = d.getMinutes();

                            if( rminute < 10 )
                            {
                                rminute = `0${d.getMinutes()}`
                            } else
                            {
                                rminute = d.getMinutes();
                            }

                            return rminute;
                        }

                        function realDay()
                        {
                            let rday = d.getDate();

                            if( rday < 10 )
                            {
                                rday = `0${d.getDate()}`
                            } else
                            {
                                rday = d.getDate();
                            }

                            return rday;
                        }

                        function realMonth()
                        {
                            let rmonth = d.getMonth() + 1;

                            if( rmonth < 10 )
                            {
                                rmonth = `0${d.getMonth() + 1}`
                            } else
                            {
                                rmonth = d.getMonth()
                            }

                            return rmonth;
                        }

                        $( `#datetimepicker1${m_id}${arr[ input ].id}1` ).val( `${hour}:${minute}` );
                        $( `#datetimepicker1${m_id}${arr[ input ].id}2` ).val( `${day}.${month}.${year}` );



                    } else if( arr[ input ].type === 'address' )
                    {
                        let htmlAddress =
                            `
                            <div class="form-row form-row-map ">
                                   <label>${arr[ input ].name}</label>
                                   <input type="text" class="order-address" name="services[${m_id}][${arr[ input ].id}]" id="${m_id}address${arr[ input ].id}" name="${arr[ input ].name}">
                            </div>
                            `;
                        appendArea.append( htmlAddress );
                        if( !addressList[ index ] )
                        {

                            addressList.push( {
                                input : [ m_id + "address" + arr[ input ].id ] ,
                                complete : [ null ] ,
                                geometry : [ {
                                    text : '' ,
                                    lat : null ,
                                    lng : null
                                } ] ,
                                directionsService : null ,
                                directionsDisplay : null ,
                                marker : null ,
                                core : null
                            } );
                        } else
                        {


                            addressList[ index ].input.push( m_id + "address" + arr[ input ].id );
                            addressList[ index ].complete.push( null );
                            addressList[ index ].geometry.push( {
                                text : '' ,
                                lat : null ,
                                lng : null
                            } );
                        }
                        addressFound = true;

                    }
                }
                $( $this ).find( ".address-info" ).remove();
                $( $this ).append( '<input type="hidden" name="services[' + m_id + '][addressInfo]" class="address-info">' );
                if( addressFound )
                {
                    $( $this ).append( '<div class="w-100"><div id="map' + m_id + '" class="googleMap"></div></div>' );

                }

                setTimeout( function()
                {

                    if( addressList[ index ] )
                    {
                        addressList[ index ].input.map( function( m , i )
                        {
                            let input = document.getElementById( m );
                            google.maps.event.addDomListener( input , 'keydown' , function( event )
                            {
                                if( event.keyCode === 13 )
                                {
                                    event.preventDefault();
                                }
                            } );
                            addressList[ index ].complete[ i ] = new google.maps.places.Autocomplete( ( input ) , { types : [  "geocode" ] } );
                            addressList[ index ].complete[ i ].addListener( 'place_changed' , function()
                            {

                                let place = addressList[ index ].complete[ i ].getPlace();
                                addressList[ index ].geometry[ i ].text = place.formatted_address;
                                if( place.geometry.location )
                                {
                                    addressList[ index ].geometry[ i ].lat = place.geometry.location.lat();
                                    addressList[ index ].geometry[ i ].lng = place.geometry.location.lng();
                                }
                                let found = 0;
                                addressList[ index ].geometry.map( geo =>
                                {
                                    if( geo.text !== '' ) found++;
                                } );
                                if( found > 0 )
                                {
                                    $( $this ).find( "#map" + m_id ).show();
                                }
                                if( found === 1 )
                                {

                                    if( addressList[ index ].core !== null )
                                    {

                                        setMarker( addressList[ index ] , true );

                                    } else
                                    {
                                        initMap( "map" + m_id , addressList[ index ] )
                                    }
                                } else if( found > 1 )
                                {
                                    setMarker( addressList[ index ] , false );
                                    setDirection( addressList[ index ] , $this );
                                } else
                                {
                                    $( $this ).find( "#map" + m_id ).show();
                                }
                            } );
                        } );
                    } else
                    {
                        addressList.push( {
                            input : [ m_id + "address" + "Empty" ] ,
                            complete : [ null ] ,
                            geometry : [ {
                                text : '' ,
                                lat : null ,
                                lng : null
                            } ] ,
                            directionsService : null ,
                            directionsDisplay : null ,
                            marker : null ,
                            core : null
                        } );
                    }


                } , 100 );


                if( changeService == 1 )
                {
                    addOneMap( $this );
                }
            }
        } )
    }

    function initMap( mapId , addressList )
    {


        const index = addressList.geometry.findIndex(l => l.lat !== null)
        addressList.directionsDisplay = new google.maps.DirectionsRenderer( {} );
        addressList.directionsService = new google.maps.DirectionsService;
        addressList.core = new google.maps.Map( document.getElementById( mapId ) , {
            zoom : 16 ,
            fullscreenControl : true ,
            fullscreenControlOptions : {
                position : google.maps.ControlPosition.BOTTOM_RIGHT
            } ,
            mapTypeControl : false ,
            streetViewControl : false ,
            center : {
                lat :  parseFloat( addressList.geometry[ index ].lat ) ,
                lng :  parseFloat( addressList.geometry[ index ].lng )
            }
        } );
        addressList.marker = new google.maps.Marker( {
            position : {
                lat :  parseFloat( addressList.geometry[ index ].lat )  ,
                lng :  parseFloat( addressList.geometry[ index ].lng )
            } ,
            map : addressList.core
        } );

        addressList.directionsDisplay.setMap( addressList.core );
    }

    function setMarker( addressList , action )
    {

        if( action )
        {
            if( addressList.marker !== null )
            {
                addressList.marker.setMap( null );
            }
            addressList.marker = new google.maps.Marker( {
                position : {
                    lat : parseFloat( addressList.geometry[ 0 ].lat ) ,
                    lng : parseFloat( addressList.geometry[ 0 ].lng )
                } ,
                map : addressList.core
            } );
            addressList.core.setCenter( new google.maps.LatLng( parseFloat( addressList.geometry[ 0 ].lat ) , parseFloat( addressList.geometry[ 0 ].lng ) ) );
        } else
        {
            addressList.marker.setMap( null );

        }
        addressList.directionsDisplay.setMap( addressList.core );
    }

    function setDirection( addressList , $this = null )
    {

        let geometry_data = addressList.geometry;
        let geometry = [];
        geometry_data.map( lm =>
        {
            if( lm.text !== '' )
            {
                geometry.push( lm );
            }
        } );
        let waypts = [];
        geometry.map( ( m , i ) =>
        {
            if( geometry.length !== ( i + 1 ) && i !== 0 )
            {
                waypts.push( {
                    location : m.text ,
                    stopover : true
                } );
            }
        } );
        addressList.directionsService.route( {
            origin : { lat : parseFloat( geometry[ 0 ].lat ) , lng : parseFloat( geometry[ 0 ].lng ) } ,
            waypoints : waypts ,
            destination : {
                lat : parseFloat( geometry[ geometry.length - 1 ].lat ) ,
                lng : parseFloat( geometry[ geometry.length - 1 ].lng )
            } ,
            travelMode : google.maps.TravelMode[ 'DRIVING' ]
        } , ( response , status ) =>
        {
            if( status === 'OK' )
            {
                addressList.directionsDisplay.setDirections( response );
                postCalc( $this , response );
            } else
            {
                alert( "something went wrong" )
            }
        } );
    }

    $( 'body' ).on( 'change' , 'select,input' , function( event )
    {
        if( $( this ).hasClass( 'order-address' ) )
        {
            event.preventDefault();
        } else
        {
            postCalc( $( this ) );
        }
    } );

    $( 'body' ).on( 'mouseup' , 'div.regulator-plus,div.regulator-minus' , function()
    {
        let thisVar = $( this );
        setTimeout( function()
        {
            postCalc( thisVar );
        } , 100 );
    } );

    function postCalc( $this = null , addressList = null )
    {


        if( addressList != null )
        {
            let distance = Math.round( addressList[ 'routes' ][ 0 ][ 'legs' ][ 0 ][ 'distance' ][ 'value' ] / 1000 * 10 ) / 10; // with km
            let duration = Math.round( addressList[ 'routes' ][ 0 ][ 'legs' ][ 0 ][ 'duration' ][ 'value' ] / 60 ); // with hour

            /*$( $this ).find( ".address-info" ).remove();*/
            $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val( distance + "-" + duration );
            /*let arr = [$( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val()];*/
            /*var name = $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).attr('name');
            form.push( {
                name : name ,
                value : $( $this ).closest( 'div.order-top' ).find( 'input.address-info' ).val()
            } );*/

        }
        let form = $( 'div.modal-service__body form.order-form' ).serializeArray();
        form.push( { name : '_token' , value : csrf } );

        $.ajax( {
            method : "POST" ,
            url : 'https://166.az/az/calculate' ,
            data : form ,
            success : function( res )
            {
                let data = JSON.parse( JSON.stringify( res ) );
                let total = data.total;

                total = Math.round(total * 100) / 100;

                if (data.servicesInfo) {
                    if (Object.keys(data.servicesInfo).length > 0) {
                        var servicesInfoLength = Object.keys(data.servicesInfo).length;

                        // $( "div.order-all__center" ).html( "" );
                        //
                        // for( var i = 1; i <= servicesInfoLength; i++ )
                        // {
                        //     if( typeof data.servicesInfo[ i ] !== 'undefined' )
                        //     {
                        //         $( "div.order-all__center" ).append( "<p class='selected-service-" + i + "'><span x-order-selected-service>" + data.servicesInfo[ i ].name + "</span>:<strong><span x-order-selected-service-price>" + data.servicesInfo[ i ].total + "</span> AZN</strong></p>" );
                        //
                        //         // $('div.order-forms').find('input.services_id').remove();
                        //     }
                        // }
                    }
                }

                // $("div.coupon-form").first().attr("data-service-id",$("div.order-top").first().find("select#step1 option:selected").val());

                // $( '[x-order-final-price]' ).html( total );
                $("div.order-top").last().find("input.order_id").remove();
                $("div.order-top").last().append("<input class='order_id' type='hidden' name='order_id' value=" + data.order_id + ">");
            }
        });


        let selected_service_ids = [];
        $('div.order-forms select#step1 option:selected').each(function () {
            if (selected_service_ids.indexOf($(this).val()) < 0)
                selected_service_ids.push( $( this ).val() );
        } );

        let coupon_service_ids = [];
        $( 'div.coupon-form' ).each( function()
        {
            if( $( this ).attr( "data-service-id" ) != undefined && coupon_service_ids.indexOf( $( this ).attr( "data-service-id" ) ) < 0 )
            {
                coupon_service_ids.push( $( this ).attr( "data-service-id" ) );
            }
        } );

        function arr_diff( a1 , a2 )
        {

            var a = [] , diff = [];

            for( var i = 0; i < a1.length; i++ )
            {
                a[ a1[ i ] ] = true;
            }

            for( var i = 0; i < a2.length; i++ )
            {
                if( a[ a2[ i ] ] )
                {
                    delete a[ a2[ i ] ];
                } else
                {
                    a[ a2[ i ] ] = true;
                }
            }

            for( var k in a )
            {
                diff.push( k );
            }

            return diff;
        }

        let diff = arr_diff( selected_service_ids , coupon_service_ids );

        diff.map( dif =>
        {
            $( 'div[data-service-id="' + dif + '"]' ).remove();
        } );

        let services_id = [];

        $( 'div.order-forms select#step1 option:selected' ).each( function()
        {
            let selected = $( this ).val();
            if( services_id.indexOf( selected ) < 0 )
            {
                services_id.push( selected );
            }
        } );

        $( 'div.order-forms div.services_ids' ).html( '' );
        services_id.map( service_id =>
        {
            $( 'div.order-forms div.services_ids' ).append( "<input class='services_id' type='hidden' name='services_id[]' value='" + service_id + "'>" );
        } );
    }


    $( 'div.main-header__left div.form-row input' ).keyup( function()
    {

        $( 'div.main-header__left div.form-row input' ).on( 'keyup' , function()
        {
            let empty = false;

            $( 'div.main-header__left div.form-row input' ).each( function()
            {
                empty = $( this ).val().length == 0;
            } );

            if( empty )
                $( 'div.main-header__left .form-submit button' ).attr( 'disabled' , 'disabled' );
            else
                $( 'div.main-header__left .form-submit button' ).attr( 'disabled' , false );
        } );
    } );

    $( 'div.main-header__left .form-submit' ).click( function()
    {
        $( 'div.main-header__left div.form-row input' ).each( function()
        {
            if( $( this ).val().trim() == '' )
                $( this ).css( 'border' , '1px solid red' );
            else
                $( this ).css( 'border-color' , '' );
        } );
    } );


    $( '.btn-submit' ).click( () =>
    {
        $( '.btn-modal-call-desc-input input' ).each( function()
        {
            if( $( this ).val().trim() == '' ){
                console.log('bosdur');
                $( this ).css( 'border' , '1px solid red' );
            }
            else
                $( this ).css( 'border-color' , '' );
        } );
    } );

    // mobile-service__content




    $( 'body' ).on( 'click' , 'button.coupon-button' , function()
    {
        let coupon_input = $( this ).closest( 'div.coupon-form' ).find( "input.coupon-value" );
        let phone = $( "input.phone" ).val();

        let services_id = $( 'input.services_id' ).map( function()
        {
            return this.value;
        } ).get();

        let coupon_form = $( this ).closest( 'div.coupon-form' );
        coupon_form.find( "input.coupon-value" ).css( "border" , "0" );

        let order_id = $( "input.order_id" ).val();

        let type = 1;
        if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 1 )
            type = 1;
        else if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 2 )
            type = 2;

        $.ajax( {
            type : 'POST' ,
            url : 'https://166.az/az/check_coupon' ,
            data : {
                'coupon' : coupon_input.val() ,
                'phone' : phone ,
                'services_id[]' : services_id ,
                'order_id' : order_id ,
                'type' : type ,
                '_token' : csrf
            } ,
            success : function( res )
            {
                let data = JSON.parse( JSON.stringify( res ) );

                if( data.service_id > 0 )
                {

                    let name = 'coupons';
                    let value = data.coupon_id;
                    if( data.campaign_id > 0 )
                    {
                        name = 'campaigns';
                        value = data.campaign_id;
                    }

                    if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 1 )
                    {

                        $( "div.order-forms" ).append( "<input class='coupons' type='hidden' name='" + name + "[" + data.service_id + "][]' value='" + value + "'>" );

                        $( "div.order-bottom__left" ).prepend( '<hr>\n' +
                            '                            <div class="form-row coupon-form" data-service-id=' + data.service_id + '>\n' +
                            '                                <div class="form-row--left form-element--middle">\n' +
                            '                                    <label for="">Endirim Kodu</label>\n' +
                            '                                    <input readonly type="text" style="border: 1px solid green;"  class="coupon-value" value="' + data.coupon_val + '" placeholder="XXXXXX">\n' +
                            '                                </div>\n' +
                            '                                <div class="form-row--right form-element--middle">\n' +
                            '                                    <label for="">&nbsp;</label>\n' +
                            '                                    <button type="button" data-type=2 class="button-all coupon-button" value="Sil" data-type=1>Sil</button>\n' +
                            '                                </div>\n' +
                            '                             <div class=\'alert alert-success\'>Uğurlu</div></div>' );

                        $( "div.order-all__left" ).show();
                        $( "div.order-all__left p strong" ).html( data.discount + " %" );
                    } else if( coupon_form.find( 'button.coupon-button' ).attr( 'data-type' ) == 2 )
                    {
                        $( "div.order-forms" ).find( "input[name='" + name + "[" + data.service_id + "][]'][value='" + value + "']" ).remove();
                        coupon_form.remove();
                    }

                    postCalc();
                } else
                {
                    coupon_form.find( "input.coupon-value" ).css( "border" , "1px solid red" );
                }

                coupon_input.val( '' );
            }
        } );
    } );


    $( 'body' ).on( 'click' , '.orderOut-callback' , function()
    {
        let serviceId = $( this ).attr( "data-id" );
        let phone = $( this ).attr( "data-phone" );
        let phone_two = $( this ).attr( "data-phone-two" );
        let serviceEmail = $( this ).attr( "data-email" );
        let serviceParentId = $( this ).attr( "data-parent-id" );

        console.log('test');
        // First number
        $('#codioServicePhoneShow').html(phone);
        $('#codioServicePhoneShowHref').attr( 'href' ,`tel:${phone}`);

        // Second number
        $('#codioServicePhoneTwoShow').html(phone_two);
        $('#codioServicePhoneTwoShowHref').attr( 'href' ,`tel:${phone_two}`);


        // console.log(serviceId);
        // document.getElementById("serviceIdCodio").value = serviceId;
        $('#serviceIdCodio').val(serviceId);
        $('#serviceEmail').val(serviceEmail);

        // console.log(serviceId);
        // console.log($('#serviceIdCodio').val())
        let campaign_id = 1;
        if( $( this ).attr( 'data-campaign-id' ) > 0 )
            campaign_id = $( this ).attr( "data-campaign-id" );

        let type = 0;
        if( $( this ).attr( 'data-type' ) != '' )
            type = $( this ).attr( "data-type" );

        let $this = $( "div.order-top" ).first();

        orderOutCallback( serviceId , serviceParentId , $this , campaign_id , type );
        // $( '#newOrder-callback .form-row input' ).css( 'border' , '1px solid red' );
        $( '#newOrder-callback #step_2 , #newOrder-callback #step_3' ).css( {
            'opacity' : '0.6' ,
            'pointer-events' : 'none'
        } );
    } );


    $( 'body' ).on( 'click' , '.orderOut' , function()
    {
        let serviceId = $( this ).attr( "data-id" );
        let serviceParentId = $( this ).attr( "data-parent-id" );

        let campaign_id = 1;
        if( $( this ).attr( 'data-campaign-id' ) > 0 )
            campaign_id = $( this ).attr( "data-campaign-id" );

        let type = 0;
        if( $( this ).attr( 'data-type' ) != '' )
            type = $( this ).attr( "data-type" );

        let $this = $( "div.order-top" ).first();

        orderOut( serviceId , serviceParentId , $this , campaign_id , type );
        $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
        $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
            'opacity' : '0.6' ,
            'pointer-events' : 'none'
        } );
    } );

    $( document ).on( 'change' , '#newOrder .order-top__left input' , function()
    {
        let inputOne = $( '#newOrder .order-top__left input[name="name"]' ).val();
        let inputTwo = $( '#newOrder .order-top__left input[name="phone"]' ).val();
        if( inputOne != '' && inputTwo != '' )
        {
            $( '#newOrder #step_2 , #newOrder #step_3' ).removeAttr( 'style' );
            $( '#newOrder .order-top__left input' ).css( 'border' , 'none' );
        } else
        {
            $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
                'opacity' : '0.6' ,
                'pointer-events' : 'none'
            } );
            $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
        }
    } );

    $( document ).on( 'keyup' , '#newOrder .order-top__left input' , function()
    {
        let inputOne = $( '#newOrder .order-top__left input[name="name"]' ).val();
        let inputTwo = $( '#newOrder .order-top__left input[name="phone"]' ).val();
        if( inputOne != '' && inputTwo != '' )
        {
            $( '#newOrder #step_2 , #newOrder #step_3' ).removeAttr( 'style' );
            $( '#newOrder .order-top__left input' ).css( 'border' , 'none' );
        } else
        {
            $( '#newOrder #step_2 , #newOrder #step_3' ).css( {
                'opacity' : '0.6' ,
                'pointer-events' : 'none'
            } );
            $( '#newOrder .order-top__left input' ).css( 'border' , '1px solid red' );
        }
    } );

    $( 'body' ).on( 'change' , '.campaign-select' , function()
    {
        let campaignId = $( this ).val();
        let serviceParentId = 4;

        let $this = $( this ).parents( "div.order-top" );

        orderOut( 0 , serviceParentId , $this , campaignId );
    } );

    $( 'body' ).on( 'change' , 'select.order-children' , function()
    {
        let campaignId = $( this ).val();

        if( campaignId == 1000 || campaignId == 2000 )
        {
            let serviceParentId = 4;

            let $this = $( this ).parents( "div.order-top" );

            setTimeout( function()
            {
                orderOut( 0 , serviceParentId , $this , campaignId );
            }, 1000);
        } else {
            $("div.packages-select-div").remove();
        }

    });

    function orderOutCallback(service_id = 0, service_parent_id = 0, $this, campaign_id = 0, type = 0) {
        // $( '[x-order-final-price]' ).html( 0 );
        $('[x-order-selected-service-price]').html(0);

        $('#newOrder-callback').modal({
            backdrop: 'static',
            keyboard: false
        });


        $($this).find("#step_2 div.avtopark-select-div").remove();

        if( service_parent_id == 1 )
        {
            $.ajax( {
                type : 'GET' ,
                url : 'https://166.az/az/avtopark' ,
                success : function( res )
                {
                    var htmlSelect = '<div class="form-row avtopark-select-div form-row-select"><label>Yük maşını</label><select class="avtopark-select" name="services[' + $( $this ).attr( 'data-id' ) + '][avtopark]">';
                    let data = JSON.parse( JSON.stringify( res ) );
                    data = data.data;
                    data.map( value =>
                    {
                        if( value.id == service_id && type == 'avtopark' )
                            var selected = 'selected';
                        else
                            var selected = '';

                        htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                    } );

                    htmlSelect += '</select></div>';

                    $( $this ).find( "#step_2" ).append( htmlSelect );
                }
            } );
        } else if( service_parent_id == 4 )
        {


            
            
            
            

            $.ajax( {
                type : 'GET' ,
                data : {
                    'campaign_id' : campaign_id
                } ,
                url : 'https://166.az/az/packages' ,
                success : function( res )
                {

                    var htmlSelect = '<div class="form-row packages-select-div"><label>Paketi seçin</label><select class="packages-select" name="services[' + $( $this ).attr( 'data-id' ) + '][campaign][package_id]">';

                    let data = JSON.parse( JSON.stringify( res ) );
                    data2 = data.data;

                    if( data2 )
                    {
                        if( $( $this ).find( "#step_2 div.campaigns" ).length == 0 )
                            $( $this ).find( "#step_2" ).append( "<div class='campaigns'></div>" );
                    }

                    var translateWeek1 = "Həftədə 1 gün";
                    var translateWeek2 = "Həftədə 2 gün";
                    var translateWeek3 = "Həftədə 3 gün";

                    setTimeout( function()
                    {
                        $( $this ).find( 'select.order-children option[value=' + data.campaign_id + ']' ).prop( 'selected' , true );
                    } , 1000 );

                    var hourly = "SAATLIQ PAKET";

                    if( campaign_id == 1000 )
                    {
                        data2.map( value =>
                        {
                            if( value.id == service_id )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                        } );
                    } else if( campaign_id == 2000 )
                    {
                        data2.map( value =>
                        {
                            if( value.id == service_id )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_1_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_1_price + ' AZN- ' + translateWeek1 + '</option>';
                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_2_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_2_price + ' AZN- ' + translateWeek2 + '</option>';
                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_3_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_3_price + ' AZN- ' + translateWeek3 + '</option>';
                        } );
                    }

                    htmlSelect += '</select></div>';

                    let packageLink = "https://166.az/az/campaigns";
                    let packageTitle = "Kampaniyalar";
                    htmlSelect += '<div class="form-row"><a target="_blank" href="' + packageLink + '">' + packageTitle + '</a></div>';

                    $( $this ).find( "#step_2 div.campaigns" ).html( htmlSelect );
                }
            } );
        }

        setTimeout( function()
        {
            if( service_id > 0 )
            {
                $( 'div.order-top select.order-children option[value=' + service_id + ']' ).prop( 'selected' , true );
            }
        } , 1200 );

        let changeService = service_parent_id;

        $( $this ).find( '#step1 option' ).each( function()
        {
            var optVal = $( this ).val();
            if( optVal == changeService )
            {
                $( this ).prop( 'selected' , true );
                let $this = $( this ).parents( '.order-top' );

                post( changeService , $this );
            }
        } );

        setTimeout( function()
        {
            postCalc();
        } , 2000 );
    }


    function orderOut(service_id = 0, service_parent_id = 0, $this, campaign_id = 0, type = 0) {
        // $( '[x-order-final-price]' ).html( 0 );
        $('[x-order-selected-service-price]').html(0);

        $('#newOrder').modal({
            backdrop: 'static',
            keyboard: false
        });


        $($this).find("#step_2 div.avtopark-select-div").remove();

        if( service_parent_id == 1 )
        {
            $.ajax( {
                type : 'GET' ,
                url : 'https://166.az/az/avtopark' ,
                success : function( res )
                {
                    var htmlSelect = '<div class="form-row avtopark-select-div form-row-select"><label>Yük maşını</label><select class="avtopark-select" name="services[' + $( $this ).attr( 'data-id' ) + '][avtopark]">';
                    let data = JSON.parse( JSON.stringify( res ) );
                    data = data.data;
                    data.map( value =>
                    {
                        if( value.id == service_id && type == 'avtopark' )
                            var selected = 'selected';
                        else
                            var selected = '';

                        htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                    } );

                    htmlSelect += '</select></div>';

                    $( $this ).find( "#step_2" ).append( htmlSelect );
                }
            } );
        } else if( service_parent_id == 4 )
        {


            
            
            
            

            $.ajax( {
                type : 'GET' ,
                data : {
                    'campaign_id' : campaign_id
                } ,
                url : 'https://166.az/az/packages' ,
                success : function( res )
                {

                    var htmlSelect = '<div class="form-row packages-select-div"><label>Paketi seçin</label><select class="packages-select" name="services[' + $( $this ).attr( 'data-id' ) + '][campaign][package_id]">';

                    let data = JSON.parse( JSON.stringify( res ) );
                    data2 = data.data;

                    if( data2 )
                    {
                        if( $( $this ).find( "#step_2 div.campaigns" ).length == 0 )
                            $( $this ).find( "#step_2" ).append( "<div class='campaigns'></div>" );
                    }

                    var translateWeek1 = "Həftədə 1 gün";
                    var translateWeek2 = "Həftədə 2 gün";
                    var translateWeek3 = "Həftədə 3 gün";

                    setTimeout( function()
                    {
                        $( $this ).find( 'select.order-children option[value=' + data.campaign_id + ']' ).prop( 'selected' , true );
                    } , 1000 );

                    var hourly = "SAATLIQ PAKET";

                    if( campaign_id == 1000 )
                    {
                        data2.map( value =>
                        {
                            if( value.id == service_id )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '">' + value.title + '</option>';
                        } );
                    } else if( campaign_id == 2000 )
                    {
                        data2.map( value =>
                        {
                            if( value.id == service_id )
                                var selected = 'selected';
                            else
                                var selected = '';

                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_1_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_1_price + ' AZN- ' + translateWeek1 + '</option>';
                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_2_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_2_price + ' AZN- ' + translateWeek2 + '</option>';
                            htmlSelect += '<option ' + selected + ' value="' + value.id + '-' + value.hour + '-' + value.day_3_price + '">' + value.hour + ' ' + hourly + ' - ' + value.day_3_price + ' AZN- ' + translateWeek3 + '</option>';
                        } );
                    }

                    htmlSelect += '</select></div>';

                    let packageLink = "https://166.az/az/campaigns";
                    let packageTitle = "Kampaniyalar";
                    htmlSelect += '<div class="form-row"><a target="_blank" href="' + packageLink + '">' + packageTitle + '</a></div>';

                    $( $this ).find( "#step_2 div.campaigns" ).html( htmlSelect );
                }
            } );
        }

        setTimeout( function()
        {
            if( service_id > 0 )
            {
                $( 'div.order-top select.order-children option[value=' + service_id + ']' ).prop( 'selected' , true );
            }
        } , 1200 );

        let changeService = service_parent_id;

        $( $this ).find( '#step1 option' ).each( function()
        {
            var optVal = $( this ).val();
            if( optVal == changeService )
            {
                $( this ).prop( 'selected' , true );
                let $this = $( this ).parents( '.order-top' );

                post( changeService , $this );
            }
        } );

        setTimeout( function()
        {
            postCalc();
        } , 2000 );
    }


    function addOneMap( $this )
    {
        let arr = [];

        $this.find( '.form-row-map' ).each( function()
        {
            let _this = $( this );
            arr.push( _this );
        } );
        let newMap = '<a href="#" class="new-map"><i class="fas fa-home" aria-hidden="true"></i>Daha Bir Ünvan Əlavə Et</a>';
        let lastMapItem = arr[ arr.length - 1 ];
        lastMapItem.append( newMap );
    }

    $( document ).on( 'click' , '.new-map' , function()
    {

        let $this = $( this ).parents( '.order-top' );


        let item = [ parseInt( $( this ).parents( '.order-top' ).attr( 'data-id' ) ) , parseInt( $( this ).parents( '.order-top' ).attr( 'data-id' ) ) - 1 ];


        let item2 = [];
        $( '.order-address' ).each( function()
        {
            item2.push( $( this ) );
        } );
        $( this ).parent().after(
            `
                            <div class="form-row form-row-map otherMap">
                                <input type="text" class="order-address" name="services[${item[ 0 ]}][${item[ 1 ]}map]" id="${item[ 0 ]}address${item2.length}map">
                            </div>
                        ` );
        $( this ).remove();

        if( !addressList[ item[ 1 ] ] )
        {
            addressList.push( {
                input : [ item[ 0 ] + "address" + item2.length + "map" ] ,
                complete : [ null ] ,
                geometry : [ {
                    text : '' ,
                    lat : null ,
                    lng : null
                } ] ,
                directionsService : null ,
                directionsDisplay : null ,
                marker : null ,
                core : null
            } );
        } else
        {
            addressList[ item[ 1 ] ].input.push( item[ 0 ] + "address" + item2.length + "map" );
            addressList[ item[ 1 ] ].complete.push( null );
            addressList[ item[ 1 ] ].geometry.push( {
                text : '' ,
                lat : null ,
                lng : null
            } );
        }
        addressFound = true;

        setTimeout( function()
        {
            let $this;

            $( '#order-forms .order-top' ).each( function()
            {
                if( $( this ).attr( 'data-id' ) == item[ 0 ] )
                {
                    $this = $( this );
                }
            } );
            addressList[ item[ 1 ] ].input.map( function( m , i )
            {
                let input = document.getElementById( m );
                google.maps.event.addDomListener( input , 'keydown' , function( event )
                {
                    if( event.keyCode === 13 )
                    {
                        event.preventDefault();
                    }
                } );
                addressList[ item[ 1 ] ].complete[ i ] = new google.maps.places.Autocomplete( ( input ) , { types : [ 'geocode' ] } );
                addressList[ item[ 1 ] ].complete[ i ].addListener( 'place_changed' , function()
                {
                    let place = addressList[ item[ 1 ] ].complete[ i ].getPlace();
                    addressList[ item[ 1 ] ].geometry[ i ].text = place.formatted_address;
                    if( place.geometry.location )
                    {
                        addressList[ item[ 1 ] ].geometry[ i ].lat = place.geometry.location.lat();
                        addressList[ item[ 1 ] ].geometry[ i ].lng = place.geometry.location.lng();
                    }
                    let found = 0;
                    addressList[ item[ 1 ] ].geometry.map( geo =>
                    {
                        if( geo.text !== '' ) found++;
                    } );
                    if( found > 0 )
                    {
                        $( $this ).find( "#map" + item[ 0 ] ).show();
                    }
                    if( found === 1 )
                    {
                        if( addressList[ item[ 1 ] ].core !== null )
                        {
                            setMarker( addressList[ item[ 1 ] ] , true );
                        } else
                        {
                            initMap( "map" + item[ 0 ] , addressList[ item[ 1 ] ] )
                        }
                    } else if( found > 1 )
                    {
                        setMarker( addressList[ item[ 1 ] ] , false );
                        setDirection( addressList[ item[ 1 ] ] , $this );
                    } else
                    {
                        $( $this ).find( "#map" + item[ 0 ] ).hide();
                    }

                } );
            } );
        } , 100 );
        addOneMap( $this );

    } );


    $(document).on("keyup",".otherMap,.form-row-map",function() {
        const $this = $( this ).parents( '.order-top' );
        const input = $(this).find("input");
        const id = input.attr("id")
        const length = input.val().length
        const map = $this.find(".googleMap").attr("id");
        const item =  parseInt( $this.attr( 'data-id' ) ) - 1
        const index = addressList[ item ].input.indexOf(id)
        const mapLength = $this.find(".form-row-map").length;
        const serviceType = parseInt($this.find(".order-top__left select").val());

        const checkMap = []

        $(".form-row-map").each(function() {
            if($(this).find("input").val().length > 0) {
                checkMap.push($(this))
            }
        })

        if(serviceType === 1) {
            if(checkMap.length === 1 && length === 0) {
                addressList[ item ].geometry[index] = {
                    text : '' ,
                    lat : null ,
                    lng : null
                }
                initMap(map, addressList[item]);
            }  else if(length === 0 && checkMap.length > 1) {
                addressList[ item ].geometry[index] = {
                    text : '' ,
                    lat : null ,
                    lng : null
                }
                initMap(map, addressList[item]);
                setMarker(addressList[ item ],false);
                setDirection( addressList[ item ] , $this );

            }
        }


    })



    $( document ).on( 'click' , 'button.modal-sure__submit' , function()
    {
        sessionStorage.clear();
        location.reload();
    } );


    function editFormCallback( data )
    {
        window.location.href = data.redirect;
    }

</script>
<script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=false&libraries=places,geometry&key=AIzaSyA0itE8q6DY9HXmOG1ew0PFqc57t0ml_pM&language=az"></script>




<script>
    function afterCallback()
    {
        $( "#callBack" ).modal( 'hide' );
        $( "#callback-success-modal" ).modal( 'show' );
    }

    $( ".phoneMask" ).inputmask({
        mask: "+\\9\\94 (99) 999 99 99",
        clearMaskOnLostFocus: false,
    }).keyup(function () {
        var val = $(this).val().split("(");
        var val2 = val.join("").split(")");
        var val3 = val2.join("").split(" ");
        var val4 = val3.join("");
        var val5 = val4.split("_");
        var val6 = val5.filter(function (index) {
            return index !== "";
        });
        $(this).val(val6[0]);
        $(this).parents('.phoneMaskParent').find('input[hidden]').val(val6[0]);
    });
    $( "#time" ).inputmask();

    function afterOnlinePayment( data )
    {
        window.location.href = data.redirect;
    }
</script>
</body>
</html>
